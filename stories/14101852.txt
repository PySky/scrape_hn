Over the last couple of decades, coffee has gone from being a plain, watery drink to an often-luxury staple available in endless combinations. You can now pay an incredible $18 for a single cup in Brooklyn . And millennials are said to be  more discerning about quality, origin, and preparation than their predecessors. Sales of espresso-type coffee have tripled since 2008, driven largely by younger tastes, the National Coffee Association says.

This discernment, while sometimes annoying, does have the benefit of producing changes in the wider supply chain. The “premiumization” of coffee pays for accreditation standards, greater traceability, and investments in enabling technology in developing countries. An example of the latter: a blockchain-enabled coffee grading machine aimed at smallholder farmers.

Developed by a startup called Bext360, the Coinstar-like kiosk combines artificial intelligence with a way of time-stamping coffee “cherries” (the fruits containing coffee seeds or beans) as they begin their journey from remote village to New York cafe. That offers traceability to end buyers and helps the farmers win better deals for their produce, says Bext360’s CEO Daniel Jones.

Small farmers in developing countries–who produce 70%-80% of the world’s coffee supply–are often at a market disadvantage, Jones says. Middlemen decide on the quality of the crop (and have an incentive to downgrade it), set prices, and decide how, and when, farmers get paid. The kiosk, on the other hand, gives objective feedback on coffee, and pays farmers immediately.

Farmers pour in their crop. The machine automatically grades beans for color, size, and other characteristics, comparing a generated image of the cherries against a library of different types. Bext360 has spent the last 18 months training its algorithms to identify dozens of cherry details. The unit makes an offer for the produce, and the grower decides whether to accept. If the answer is “yes,” the money is wired there and then to their cell phone. Coffee buyers, meanwhile, need to empty the kiosks as they reach a limit of about 70 pounds. Jones says automation makes this a smooth process: once full, a signal can go out from the machine to a driver, saying when the machine needs attention.

Inside the machine is software from Stellar.org, an open-source blockchain protocol for distributing and converting money. Its digital wallet exchanges currencies between buyers and farmers, and can even be used to set up an independent currency. A coffee co-operative could create its own monetary unit–say “cafe pesos”–that would circulate within the local area (this might offer more security than using real money). A local bank could then convert the currency when farmers needed it.

Stellar’s blockchain system also offers an indelible record of when the crop enters the chain and what quality the kiosk judges it as reaching. That means someone down the line–like, say, a coffee snob in Brooklyn–can ensure that what they’re drinking is what the coffee shop says they’re drinking. Bext360 is another example of how blockchain–which was first used to authenticate and track Bitcoin transactions–can be used to stamp out product fraud.

“A lot of importers want the ability to trace and track their coffee. They have a picture of the community on their websites. But they don’t truly have that last-mile connection to the actual origin of where the coffee is,” Jones says. The blockchain creates a transparent system of trustworthiness, where the record is distributed across computers. It makes it harder for a someone to intervene in the chain of custody and claim that a less high-quality batch deserves a premium price. Thus, says Jones, it encourages farmers to produce better quality cherries, because they know they’ll be rewarded for their effort.|||

Instead of dealing with sometimes-shady middlemen, coffee farmers can now have their product assessed by algorithm and paid for by this Coinstar-like device.