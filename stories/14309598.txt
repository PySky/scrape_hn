The 2013 holiday party at FreshBooks was a blowout affair, as employees and their families gathered to celebrate not just the season but also a major milestone. The company, based in Toronto, had established itself as the leading provider of online bookkeeping software for self-employed professionals and, earlier that month, recorded its ten-millionth user. It would finish 2013, Forbes estimates, with more than $20 million in revenue.

More than 200 people showed up for the celebration, which began with cocktails and a sit-down dinner in "the loft," a brick-and-beam room that had been decorated with lights and ribbons. After dinner, the attendees moved downstairs to a dance floor, a well-stocked bar and a professional DJ. "The last memory I have of that night was Mike dancing so hard that he slipped backward into a large tub of ice," says Levi Cooperman, referring to his cofounder, Mike McDerment. "It made for an uncomfortable walk home."

But for at least one evening, McDerment was able to put aside his growing realization that FreshBooks had a serious problem: It needed to reinvent itself. Otherwise, the company was facing long-term decline and even death. Ten years is a long time in the life of a software application, and popular as it was, FreshBooks had fundamental design problems that made it extremely difficult to add new features and even do basic maintenance. McDerment knew his was hardly the first company that needed to rethink its signature product. Witness BlackBerry and Lotus 1-2-3. Sooner or later, he realized, a competitor would come along and deliver a superior user experience.

And that's exactly what happened. In January 2015, a company called BillSpring appeared out of nowhere, offering self-employed individuals online invoicing software with none of FreshBooks' technical problems. BillSpring, it seemed, was everything McDerment had feared back at that holiday party--but with a surprising twist.

FROM THE BEGINNING, McDerment had possessed a keen sense of his customers' needs--partly because he'd started out as one of them. He had owned a four-person design agency in the early 2000s, and like most owners of tiny businesses, he'd handled everything from sales and marketing to project management and bookkeeping. During one hectic period in 2003, he was putting together invoices in his usual fashion--retrieving an old one and changing the contents as necessary--and made the mistake of saving the document without first renaming it. He realized too late he'd just obliterated an invoice he still needed.

At that point, he says, he snapped. He knew there had to be a better way. But all the bookkeeping programs he looked at struck him as too complex and too filled with jargon. So, using his own, limited programming skills, he put together a simple application that allowed his clients to log in and view invoices online. That application became the kernel of a new business. With the help of a doctoral student in computer science and Cooperman, an electrical engineer, McDerment turned his makeshift program into online invoicing and expense-tracking software for self-employed people who didn't want to learn accounting.

By mid-2006, the company had almost 1,000 paying customers, and the pace of growth was picking up. Cooperman, in particular, had worked diligently to improve FreshBooks, but he reached a point where he needed more experienced help, and so the company began hiring its first professional programmers, who quickly ran into problems. "We began hearing, 'This thing is really hard to work with,' " McDerment says. "I was like, 'Okay--well, whatever.' "

The programmers did the best they could with what they had and were able to make incremental improvements, but eventually one of McDerment's mentors, who owned a Web-hosting company, agreed to send in an associate to assess the situation. After completing his analysis, the associate told McDerment he had good and bad news: "The good news is that you've solved the hardest problem. You've figured out how to build a business, and you have a product that people love and are signing up for. The bad news is that you guys stink at technology."|||

Successful but speeding toward obsolescence, FreshBooks desperately needed to reinvent its online accounting service. It was almost as if it had to start an entirely new company.