The soldiers were caught on video carrying out what appears to be an extrajudicial killing.

In security camera images in Puebla state, a group of Mexican military officers fire on a car carrying suspected gasoline thieves. The soldiers then drag a man from the car who appears badly injured and lay him face-down in the street. A few moments later, a soldier fires a single bullet into the back of the man’s head.

It’s unclear what happened to two other men seen dragged from the car and off-camera.

The video, recorded May 3 and made public Wednesday by the news agency Diario Cambio, sparked outrage in Mexico, where lawmakers are debating several versions of a law that would legalize and expand the military’s enforcement of domestic security across the country.

For a decade now, Mexican soldiers and naval officers have been embedded in local communities as part of the government’s strategy to fight drug cartels. Despite previously documented cases of soldiers engaging in torture and carrying out execution-style killings, Mexico’s armed forces tend to be regarded as less corrupt than local and state police forces, some of whom collaborate with the cartels.

Angelica de la Peña, chairwoman of the Senate Commission on Human Rights, said in a statement Wednesday that the video is further evidence that Mexico’s armed forces should be focused on foreign threats and not on policing local communities.

“There was already concern about the use of excessive force by the military, and now this video seems to give us proof,” she said.

De la Peña, who belongs to the opposition Democratic Revolution Party, has been a vocal opponent of efforts by Mexico’s ruling party to pass the so-called Law on Internal Security.

The National Human Rights Commission, the government’s independent watchdog, said it was already investigating claims of human rights violations by soldiers in the same area on the same day and had already examined the video.

The shooting appears to be part of a broader series of deadly clashes that night in the town of Palmarito Tochapan between authorities and suspected fuel smugglers known as huachicoleros, who specialize in pilfering fuel from pipelines belonging to the state-owned oil company Pemex. Authorities said the thieves, some of whom are believed to have connections to Mexico’s drug cartels, attacked military forces who were responding to reports that thieves had breached a pipeline.

The day after the clashes, state officials told reporters at least 10 people were killed, including four soldiers and six “presumed criminals.” Federal officials announced that they were sending at least 1,000 more soldiers to fight gasoline theft.

Officials accused the smugglers of using women and children as human shields during the altercations. But civilians protesting the military actions blamed the army for the clashes and casualties.

“We don’t want the military to attack us,” read a banner raised by a protester during a blockade last week on the Puebla-Veracruz highway.

Mexico’s attorney general issued a statement Wednesday saying the incident would be fully investigated. The Defense Department said it would fully cooperate but questioned whether the video was “authentic or edited.”

Outrage over the video, which spilled onto Twitter and Facebook, comes on the heels of a high-profile report designating Mexico the world’s second most-dangerous conflict zone after Syria.

Based on the number of homicides last year, the annual Armed Conflict Survey, released this week by the International Institute for Strategic Studies, ranked Mexico worse than Iraq, Afghanistan and other war-torn countries.

On Wednesday, the Mexican government questioned the organization’s methods and said the report wrongly pointed to the existence of an armed conflict within the country.

“The existence of criminal groups is not sufficient criteria to speak of a non-international armed conflict,” said a joint statement issued by Mexico's secretaries of governance and foreign relations, adding that drug war violence is part of a bigger regional problem.

Neither is the use of the military to maintain order in the country’s interior,” it said.

The statement also said Mexico’s homicide rate is far lower than those of other Latin American countries such as Honduras and Venezuela.

Although Mexico’s homicide rate has soared — the first two months of 2017 were the most violent since the government started releasing such statistics in 1997 — officials have a point.

In January, Mexico had a homicide rate of 20 deaths per 100,000 people, according to a Times analysis of Mexican crime statistics.

By comparison, El Salvador’s rate was 81 such deaths per 100,000 people in 2016, according to InSight Crime, a think tank that studies organized crime in Latin America. Venezuela, on the other hand, had a homicide rate of 59 deaths per 100,000 people.

Cecilia Sanchez in The Times’ Mexico City bureau contributed to this report.

Mexicans were afraid Trump would bring disaster. So far, his bark is worse than his bite

Mexican officials enrage women by suggesting a young victim's lifestyle was responsible for her violent death|||

