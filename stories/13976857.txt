We compiled all species averaged data on brain and body weights from published literature sources (Supplementary Data: ‘Brain Data’ and ‘Body Data’ tabs). Brain weights represent averages of the following: (1) brain weights recorded in several original sources (compiled in ref. 48); and (2) endocranial volumes (ECV) recorded in ref. 49, which were converted to masses by multiplying by a factor of 1.036 g cm−3 (the specific gravity of brain tissue50). The final value used for each species represents an average of the values provided across studies, weighted according to the study sample size (Supplementary Data: ‘Brain Pivot’ and ‘Brain Final’ tabs). This dataset was supplemented with secondary source data51. The female-only dataset represents brain and body weights of sexed specimens from ref. 49. The subset of species for which both brain weight and ECV were available (n = 79) was tested for bias due to different collection methods. Agreement was concluded given that: (1) corrected ECV and weight measurements were highly correlated (R2 = 0.99); (2) the mean difference (corrected ECV – weight) was 0.62 g with a 95% CI including zero (−1.81 to 3.05 g); and (3) there was low correlation (R2 = 0.20) between the mean value of the two methods and the difference. As body weights were unavailable for many specimens in the original studies, they represent averages from the CRC Handbook of Mammalian Body Masses52, and the AnAge53 and PanTHERIA54 databases. Additional data from secondary sources51,55,56 were added to supplement this dataset, and were calculated as the mean values of males and females. In the course of compiling this dataset, we excluded juveniles, emaciated individuals and ‘low-quality’ data (indicated in the AnAge database53) when this information was available.

We assigned dietary categories according to previous designations in the published literature3,55,57,​ and used a four category scheme, which includes folivore, frugivore/folivore, frugivore and omnivore (Supplementary Data: ‘Diet Data’ tab). Percent frugivory per species was obtained from ref. 62 (Supplementary Data: ‘Diet Data’ tab). We assigned social and mating systems after consolidating assignments listed in published literature sources3,17,18,35,63,​ (Supplementary Data: ‘System Data’ tab). Social system categories represent the four-way categorization scheme typically used in primate studies67, including solitary, pair-living, harem polygyny and polygynandry. Mating system categories include spatial polygyny, monogamy, polyandry, harem polygyny and polygynandry. These two categorization schemes, social system and mating system, were used to conform to previous studies using either one, and because primate social organizations and mating systems describe distinct categorization schemes that are not always congruent, although are often used interchangeably. Group size data were collected from numerous primary and secondary sources35,59,67,​ . Average group size per species was calculated after removing duplicate values (Supplementary Data: ‘Group Size Pivot’ tab). This resulted in an average of 4.7 group size data points per species.

No simple universally accepted rule exists regarding the ratio of sample size to the number of predictors; however, a commonly used rule states that the number of cases should be at least 10 times the number of estimated terms75. Across all models included in these analyses, the maximum number of terms to be estimated is 10 (mating system models including all predictors: 1 = intercept, 1 = body size (log) coefficient, 3 = diet category coefficients, 4 = mating system coefficients, 1 = branch length transformation parameter), and all sample sizes exceed 100 species.

All statistical analyses were carried out in R 3.2.2. Humans (Homo sapiens) were excluded from all analyses because we are an outlier with regard to brain size and, consequently, excluding humans or presenting results with humans omitted is common practice in comparative studies of brain size18.

For each of the three sociality measures (mean group size, social system, mating system), two sets of models were constructed to incorporate either dietary category or percent frugivory as the diet measure. In each set, three different models were constructed, each of which had brain size as the dependent variable and either body size, body size + diet, or body size + diet + sociality proxy as predictors. All continuous variables except percent frugivory were log-transformed before analyses. Interaction terms were not included for the sake of interpretability and to prevent over-parameterization76. Assumptions of the linear model, with the exception of uncorrelated errors (see below), were tested and confirmed. Although the expected relationship between body size and diet77 was confirmed in this sample, all variance inflation factors throughout the linear models did not exceed 3.3, a cut-off commonly employed78 as it indicates the point at which R2 = 0.70 between variables. Although residual variances tend to differ between dietary categories and social and mating systems, multiple regression models assume the error variance is constant across values predicted from the model, and plots of residuals versus predicted values support this assumption.

Species represent non-independent cases because they may share traits due to phylogenetic inertia, so we tested for phylogenetic signal in linear model residuals by estimating values of Pagel’s lambda (λ). Although it has been common practice in comparative biology to test the independent and dependent variables for phylogenetic signal to justify analysis using phylogenetic methods, PGLS assumes that the regression model residuals, not the traits under investigation, follow a multivariate normal distribution with variances and covariances that are proportional to the species’ phylogenetic relationships. As significant phylogenetic signal was detected, PGLS regression was employed in all cases. We used the topologies and branch lengths from the GenBank taxonomy consensus tree provided on the 10kTrees website27 (version 3) and also repeated all analyses using the molecular phylogeny from ref. 28.

Model comparisons were conducted using BIC, rather than Akaike information criterion, as the former uses a more conservative penalty for additional terms and is more likely to suggest the most parsimonious model, or the one with the fewest number of parameters that need to be estimated. Sequential analysis of variance (Type I ANOVA) was used to identify variables that explained a significant amount of brain size variation.

In some of the analyses limited to catarrhines, maximum-likelihood estimations of lambda produced by the PGLS models resulted in a value of zero. It is unlikely that these traits should be modelled using ordinary least squares regression (equivalent to lambda = 0) and that this result is due to decreased sample size. The log-likelihood plots of lambda illustrate this, as they are very flat (see Supplementary Fig. 3 for example). Consequently, these models were run using a value of lambda obtained by calculating its 95% CI (represented by red lines in Supplementary Fig. 3), extracting 100 equally spaced values of lambda within this interval and averaging them with each value weighted according to its likelihood.

We also considered the influence of uncertainty in phylogenetic relationships by using 1,000 different trees from 10kTrees, which were created using Bayesian phylogenetic methods and sampled in proportion to their probability27. We examined the full (all predictors) PGLS models for each sociality and diet measure combination separately for each tree. Type I ANOVA was conducted on each of the resulting models, and the range of P values for each predictor was compared with those produced by analyses incorporating the consensus tree. We also examined the PGLS model including body size and diet separately for each tree to confirm brain size differences between dietary categories. We applied model averaging, as this procedure takes into account the varying degree of fit of the models to estimate regression coefficients79. For each model, we allowed the phylogenetic scaling factor (lambda) to take the value of its maximum-likelihood19.

We also fitted regression models using the ‘Continuous’ program in BayesTraits V280. As this function can use only continuous variables, we ran models using percent frugivory and group size (log) as proxies of diet quality and sociality, respectively. This program allowed us to generate posterior distributions of PGLS regression models (regression coefficients and scaling parameters) that account for phylogenetic non-independence of species data. The analysis sampled the tree block of 1,000 trees in proportion to their posterior probability to account for phylogenetic uncertainty, and the scaling parameter lambda was sampled during the Markov chain Monte Carlo (MCMC) regression analysis. Uniform, uninformative priors were used, as these reflect the assumption that all possible values of the parameters are equally likely a priori81, and this analysis was run for 2 million iterations, sampling every 200 iterations, with a burn-in of 200,000. MCMC diagnostics were run using the ‘coda’ package in R82. We report the posterior means of the variables included in each model and their 95% CI83, and the probability that each explanatory parameter value is >0 (P ) as all have been hypothesized to have positive associations with brain size.

Finally, we considered the possible effect of phylogenetic uncertainty by using Bayesian mixed models to test across a random sample of 100 different trees from the previous set of 1,000 10kTrees phylogenies. This was implemented using the R package ‘MCMCglmm’84 and modified R code from ref. 85. This procedure uses an MCMC estimation approach and accounts for phylogenetic non-independence by including the phylogenetic relationships among species as a random variable. We confirmed convergence between model chains using the Gelman–Rubin statistic, with all models required to have a potential scale reduction factor below 1.1 (ref. 86). The effective sample sizes for all terms across all models were >1,000. In line with previous work84,85, we used an uninformative inverse-Wishart distribution and a parameter expanded previously, with a half-Cauchy distribution for the random factor. Each model was fitted to each of the 100 trees, and the model outputs were combined to create coefficient distributions.

We implemented a resampling procedure as a way to incorporate within-species variation in group size. This procedure involves randomly choosing one group size datum for each species and setting it as the species-specific estimate16,87. Using this resampling scheme, we created 1,000 species-specific datasets that were subsequently analysed using the full (all predictors) group size PGLS model. Some iterations encountered optimization errors, which relate to calculating the maximum-likelihood of lambda. These were ignored and resampling continued until we produced 1,000 models16. To make inferences across these models, we determined the 95% CI of the derived group size term coefficients.

Before ancestral reconstruction analyses, polytomies in the phylogenetic tree were resolved using the ‘multi2di’ function in the R package ‘ape’88. Maximum-likelihood ancestral state reconstructions of continuous traits (relative brain size, mean group size) were estimated using the ‘fastAnc’ function in the R package ‘phytools’89. The EQ31 was used as a measure of relative brain size, and the equation was derived from our dataset (n = 144 species) using the allometric formula E = kPα, where E is brain mass, P is body mass, k is the proportionality constant, α is the allometric exponent and the final equation is E = 0.085 × P0.775. The root node was set22 to reflect a species characterized by solitary foraging (group size = 1) and a relative brain size (EQ = 0.41) based on estimates of early Eocene fossil primate brain and body weights (Smilodectes gracilis90: brain = 9.84 g, body = 1,600 g, EQ = 0.38; Tetonius homunculus91: brain = 1.55 g, body = 161 g, EQ = 0.45; see Supplementary Data: ‘Fossil Data’ tab).

Reconstructions for discrete variables (social and mating system) were conducted using an empirical Bayesian method in which the transition matrix is fixed at its most likely value, executed by the ‘make.simmap’ function in R package ‘phytools’89. The function first fits a continuous-time reversible Markov model for the evolution of the trait in question, and then simulates stochastic character histories using that model and the tip states on the given tree89. To provide information regarding reconstruction uncertainty, marginal ancestral reconstructions were performed at each node by computing the set of empirical Bayes posterior probabilities that each node is in each state over 500 simulations. The root node prior probabilities were set to assume spatial polygyny and solitary foraging as the ancestral states for mating system and social system, respectively. Different transition rate models were considered using BIC, including: (1) an equal rates model, in which a single parameter governs all evolutionary transition rates; (2) a symmetrical rates model, in which forward and reverse evolutionary transitions between states are constrained to be equal; and (3) an all-rates-different model, where each rate is given a unique parameter. The symmetrical rates model was ultimately used for both reconstructions as it exhibited the lowest BIC value.

The authors declare that all data supporting the findings of this study are available within the paper and its Supplementary Information files.|||

Using updated phylogenies and the largest dataset to date, the authors find that primate brain size is better predicted by diet than any measure of sociality, suggesting a revision is needed to prevailing hypotheses explaining brain size evolution.