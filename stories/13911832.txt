The Internal Revenue Service revealed new details about its investigation into tax evasion related to bitcoin, filing court documents that suggest only a tiny percentage of virtual currency owners are reporting profits or losses in their annual returns.

The new documents, filed Thursday in San Francisco federal court, come in the midst of a closely-watched legal fight between the IRS and Coinbase, a popular service for buying and selling bitcoins that hosts over a million customer accounts.

The dispute began last year when the IRS issued a sweeping summons for Coinbase to turn over a vast amount of customer data, including every customer account as well as detailed transaction records.

Coinbase claimed the IRS demands are illegally broad and refused to comply, which in turn led the IRS to file a federal lawsuit last week to enforce the summons.

Jurors Weigh Charges Against a Pastor and Software Engineer in Bitcoin Trial

While the lawsuit did not come as a surprise, a new affidavit from IRS agent David Utzke reveals additional information about how the agency is conducting the investigation. Specifically, Utzke explains he ran a computer analysis against the IRS's repository of hundreds of millions of tax records, and found fewer than a thousand people filed a Form 8949 to account for a "property description likely related to bitcoin."

Form 8949 is used to report capital losses and capital gains and, under current IRS rules, would require bitcoin owners to declare their profits. In some cases, the profit could be significant given the virtual currency soared from $13 to over $1,100 during the three year period (2013-2015) for which the agency is seeking information.

Here is a paragraph from Utzke's affidavit that states only 802 individuals filed a bitcoin-related Form 8949 in 2015(emphasis mine):

It's impossible to know what percentage of Coinbase customers these numbers represent, but it's likely only a small fraction. Even though some Coinbase accounts belong to non-U.S. citizens, and many others did not have any transactions (and therefore did not trigger any capital gains), it's possible an IRS review of the accounts could identify hundreds of thousands of individuals who should have declared bitcoin income.

In a Friday blog post , Coinbase said it has yet to turn over any information, and that it would push back against the scope of the summons.

"Coinbase remains concerned with the indiscriminate and over broad scope of the government’s summons and we have produced no records under the summons," wrote Coinbase lawyer, Juan Suarez.

The company has previously described the IRS probe as unreasonable, noting the agency would not approach other financial institutions like JP Morgan or PayPal and demand every single of their customer records.

In January, Coinbase CEO Brian Armstrong complained the legal fight could cost his company up to $1 million, and that he would prefer to spend the money hiring employees. Armstrong at the time also offered an olive branch to the IRS, saying Coinbase is ready to provide customers with 1099-B forms, which are used by brokerages and others to help customers report their taxes.

Following news of the IRS tax probe, one virtual currency lawyer said the agency's demand simply represented an opening gambit for negotiations—and that it that would end with Coinbase providing a far more narrow set of information.

A person close to Coinbase, who was not authorized to speak for attribution, confirmed to Fortune the company and the IRS have been in talks, but also expressed surprise the agency has so far refused to narrow its demands.

A spokesperson for the IRS said the agency cannot comment on specific investigations.

The upshot of all this is that many Coinbase customers are likely to feel uneasy since the investigation could eventually lead them to owe back taxes or penalties, or even see the IRS seize their accounts.

Meanwhile, Coinbase isn't the only one taking issue with the IRS's bitcoin stance. A Los Angeles law firm, Berns Weiss, sued the IRS last year , complaining the agency's summons swept up one of the firm's partners, Jeffrey Berns, who held bitcoin at Coinbase, but had never sold it. The firm had to drop the lawsuit after the IRS told Berns he would not be a target of the investigation—but has since vowed to resume the legal battle.

"We will, however, continue our efforts to protect the rights of Coinbase customers regarding this patently overbroad summons. Thus, we plan to file a motion to intervene in the enforcement proceeding on behalf of other Coinbase customers who have contacted us and expressed their interest in fighting the summons," said the firm in a statement.

Finally, it's unclear if the IRS is also targeting other virtual currency operators. While Coinbase is the most popular and mainstream bitcoin platform, there are numerous others. Meanwhile, the growing value of other virtual currencies , including Ethereum, mean firms that offer such currencies could soon find themselves in the cross-hairs of the IRS too.

An earlier version of this story incorrectly referred to the IRS form on one occassion as Form 8948 not 8949. It has been updated.|||

The Internal Revenue Service has new details about its Coinbase investigation into bitcoin tax evasion.