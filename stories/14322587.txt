Long before Bob Moog built his first synth, there was the Hammond tonewheel organ; effectively an additive synthesizer, albeit electromechanical rather than electronic. So emulating a Hammond with an analogue synth shouldn't be too hard, right? Well...

Long before Keith Emerson and Rick Wakeman showed us that keyboard players did not have to be accompanists dressed in black and illuminated by black spotlights, and even longer before musicians began to take to the stage armed with nothing but a laptop computer and a pair of turntables, jazz and blues organists were the hi-tech musicians of their day. So when players such as Jimmy Smith and Earl Grant cast off their sackcloth and made a bee-line for the front of the stage, they did so with nary a Minimoog, ARP 2600, EMS VCS3, chorus unit, phaser, ensemble, or digital reverb in sight — which isn't surprising, as none of these had yet been invented. With no more than a Hammond organ, a bit of spring reverb, and maybe a touch of overdrive, these guys were creating exciting new forms of dance music throughout the middle of the 20th century. In retrospect, it's far from unreasonable to suggest that almost all modern forms of hi-tech music evolved from the 'black' music of the 1940s and 1950s, and it is therefore appropriate to hand the award for most influential keyboard instrument of the 20th Century to the Hammond 'tonewheel' organ.

Like many brilliant ideas, the basis of Laurens Hammond's tonewheel generator is simple: a knobbly wheel rotates in the presence of a magnet, and the resulting changes in the magnetic field induce a signal in a pickup (see Figure 1). The waveform and frequency of the signal is determined by the shape of the wheel and the number of 'bumps' that pass the tip of the magnet every second. Given that in the finished instrument, all the tonewheels are mounted on a single axle, different frequencies are obtained not by using different rotation speeds, but by using tonewheels of different sizes and geometries. Like I said... brilliant!

When designing his organ, Hammond decided that each tonewheel should generate a sound as close as possible to a sine wave, so that players could construct timbres using a fundamental and overtones. Building on this idea, he chose a system by which players could mix up to nine sine waves simultaneously, using 'drawbars' (see Figure 2) to give each an amplitude ranging from zero to eight. Some later Hammonds offered more drawbars, and some offered fewer, but nine is the classic configuration.

The lowest pitch on a full console Hammond is 16', with drawbars at five and two-thirds feet (5 2/3'), 8', 4', two and two-thirds feet (2 2/3'), 2', one and three-fifths feet (1 3/5'), one and one-third feet (1 1/3'), and 1'. So, despite Hammond's strange decision to call the 8' the fundamental (or 'Unison') and the 16' drawbar the sub-octave, the 16' pitch is the fundamental of a series that includes the first, second, third, fourth, sixth, eighth, 10th, 12th and 16th harmonics, as shown in the table below.

Different drawbar configurations are called 'registrations', and (if my maths is correct) there are 387,420,489 of these on each manual. These registrations fall into groups with archaic names such as 'Stopped Flutes', 'Half-covered Flutes', 'Gemshorns', 'Strings', 'Vox Humanae', 'Reeds'... and so on. Within each of these there are anywhere between a few hundred and a few million unique combinations, and each can be represented by a nine-digit number written in the form 'xx xxxx xxx'. So, for example, if the 16' drawbar is fully extended but all the others are pushed home, we can write the resulting registration as 80 0000 000.

Now, if each drawbar produces a sine wave, 80 0000 000 will not create a very interesting sound. Depending upon the amount by which you pull out the 16' drawbar, you will simply obtain a sine wave of greater or lesser amplitude (see Figure 3). So you add interest by pulling out combinations of drawbars to create complex registrations. Figure 4 shows the waveform generated by one of the simplest but most important of these, beloved of Jimmy Smith, Keith Emerson, and heavy rock players the world over. The registration is 88 8000 000 and, if you are an Hammond aficionado, you will immediately recognise its punchy timbre.

In contrast to the simplicity of 88 8000 000, and often deprecated by classical organists, is the registration 88 8888 888 (see Figure 5). This has all nine harmonics present at maximum amplitude, and is very full and bright. More interesting, perhaps, are the registrations shown in Figures 6 and 7. The first of these is 83 4211 100, the closest approximation available to a '1/n' harmonic series, while the second is 00 8030 200, an approximation to a '1/n' series with all the even harmonics missing. In other words, they are the closest a vintage Hammond can come to producing a sawtooth wave and a square wave, respectively.

Clearly, we can create a huge range of tones using the nine pitches available and, way back in the mists of time (well... in part 14 of this series, to be precise — see SOS June 2000), I showed how we can use nine sine-wave oscillators, nine amplifiers, a gate of some sort and a mixer to emulate a note produced by a tonewheel generator. Figure 8 shows an advanced version of this idea, with the oscillators' pitches fixed to the drawbars' pitch relationships, and a voltage-controlled mixer that allows you to mix the oscillators' outputs just as you would if you were clutching a fistful of drawbars.

Apart from dedicated additive instruments such as the Kurzweil 150, Kawai K5 and Kawai K5000 (of which more next month), there is only one family of synths that allows you to patch Figure 8 in a cost-effective fashion. These are the more powerful of the FM synths that dominated the mid- to late-1980s. The DX7 isn't quite up to the job, but the DX5 and DX1 have a dozen freely tuneable 'operators' so, using Algorithm 32, you can program Figure 8 with three oscillators to spare. Long before the current crop of digital B3/C3 emulators, these powerful synths were responsible for some excellent Hammond impersonations.

Unfortunately, there are few of the larger DXs in circulation, and you're unlikely to lay your hands on one. If you do, you'll probably pay up to £750 for a DX5, and as much as £2000 for a DX1. Oh, alright... I admit that this is not a very cost-effective solution! So let's see whether we can use a much simpler and cheaper analogue polysynth to patch an acceptable Hammond sound.

Back in the dim and distant 1980s, I owned two Hammond emulators: a cheap and cheerful Crumar Organiser that had cost me the grand sum of £199 in the late '70s, and a Korg BX3 that, a few years later, had cost a whole lot more. The Crumar sounded little like a Hammond, but was relatively light and portable. In contrast, the Korg sounded far more realistic, but was almost as unwieldy as the top of a split B3. As a result, I was always looking for alternatives that would sound good, but save weight and hassle.

I tried everything, but — until the advent of digital emulators such as the Hammond XB2 several years later, I found that nothing improved greatly upon the 88 8000 000 organ sound that I patched on a very simple analogue polysynth. That synth was a Roland Juno 6, and given that it offered just one oscillator per voice and no sophisticated voicing capabilities, it seemed a most unlikely solution to my problem.

I'll start to develop the patch by considering the Juno's single oscillator section (see Figure 9). As you can see, this offers just two waveforms — variable pulse (with pulse-width modulation) and sawtooth — plus a square-wave sub-oscillator one octave below the basic pitch. There is no way to mix the pulse and sawtooth waveforms in different amounts — they are either 'on' or 'off', although you can add as much or as little sub-oscillator as you like.

I'm now going to introduce a rather unusual way to represent harmonic spectra. I haven't used this representation before, but it's particularly well-suited to depicting the output from tonewheel organs.

For reasons that will soon become apparent, I will draw the harmonics' frequencies and amplitudes on logarithmic scales. I will also invert the amplitude axis so that the louder a harmonic is, the lower on the page it appears. Strange though this may seem, it mimics a visual representation of Hammond drawbars. So, for example, I can depict a spectrum comprising three sine waves lying on the first three harmonics of a given frequency (see Figure 10, below), and it is should be clear that this is a different way of representing the 88 8000 000 registration shown in Figure 11). If we now return to the Juno 6 and activate its sub-oscillator, we will (in a perfect world) obtain the spectrum shown in Figure 12. Clearly, this is a million miles from what we require. What's more, for a fundamental of, say, 200Hz, there are 100 harmonics within the 20Hz-20kHz audio spectrum, of which 50 have non-zero amplitude. By the way, I hope that you can now see why it's useful to plot '1/n' plots on logarithmic axes — on linear axes, this graph would have been considerably wider than this magazine, and the resulting fold-out diagram would have given SOS's printers a terrible headache!

To start sculpting this into something useful, I am going to filter the sub-oscillator using the Juno's low-pass filter, with the cutoff frequency set precisely 19 semitones (one octave and a fifth) above the sub-oscillator pitch itself. The reasons for this very precise setting of the cutoff will become apparent shortly...

The result appears in Figure 13 (right). As you can see, the first two partials (which are the first and third harmonics) pass through the filter unscathed, while the third (the fifth harmonic) is attenuated, and the higher harmonics are so quiet as to be almost inaudible. This is closer to Figure 10, but still wins no cookies.

Now I'm going to add the output from the oscillator. I'll set it up so that only the pulse wave is produced, and this has a duty cycle of 'one third'. If you recall the instalment of this series in SOS March 2003, and specifically the large box in that instalment on the nature of pulse waveforms, you'll remember that you can approximate the harmonic content of the resulting waveform if you take a sawtooth wave and remove every third harmonic. Of course, if you remember the rest of that instalment, you'll also recall that this approximation breaks down as you decrease the duty cycle — so the harmonic content of a pulse wave with a duty cycle of one-twelfth, for example, isn't much like that of a sawtooth with every 12th harmonic removed at all. But for a pulse wave with a duty cycle of one third, the approximation is reasonably sound, and the remaining partials conform almost exactly to a 1/n amplitude spectrum, as demonstrated in Figure 14 (right).

The output from the pulse wave has to pass through the same filter as the sub-oscillator, so it too will be heavily filtered. However, whereas the filter cutoff frequency is set to the third harmonic of the sub-oscillator, it lies halfway between the fundamental of the pulse wave and its first overtone (which, in this case, is the second harmonic). So — to paraphrase the above — the fundamental passes through the filter unscathed, but the first overtone is attenuated and everything else is so quiet as to be almost inaudible (see Figure 15).

I'll now switch on the Juno's pulse wave and sub-oscillator simultaneously, and show the spectrum of the mixed signal by adding the partials in Figures 13 and 15. The result of this can be represented in Figure 16. Clearly, this is much closer to the ideal, with the leftmost partials representing the 16' and 8' drawbars fully extended, and the next two representing the 5 2/3' and 4' drawbars respectively. The only aberration is the fifth partial, which has an amplitude of about 2.5 percent.

As shown by the table earlier in this article, there is no Hammond drawbar which produces the fifth harmonic, so in theory this should not be present. But in the real world, impurities in the geometry of the tonewheels and valve distortion add some fifth harmonic to the sound, so this does not overly concern me.

Nonetheless, it would be nice to bring the 5 2/3' pitch to the fore because, as it stands, the sound lacks depth (if you pull out just the 16' and 8' drawbars on a Hammond, you obtain a relatively uninteresting timbre, so it's not surprising that the synthesized equivalent should be similarly lacking).

Before attempting to raise the profile of the third harmonic in this way, let's check the settings for the DCO, as shown in Figure 17. Note that the sawtooth wave is 'off', that the pulse wave modulation switch is set to 'Man' (manual), and that the PWM slider is positioned so that the pulse width is a constant 33.33 percent. With practice, you can adjust this by ear... as you move the slider to the correct position, you can hear the third harmonic disappear. Note also that the sub-oscillator output is at its full amplitude, but that there is no contribution from the noise generator.

Now it's time to return to that troublesome 5 2/3' drawbar. Given that we have no further control over the oscillator, how can we accentuate the third harmonic of the sub-oscillator?

The secret lies in the filter which — if you remember — is tuned exactly 19 semitones above the sub-oscillator's pitch. And of course, 19 semitones above the sub-oscillator is where the third harmonic lies...

If you've wondering how on Earth this helps, it should help to know that the Juno 6 has a self-oscillating filter that tracks the keyboard perfectly. If we set the filter resonance to 100 percent, the self-oscillating filter produces a sine wave at the filter cutoff frequency — in other words, 19 semitones above the fundamental. So, if the sub-oscillator produces a bottom 'C' and the pulse wave produces the 'C' an octave higher, the self-oscillating filter will produce a 'G' 1.5 octaves above the sub-oscillator.

This works on the Juno because its filter is so perfectly behaved. Unfortunately, attempting this trick on most other analogue synths causes all manner of problems, including severe attenuation of the lower frequencies, and unpleasant distortion as the signal presented to the filter input 'fights' the signal generated within the filter. Oh yes... and it's unlikely that the sine wave produced by self-oscillation will track the keyboard correctly, so its pitch will wander all over the place, making the patch useless. So, if you're trying to create this sound on a lesser instrument (and that includes all the Prophets, all the Oberheim OB-series, and nearly everything else) you must reduce the resonance, leaving it high enough to amplify the third harmonic that is already present in Figure 16, but not so high as to send the filter into oscillation (see Figure 18).

Nice though the result in Figure 18 is (especially if high resonance causes the filter to attenuate the higher harmonics further), I don't see why I should limit myself in this fashion. So I'm going to push the Juno 6's filter all the way into self-oscillation (as shown in Figure 19), creating a pure tone at the 19th semitone, and at the same time severely attenuating all the frequencies that lie above this. The result appears in Figure 20, and is exactly what we were after in Figure 10 — a very elegant result, if I say so myself!

However, we need to set up the rest of the filter correctly if the sound is to work. In particular, precise adjustment of the filter envelope settings (which I have omitted from Figure 20) is vital if the cutoff frequency is to lie at the correct pitch. But why do we need to modulate the filter using the envelope? Surely it would be best to leave well alone?

We all know that Hammond organs exhibit a 'spit' at the start of the note, caused by what Laurens Hammond thought were deficiencies in the keying system. Today, of course, we are rather attached to these so-called 'key-clicks', and the programmers of DSP-driven Hammond emulators spend a great deal of time imitating them as accurately as possible. Unfortunately, the Juno 6 lacks the sophistication needed to produce the clicks correctly, so I will have to resort to using the filter envelope to generate a reasonable imitation.

Figures 21 and 22 show how we set up the ADSR envelope generator to create a pronounced, but almost instantaneous, transient at the moment you press a key, and how this can make the VCF cutoff frequency change as you play a note. Given that the filter is oscillating, this will create a very rapid downward sweep during the Decay stage, also accentuating the pulse wave's and sub-oscillator's harmonics as it does so. The 'blip' thus produced is satisfactory for our purposes.

The settings in Figure 21 may look trivial, but to apply the contour to the filter itself, you must position the 'VCF Env' switch for positive polarity and raise the 'Env' slider in the VCF section — see Figure 23. You must then be very careful how you set this up, because the Sustain Level and the amount of 'Env' will together raise the cutoff frequency that you have previously tuned so carefully to the sub-oscillator's third harmonic, thus destroying all your hard work so far. So... how can you create the 'key-click' and still get the filter to produce the sound of the 5 2/3' drawbar?You solve this conundrum by taking the following steps:

The chances are that you'll have to run through these steps a couple of times before everything is hunky dory, but it's not hard once you've got the hang of it. Personally, I find that a 'Freq' value of 'zero' is best, and that tuning the filter using the 'Env' control alone is the ideal solution.

Now let's take care of the amplitude envelope. To a first approximation, this is rectangular: you press a key and the note immediately attains its maximum amplitude; you release the key and it immediately falls to silence. The Juno 6 has a neat way of achieving this; you can disconnect the VCA from the envelope generator using the switch shown in Figure 24. The amplifier then responds to the gate pulse itself, being 'on' when you press a key, and 'off' when you release it. This is the mechanism we were after way back in Figure 8, and it produces the amplitude contour shown in Figure 25.

We now have everything in place to allow us to emulate the tonewheel generator set to an 88 8000 000 registration, so let's combine the parts to create our final synthesized Hammond patch. Figure 26 does this. Note that the Key Transpose and Hold buttons are off, that the arpeggiator is off, and that there is no LFO applied in either the DCO section or the filter section, so the LFO controls themselves are irrelevant. Finally, there is no Chorus.

So how does it sound? Great, huh? Well... no. It's OK, but it sounds little like a vintage B3, being more akin to one of Hammond's transistor organs from the 1970s; the sort often observed lying unloved and unused in your Auntie Maud's living room. Nevertheless, this sound is in fact not far removed from that of a Hammond's unadorned tonewheel generator — it's just that it lacks the additional treatments and effects that make the Hammond A-, B- and C-series organs the sonic marvels they are. Clearly, in order to synthesize the complete sound, it's necessary to synthesize all the parts of the instrument.

I'll return to this point in a couple of months, but for now, I'll leave you with this thought, which may already have occurred to you — what if you don't have access to a Roland Juno 6? Can we make use of any of the principles we've learned this month on any other synth? Next month, we'll attempt to do just that.|||

Long before Bob Moog built his first synth, there was the Hammond tonewheel organ; effectively an additive synthesizer, albeit electro-mechanical rather than electronic. So emulating a Hammond with an analogue synth shouldn't be too hard, right? Well...