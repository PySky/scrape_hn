Just days before he was set to go to trial in Fresno, California, a Brooklyn man agreed to the government's assertion that he sold heroin and cocaine on AlphaBay. That site is one of the largest Dark Web marketplaces currently operating since Silk Road was seized and shut down in 2013.

On Friday morning, lawyers representing Abdullah Almashwali appeared before US District Judge Dale A. Drozd and filed a guilty plea to three counts of drug charges, likely in exchange for a lighter sentence. Almashwali was charged in August 2016 along with a co-conspirator, Chaudhry Ahmad Farooq. Farooq pled guilty in January 2017 and has yet to be sentenced.

According to an affidavit filed by a special agent with the Drug Enforcement Administration, the two men—selling under the names "DarkApollo" and "Area51"—made key mistakes online that ultimately betrayed them. Those monikers advertised that they were directly importing heroin from Afghanistan.

It was seemingly easy for Special Agent John Rabaut to find them. As he wrote:

If you’re an alleged drug dealer, don’t use “asshole209” as a password In May 2016, Rabaut, working undercover, set up two purchases from AREA51 and had them sent to a Fresno address—both turned out to be heroin.

In the Almashwali case, Rabaut sent the packages to a DEA lab, which managed to lift fingerprints off of the packages. The prints came back with a match for Almashwali, who was arrested in 2008 on a charge of receiving stolen property.

The DEA agent then partnered with an inspector from the United States Postal Inspection Service. The inspector was able to determine that the postage on those packages was purchased via a "self-service kiosk" (SSK) at a Brooklyn post office.

Almashwali was arrested near his apartment in Brooklyn on August 2, 2016—Farooq was also being watched and also was arrested the same day. Once in the apartment, investigators quickly found a slew of digital evidence that implicated Farooq, as was outlined in an April 11, 2017 trial brief:

Case agents obtained consent to search [Farooq's] apartment and found several items of evidence, including a MacBook computer and an iPhone 6 Plus. The MacBook computer was logged into DARKAPOLLO's Alpha Bay account, allowing case agents to take screen shots of account records. Agents also found packaging materials, including boxes full of padded envelopes and stacks of USPS and FedEx envelopes. They also located silver Mylar envelopes that matched the Mylar envelopes used to send the heroin in Parcels #1 and 2. The forensic case agent imaged the iPhone 6 Plus and the MacBook computer, which contained backups of several digital devices, including an iPhone 6 Plus (for the same phone that was found in Farooq's apartment), an iPhone 6s Plus, and an iPhone 5c. The iPhone 6 Plus (both the actual phone and the backup) and iPhone 6s Plus belonged to Farooq, while the iPhone 5c appears to have belonged to the defendant. These devices contained thousands of text messages, including hundreds of text messages between the defendant and co-defendant Farooq in which they discuss the distribution of narcotics and dark-web marketplaces.

Judge Drozd is scheduled to sentence Almashwali on July 24, 2017, at 1:30 p.m. and Farooq on May 15, 2017. The two men face a maximum sentence of 20 years in prison and a $1 million fine, which will almost certainly be reduced.

UPDATE 10:30am ET: The headline has replaced the word "keyserver" with the phrase "public key" to more accurately reflect what is described in the affidavit.|||

Second of 2 AlphaBay sellers arrested in 2016 pleads guilty: Abdullah Almashwali.