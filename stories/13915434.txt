Analyze one year of radio station songs aired with SQL, Spark, Spotify, and Databricks Whenever I drive or code, I listen to music, as this happens a lot, and in order to find new songs, I listen to the radio or I listen to Spotify’s discover weekly playlist, which made me like Mondays (because they release it every Monday) A french old-school institute called Mediamétrie analyzes radio stations’ songs. Since I have seen their study (that I can’t find anymore) some years ago, I have been obsessed with creating my own. This article will present the year 2016 for 4 main french radio stations through fun SQL queries, then we will connect each song to the Spotify API to create the radio stations’ musical profile. We will use the Databricks community version to visualize our data. All SQL queries and all results are available on this notebook. It’s the “backstage” of this article, where the magic happens if we can say. Protip: don’t miss the bonuses at the end of the article We all have a favorite radio station, mine is Radio Nova for their diversity, their humor, and as a hip hop fan this is the only national radio where we can hear listenable hip hop songs Radio nova had 1,4% of the audience in September 2016 (PDF to download from Mediametrie). In order to see how a radio becomes number 1, we are also going to analyze the number 1 music radio called NRJ who has 10,8% of the audience and 2 others : Virgin (5%) which, we’ll see, sounds like NRJ, and Skyrock (6%), don’t mind the name it’s a rap radio… haha The main question is, after we compared these radios, should we give to Radio Nova the tips of how to be the number one based on NRJ’s analyze? What do you say, Nova? Learn from the best, right?! In order to extract the songs lists, artist, song title and timestamp, we are going to parse each Radio “What was this song?” HTML pages, except for Skyrock which has a handy RESTful web service. Every song extracted will be converted into this Song class to query them easily with (Spark) SQL: Every songs is stored in a parquet format to extract only once the data (you’re welcome radios servers :p) and to speed up SparkSQL queries. Btw, if you are interested by the file I can export it to you in CSV, or parquet. Remember that the best way to speed up (the Spark doc says often by more than 10x) queries, if you have to use the same SQL table (or Dataset/Dataframe) again and again, is to cache them in memory (Thanks Databricks for the 6Go RAM server!) with the method. How many songs by day ? Some days were not recorded by the radios’ history system, so the real numbers should be a bit higher.

Fun to see that both radio stations broadcast more songs during summer (if we do not take in consideration the one-week bug of Radio Nova, in blue, in August), this is certainly due to summer holidays. They do a good job all year long, so, it’s OK to take some days off, I guess! We can see that Skyrock and Nova broadcasts the same number of songs each day, whereas NRJ and Virgin a bit less, certainly due to more talk shows or untracked DJs night shows. How many different songs by day? The real difference comes from the number of different songs played, see by yourself the number of different tracks per day:

It’s interesting to see how “hits” are played through the year. We can notice summer hits: Kaytranada for Nova, Enrique Iglesias for NRJ, Kent Jones and Drake for Skyrock and Imany and Kungs for Virgin. And also, most broadcasted songs are mostly aired during summer. Radio tends to broadcast more songs during summer. So artists, play smart here and release your songs between February and June to have more chance to become number one, or to have more people hating your music because they heard it too many times?

If we take the average broadcasted songs by day and the mean duration of a song, 3.30 minutes, we can guess the percentage of music by day. The other percentage is likely to be talk shows, advertising or untracked songs. To understand more these percentages, we should see what a normal day is for our analyzed radio stations. What is a typical Monday for our radio stations ? Let’s have a look to the average of number of songs for all radio stations for Mondays

We can distinguish 2 gaps, during the morning and evening shows for every radio stations. Amazing. More seriously, no discovery here, it’s a known fact that most radios have morning and evening shows during which there is less music and more talk. If we recalculate the average percentage of music at noon, when there is no shows for all radio stations, we can estimate the percentage of advertising by radio by hour. We estimate that the radio hosts speak 5 minutes during the whole hour. We have to note that radios may advertise more during prime time when they have a larger audience. For 60 minutes, we get from 7 minutes of advertising time, for Skyrock, to 15 minutes, for Virgin. In details, we have this table:

An annoying feeling we have sometimes with radios is we keep listening to the same songs over and over. As we are men and women who believe in science and not in our instinct we are going to use basic statistics to verify this weird feeling. How many times is the same song aired on the same day? Average number of times the same song isbroadcasted by day These pie charts below tells us a lot about radio stations’s habits, more mainstream radios such as Virgin, NRJ or Skyrock are more about to broadcasts the same songs multiple times.

When is the next time we will listen to the same song during the same day?

Again, the most mainstream radios, NRJ, Skyrock and Virgin tend to broadcast the same song most often 2/3 hours since it was first aired. Nova’s value is more about 7/8 hours. While we have different distribution, the average for our 4 radios is between 7 and 8 hours. How many new songs* are added and when? *“New songs” means songs that are not yet broadcasted in 2016.

If we look at the average after April 2016, we see that’s Nova is ahead, but don’t forget Nova plays 2500 different songs each month, so it’s normal statistically speaking New songs are distributed equally along the week for all radios On the table below, we can see NRJ has 25% of common songs with Virgin and 12% with Skyrock. Virgin has 18% with NRJ while Skyrock has 9% of common songs with NRJ.

Nova has a few similar songs with the others radio, there are mostly legendary artists such as Bob Marley, Daft Punk, Aloe Blacc, Kavinsky, Beyoncé… If you are interested by the full list look for the “Similar songs between radios” cell in the “backstage” AKA the blog article’s Databricks notebook Our 4 radio stations are different, for sure, but do they have common songs between them? Surprisingly the answer is yes I would classify these songs as songs that everybody likes, you can play them at your party without any stress of being booed If we use a visualization for our previous table it will look like this, the blue bar is the similar songs, the orange and the green bar are the total of different songs.|||

One year of radio stations broadcasts were analyzed to notice their habits and if radio stations brainwashing is a thing