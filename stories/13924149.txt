Shopify has done a pretty good job hiding itself from the world.

The company’s e-commerce platform was involved in purchases by more than 100 million individual shoppers in 2016, yet it is invisible by design, enabling the end-to-end operation of its customers, some 400,000 individual retail shops and brands. It proudly operates not from San Francisco or SoHo but from six floors of an inconspicuous office tower in Ottawa, a city whose much bigger success story is Justin Trudeau, the heartthrob Prime Minister whose office is a 10-minute walk away. Shopify’s cofounder and CEO, Tobias “Tobi” Lütke, a 36-year-old German-born computer programmer with ice-blue eyes and a penchant for newsboy hats and free thinking, is an introvert with a shy demeanor.

And yet the company has quietly but aggressively encroached on territory occupied by retail giants like Amazon ( amzn ) and eBay ( ebay ) to carve out a lucrative niche in e-commerce. Founded in 2004, Shopify ( shop ) has close to 2,000 employees—1,500 of them added in the past two years—and offices in five cities. Revenue in 2016 was $390 million, up almost 100% from 2015; it’s projected to grow 50% this year (it had a $37.2 million operating loss in 2016 but expects to be profitable this year). Since it went public in 2015, its stock has more than doubled. It has advisers and partners including Tim Ferriss and Tony Robbins.

Lütke’s goal is a lofty one: to make commerce easier for everybody. Just as WordPress made it easy for anyone to set up a blog or content website, Shopify lets anyone set up and run a digital store immediately, without needing any technical prowess. With subscriptions starting at $29 per month, Shopify helps merchants decide on a store and domain name, what to sell, and which design template to choose. Once the store is set up, Shopify acts as a hub for tracking inventory, shipping, sales, and marketing analytics.

Most of its customers are small and midsize businesses like Tattly , a Brooklyn-based temporary-tattoo company founded by Tina Roth Eisenberg, who noticed her daughters coming home from birthday parties with shoddy fake tattoos, and Mindzai , a Toronto-based designer toy store run by Chris Tsang, who ran his business out of his condo before leaving the corporate world to sell full-time.

Increasingly, it’s serving big names too. Celebrities like Drake, Kanye West, and Kylie Jenner use Shopify to sell their product lines, and Radiohead used it to sell its most recent album. Google ( googl ) , GE ( ge ) , and Tesla ( tsla ) use the company’s enterprise version, Shopify Plus, which starts at $2,000 per month, because it’s cheaper and better than building and maintaining their own e-commerce platform.

That many of these bigger, more marketable names are opting for Shopify speaks to the changing face of distribution. Businesses no longer have to pay middlemen to sell their products and can provide a more personal experience by connecting with customers directly. Why would Bose, the thinking goes, pay to sell its products only at retail when it can connect with customers directly through its own digital store? Shopify makes it possible.

Merchants large and small can use a single interface to sell through their online store, and can also avail themselves of all kinds of help with any point in the selling process—social media, shipping and manufacturing, marketing, inventory tracking—in Shopify’s app store, a selection of free and paid tools it calls Merchant Solutions. Kit , a company recently acquired by Shopify, offers an AI-driven virtual assistant that, for $10 a month, makes marketing suggestions, engages with customers who abandon their online carts, and pushes out Facebook ads. Companies like Intuit ( intu ) , Houzz, and MailChimp have built custom apps for Shopify’s merchants. (Shopify takes a cut of the revenue.)

Shopify allows merchants to sell online and through other channels: in a brick-and-mortar setting (it offers a line of physical point-of-sale devices that sync with its software), through consumer hubs like Facebook and Pinterest, and, more recently, on Amazon. The latter was a big win: For years the online retail giant had its own software product for small and midsize retailers, Amazon Webstore. But it was more expensive, and over time startups like Shopify and BigCommerce, which focused exclusively on these services and prioritized the merchant rather than the consumer, gained ground. Amazon shut down Webstore last year, recommending its customers migrate to its competitors. In January, Shopify announced an integration with Amazon that would allow Shopify merchants to sell on its massive marketplace from their Shopify stores. Shopify’s stock jumped nearly 10% on the news. It became the rare example of a company not just taking business away from the conquer-everything-at-all-costs Amazon, but likely playing a role in its decision to pack up and go home.

Tobi Lütke sits on a couch that faces a row of snowboards in his office. He speaks thoughtfully in his native German accent—he grew up in Koblenz, a historic town about an hour west of Frankfurt.

He owes much in his life to snowboards.

In 2002, while on a snowboarding trip to Whistler, British Columbia, he met his wife, Fiona McKean. They soon moved to McKean’s native Ottawa, where Lütke connected with McKean’s family friend, Scott Lake. The two bonded over a shared love of technology—Lütke had fallen in love with computers as a child and left high school at age 17 to work as a programming apprentice at Siemens, and Lake was a vice president at a midsize tech company—and eventually decided to start a company together. Both avid snowboarders, they chose to sell high-end boards online, with Lütke handling the tech side and Lake handling the business side.

While building the site, Lütke grew frustrated with popular software options like Microsoft Commerce and Yahoo Stores, which were clunky and expensive, so he decided to build his own e-commerce engine from scratch. It would be simpler, faster, and more visually pleasing than the competitors, and he would build it using Ruby on Rails, an innovative new programming framework invented by David Heinemeier Hansson, the Danish programmer who had founded the web-based project-management tool Basecamp. Hansson, now a close friend of Lütke’s, says Lütke was “instrumental” in the development of Ruby on Rails, which would ultimately be used to build Twitter, Airbnb, Groupon, Soundcloud, GitHub, and more.

Lake and Lütke launched their company, Snowdevil, in 2004. But while they made a few sales, they soon came to believe that the better opportunity might be in selling the software Lütke had built. He had released some of his e-commerce-related applications to the Ruby on Rails community as open-source projects, and they were gaining notice.

Related: The 100 Best Companies to Work For 2017

They changed the name to Jaded Pixel (new to English, Lütke confused “jaded” with the color “jade”). Lütke made a call to Germany to bring aboard Daniel Weinand, his best friend since age 15 and a computer programmer with a gift for design and user experience, as its third cofounder. Lake renamed it Shopify.

It was slow going at first. While they got a few dozen customers through the Rails community and word of mouth from the design world, the company pulled in just $8,000 in October 2006. Lütke and McKean were living in her parents’ house, and his father-in-law, who was one of the company’s first investors, occasionally had to write checks to help the cofounders make their small payroll.

Help came the following year, when Toronto-based angel investor John Phillips heard about the nascent company through a friend who was helping someone set up an e-commerce site. He was impressed by the product and even more by Lütke. He wrote the company a check for $250,000 at a $3 million valuation.

Soon after, Lütke and Lake began engaging in debates over where to take the company: Lake felt they should become a venture-backed growth company; Lütke, who had a distaste for large corporations, aspired to instead make Shopify the “best 25-person company in the world.” But it continued to grow, and in 2008, Lütke flew to Silicon Valley to meet with major venture capital firms Benchmark, Sequoia, and Accel. Benchmark and Sequoia were interested, but they discussed moving the company to Silicon Valley with Lütke, at which point, he says, he lost interest.

Frustrated with Lütke’s reluctance to grow and tired of the post-startup phase, Lake left that year to launch Source Metrics, a social marketing analytics tool for retailers, but remained on the board. Lütke went on a hunt for a new leader, but Phillips pushed him to run the company himself. “I said, ‘Tobi, you gotta run the company.’ And he’d never thought of it, really,” Phillips says. But Lütke agreed. Phillips also pressed him to find different kinds of leaders, and Lütke soon tapped as COO Harley Finkelstein, an ambitious extrovert and an early Shopify user who had sold T-shirts to pay for law school and whom Lütke met at an entrepreneurs meet-up.

Another critical assist came from Tim Ferriss, the self-improvement guru and tech investor. Lütke, a fan of Ferriss’s book The 4-Hour Workweek , suggested he be the keynote speaker at the annual Ruby on Rails RailsConf in 2009, and the two bonded over a shared passion for inspiring entrepreneurs. Ferriss helped conceive the Build a Business competition, Shopify’s flagship marketing event that challenges people to start a store over an eight-month period. Lütke initially wanted the prize to be a MacBook Pro; Ferriss, whom Lütke calls Shopify’s “idea supersizer,” convinced him to make it $100,000. (“I wanted him to think as big as possible,” Ferriss says, “to the point that it would make him uncomfortable.”) The contest is now a major event; along with Ferriss, winners receive mentorship from Tony Robbins, celebrity entrepreneur Daymond John, life coach Marie Forleo, and Russell Simmons.

In 2010 the company was contacted by Bessemer Ventures, which was looking to invest in interesting e-commerce businesses. After a months-long courtship, Lütke decided he and the company were ready to grow. In December of that year, Bessemer led a $7 million Series A funding round. Ten months later, Shopify raised a $15 million Series B. In 2013 the company raised a mega-round, $100 million at a valuation of $900 million.

That set the stage for the company’s April 2015 IPO, a move Lütke says he’s confident was necessary for Shopify to achieve its long-term goals. “I want Shopify to be a company that sees the next century,” he wrote in a letter included in the IPO filing. After setting an offering price of $17, the stock began trading at $28. Nearly two years later, it sits at around $60.

Lütke describes himself as being disobedient and antiauthoritarian from a young age. “When people said, ‘Hey, you need to do this,’ I would usually think about doing the opposite,” he says. This was a problem in his first job, at Siemens, when he felt restricted by the corporate environment. But one colleague, a grizzled, potbellied senior programmer in his fifties named Jürgen who rode to work on his motorcycle, showed Lütke that people outside the norm could survive in the corporate culture. Lütke gleaned an important lesson. “The secret,” he says, “was be exceptionally good at what you do, and everything else will fall into place.” From the start, he wanted to make Shopify a place that would embrace such iconoclasts.

The company’s hiring strategy, for example, is to focus not on what candidates have done already, but on what they might do in the future. That philosophy, which means betting on uncredentialed but motivated applicants, was adopted largely out of necessity—they couldn’t afford the candidates who checked all the boxes—but it’s one the company still follows, and it has led to a workforce of varying backgrounds and dispositions.

There is a companywide aversion to workplace “personas” and an emphasis on authenticity, free thinking, and the ability to be comfortable with discomfort. Another key tenet is the “trust battery,” an internal gauge of one’s successes and failures that determines how much freedom they have to pursue new ideas for the company. Employees take this almost literally.

But such principles have their limits. An early expression of Lütke’s authenticity was brutal honesty. “The mistake I made is, I thought everyone had signed up for the same thing,” he says. “Different people need different kinds of communication for it to have the same effect. That was something I had to learn.”

Free thinking could also be blamed for Shopify getting pulled into a Donald Trump–related controversy. Unbeknown to many, the Breitbart News Network, the alt-right online publication formerly headed by Trump chief strategist Stephen Bannon, hawks fan merchandise. And to sell Breitbart coffee mugs, T-shirts, beer cozies, badges, and hats that say things like: “Hate America? We’ll help you relocate,” Breitbart uses—you guessed it—Shopify.

Several of those freethinking Shopify employees uncovered the connection late last year and demanded Lütke cut off Breitbart. That led to public condemnations from bloggers and a #DeleteShopify campaign—an echo of the #DeleteUber campaign—that spread across social media.

Lütke responded with a Medium post titled “ In Support of Free Speech .” In it he said that, despite receiving more than 10,000 emails, tweets, and messages on the matter, in the absence of illegal activity, Shopify had to remain neutral. “To kick off a merchant is to censor ideas and interfere with the free exchange of products at the core of commerce,” he wrote. Breitbart remains a customer.

A handful of merchants canceled their subscriptions; two employees quit. Lütke expressed admiration for them. “I sent them emails saying, ‘Hey, I really, really respect that,’ ” he says. “The thing that’s important is people have principles. It’s not a principle unless it costs you something.”

Despite his growing workload, Lütke has remained disciplined in his pursuit of freethinking. Every quarter, he takes a weeklong deep-learning retreat in which he secludes himself in office spaces around Ottawa to write code or takes a stack of books into the woods. The practice, which he calls “studio weeks,” was inspired by a practice established by musician friends.

He spends much of this time thinking about Shopify’s future, something the company’s investors and advisers say is one of Lütke’s biggest strengths. “He has an unrivaled ability to prioritize in the long term,” says Ferriss, comparing Lütke to Jeff Bezos in that regard. “I think a lot of people claim to be able to do that; in reality, very few people are able to do that.”

For Shopify, that future includes a big commitment to data and machine learning. Through tracking hundreds of thousands of merchants, Shopify will soon be able to learn what makes a company succeed and grow, and use that insight to make recommendations from its menu of add-on products and services.

Another big bet is Shopify Capital, a funding mechanism for small and midsize businesses. If Shopify sees an opportunity for one of its customers to expand, it will offer the merchant a cash advance. There’s no interest rate, but Shopify keeps a percentage of future sales at a discounted rate. In 2016, it seeded merchants with more than $30 million.

And, of course, Shopify needs to get more people to set up shop. There are some 10 million small and midsize businesses across its core markets (Canada, the U.S., the U.K., and Australia). Less than 4% use its platform. Lütke and his team believe they can expand that potential market by pushing more people toward entrepreneurship.

“The next challenge is, How do we encourage not just the people that self-identify as entrepreneurs to do it, but everybody?” says Finkelstein. “How do I get people that are making jewelry for their granddaughter to be like, ‘You know what? Maybe other people want this jewelry and I’m gonna create an online store and start selling jewelry to the whole world.’ ”

Bessemer’s Jeremy Levine has lofty ambitions for what Shopify could become. “It is certainly plausible that half of all e-commerce transactions could flow through Shopify at some point,” he says. “My rationale is that every merchant will eventually want its own storefront, and Shopify offers, by far, the best platform for storefronts.”

Lütke speaks more from the perspective of battle-scarred founder. “Shopify has been a perpetually underestimated company at every point of its history,” he says.

A version of this article appears in the March 15, 2017 issue of Fortune. We’ve included affiliate links into this article. Click here to learn what those are.|||

From the ­unlikely setting of Ottawa, e-commerce platform Shopify's CEO Tobi Lütke has ­quietly been building a powerful selling machine.