Travis Kalanick, the chief executive officer of Uber Technologies Inc., says he needs leadership help. He recently dispatched former U.S. Attorney General Eric Holder to investigate sexual harassment claims against the company. His security team is reviewing a practice known as “Greyballing.” And he’s no longer planning to go to meetings with President Trump.

These damage-control initiatives—in response, respectively, to a leaked video in which Kalanick was rude to an Uber driver, a blog post by a former engineer, an admission that the company had been deliberately misleading police, and a customer boycott—were the result of a month’s worth of public-relations disasters. Taken alone, any of these would have been enough to slow down the famously fast-moving ride-hailing company. Taken together, they’ve caused some to question Uber’s viability and Kalanick’s staying power.

But none of these scandals has the potential financial impact of the one Uber has said the least about: a lawsuit from Alphabet Inc.—the parent of Google and Google’s self-driving car division, now called Waymo—over driverless cars. Waymo says Uber is in possession of, and is basing the future of its business on, technology that was stolen by a former employee.

Self-driving technology has become a fixation for Kalanick. Developing a driverless car, he’s often said, is “existential” to Uber. If a competitor managed to get there first, it could easily replicate Uber’s core service (shuttling passengers) without its single largest cost (paying drivers). Over the course of a few weeks in 2015, Kalanick poached 40 researchers from the Carnegie Mellon University robotics lab, one of the country’s top autonomous vehicle research centers. Then, last summer, Uber became the first company to operate a fleet of autonomous taxis, in downtown Pittsburgh. On the day it announced that service, Uber also said it had acquired Otto, a self-driving truck startup founded in January 2016 by a former Google employee, Anthony Levandowski. The 37-year-old engineer was an original member of Google’s car team and a protégé of its creator, Sebastian Thrun.

At Google, Levandowski had been both a brilliant engineer and a divisive manager, with a reputation for flouting corporate norms and skirting rules to get cars on the road as quickly as possible. He was so controversial, according to several former and current employees, that when he was being considered to lead the car team, a group of engineers revolted, causing Alphabet CEO Larry Page to rethink the choice and install a different leader, Chris Urmson.

According to the legal complaint filed on behalf of Google’s driverless car division—as almost everyone at Waymo still refers to it—the company began investigating Levandowski last summer after learning that Uber had paid about $700 million for his months-old company. Google’s suit, filed in a San Francisco federal court, says its investigators uncovered a trove of digital evidence that hint at an unprecedented theft. According to the suit, Levandowski used his company laptop to download 14,000 design files from Google’s car project. He plugged a memory card reader into the laptop and, shortly afterward, wiped all the data from the laptop. The suit also alleges that two other Otto employees took files on their way out the door.

Google seemed content to sit on that information until Dec. 13, when a Google employee received an email from a supplier that was working on components for the lidar sensor in the company’s first production car. Lidar—a portmanteau of “light” and “radar”—is the key component that allows an autonomous vehicle to, essentially, see its surroundings. (It’s also used to build maps.) Off-the-shelf sensors cost up to $80,000 and contain several individual lenses. Under Levandowski, who’d led the lidar team, Google developed a much cheaper version that used a single lens.

Strangely, though, the email’s subject line—“Otto Files”— made reference to Levandowski’s company. According to Google’s suit, the contents of the email, which seemed to have been intended for Uber rather than Google, included a machine drawing of a lidar circuit board that had Otto’s name on it but looked almost identical to Google’s. Two months later, Waymo sued Uber for trade secret theft and patent infringement, seeking damages and an injunction that could seriously impede Uber’s self-driving car program.

At issue is a business that both companies believe will be worth hundreds of billions or even trillions of dollars a year. And though both companies like to portray driverless cars as some near-term inevitability, this dispute shows just how messy the race to get there could prove to be.

During new-hire orientation, engineers at Google are frequently told that the company will never sue a former employee for patent infringement. The implication is twofold: first, that Google doesn’t stoop to fighting over patents, though it may employ them to protect itself from people who aren’t in the business of changing the world. (“These patent wars are death,” Executive Chairman Eric Schmidt said at an event in 2012, calling patent litigation “bad for innovation.”) And, as an extension of that, if Google sues you over a patent issue, you must have really pissed them off.

After the lawsuit was filed, Uber released a statement characterizing it as “a baseless attempt to slow down a competitor.” At an all-hands meeting at the company’s Pittsburgh research center, Levandowski defended Uber’s lidar technology as “clean”—that is, not the product of stolen design documents—and told the company’s engineers that he’d downloaded the files to work from home. Some former colleagues seem to think that even if Levandowski did what Google alleges, he doesn’t deserve to be punished. “Whatever Google may say about him stealing lidar trade secrets, he was the lidar team at Google,” says someone who worked at the company’s driverless car program. “This is like the Swiss patent office suing Einstein for inventing the theory of relativity while he worked there.”

The comparison to Einstein is obviously hyperbolic, but it also captures the foundational role Levandowski played in the development of self-driving cars. Levandowski, 6-foot-6 and relentlessly intense, is as much an entrepreneur as he is an engineer. At 16 he started a web design firm that a former colleague says made him a millionaire by the end of high school. (Levandowski didn’t respond to repeated requests for comment.) As a University of California at Berkeley undergraduate, he won a national competition sponsored by Lego—he built a toy robot that could sort Monopoly money.

Levandowski was 22 and working toward an MBA and an industrial engineering master’s at Berkeley when he first heard about the Darpa Grand Challenge. (His mother read about it and mentioned it to him.) The 2004 competition, organized by the U.S. Department of Defense, involved a race for robotic cars on a 150-mile course in the Mojave Desert. It drew teams from Carnegie Mellon, the California Institute of Technology, a number of defense contractors, and most of the other big names in robotics. Levandowski led a ragtag team of Berkeley graduate students and research assistants.

If there was hubris in entering, there was even more in his chosen design. Ghostrider, his self-balancing, self-driving motorcycle, was the only two-wheel vehicle in the contest. “I was assuming the driving part would be easy to solve,” he said last summer, speaking to Bloomberg Businessweek in a joint interview with Kalanick shortly before Uber announced its acquisition of Otto. “I wanted to make something actually difficult.” Although it failed to stay upright on race day—a grainy YouTube video documenting Ghostrider’s run is six seconds long—the bike was still seen as an achievement by Levandowski’s peers, partly because no team finished. (Ghostrider eventually became part of the Smithsonian’s permanent collection.) For the next competition, in 2005, Levandowski served as the team leader for Ghostrider while also working on lidar sensors for the winning team from Stanford, which was managed by Thrun.

Levandowski and two Berkeley friends adapted the technology from Ghostrider, which had used GPS and cheap digital cameras, into a commercial product. Their company, 510 Systems LLC, sold camera systems, and eventually lidar, to mapping companies, including Nokia Corp. and Microsoft Corp. Levandowski also sold kits to automate agricultural and construction equipment.

In 2007, Google hired Thrun’s team from Stanford to work on a new product, Street View, formally making Levandowski a full-time employee of the search company even as he continued to run 510. The initial plan was to supplement Google’s maps, which at the time used data licensed from the mapping giant Navteq Corp., with pictures of city streets. Levandowski suggested that Thrun’s mapping technology could allow Google to replace Navteq’s data altogether. His mapping initiative was seen as an enormous success, allowing Google to offer on phones turn-by-turn driving directions that were as good as those offered by standalone GPS device makers.

In 2008, while doing double-duty at Google and 510, he took a call from a producer at the Discovery Channel who wanted to borrow Ghostrider for an episode of Prototype This!, a short-lived documentary series. Levandowski suggested instead that he use a different vehicle. He asked Google for permission to embark on the stunt using sensors similar to those on Google’s mapping cars. It was granted on the condition that Levandowski, and not Google, would be responsible if something went wrong. “The lawyers said, ‘Absolutely, but please don’t put Google on the side,’ ” Levandowski told Bloomberg Businessweek in the interview last summer. “So we started this thing called Anthony’s Robots to be very clear it wasn’t Google-related.” A few weeks later, under a police escort and with cameras rolling, the Pribot, as Levandowski named his converted Toyota Prius, successfully crossed the San Francisco Bay Bridge.

Google’s self-driving car project began the following year with a modified Prius that used software created by Thrun at Stanford and hardware supplied by Anthony’s Robots. Like 510 Systems, Anthony’s Robots was operated as an independent company. The arrangement—whereby Levandowski was at once a founding member of the Google self-driving car team and a vendor who was also selling technology to other companies—was well-known to Google executives, though it was never publicly disclosed. “Anthony is a rogue force of nature,” says a former Google self-driving car executive. “Each phase of his Google career he had a separate company doing exactly the same work.” According to two former Google employees, founders Page and Sergey Brin tolerated Levandowski’s freelancing because they saw it as the fastest way to make progress. Google’s car team embraced Levandowski’s nature, too. The attitude, says a former colleague, was “he’s an asshole, but he’s our asshole.”

As Google’s car project grew, a debate raged inside the company, reflecting a broader dispute about the direction of autonomous vehicles: Should the tech come gradually and be added to cars with drivers (through features like automatic parking and highway autopilot) or all at once (for instance, a fleet of fully autonomous cars operating in a city center)? Urmson, a former Carnegie Mellon professor, preferred the latter approach, arguing that incremental innovations might, paradoxically, make cars less safe. Levandowski believed otherwise and argued that Google should sell self-driving kits that could be retrofitted on cars, former colleagues say.

Urmson won out, and according to two former employees, Levandowski sulked openly. After one dispute between the two, Levandowski stopped coming to work for months, devoting his time to his side projects. This didn’t stop Page and Brin from discreetly acquiring 510 Systems and Anthony’s Robots for roughly $50 million in 2011.

As Google’s driverless car program matured, Levandowski seemed to become impatient. Creating a fully functioning driverless car means training a complicated hardware and software system to identify lane lines and red lights and to control the car’s movements. It also means writing software that anticipates thousands of unlikely “edge cases”—hairpin turns, drivers who use hand signals, covered bridges, recumbent bikes, and so on. That work seemed to bore Levandowski. He became increasingly frustrated at Google’s inability to operate its cars on city streets and decided to take matters into his own hands. “Engineers were like, ‘We are totally ready to go,’ and I’m like, ‘Let’s go then. Let’s see whether it’s real or a demo,’ ” Levandowski said in the summer interview.

Without formally telling Google, which considered its cars not yet ready for open-road tests, he hired a lobbyist in Nevada and wrote a law that allowed companies to test autonomous cars with so-called safety drivers. (Self-driving car companies use the term to describe an engineer who sits in the driver’s seat with her hands on the wheel in case the car malfunctions.) The law passed at the end of 2011, though Google hasn’t conducted large-scale tests in the state. Google’s government relations department learned about Levandowski’s Nevada efforts when the lobbyist, David Goldwater, sent the company an invoice.

Levandowski first met Kalanick in 2011 at a TED conference, but the two didn’t become close until early 2016, after Levandowski pitched Kalanick on an investment in Otto. Kalanick didn’t invest—but he did begin meeting with Levandowski in secret. In the interview with Bloomberg Businessweek at the time of the acquisition, Kalanick described these rendezvous in detail: The two would go to the San Francisco Ferry Building after sunset, entering separately and each picking up takeout food. They’d begin walking west toward the Golden Gate Bridge, where they’d eventually join up and begin talking. Kalanick recalled that he and Levandowski went on five or so of these walks, each one lasting several hours.

Kalanick, now 40, was taken by the younger man’s hustle and sense of purpose, describing him as a “brother from another mother.” To get self-driving cars to production, Kalanick said in the interview, “it can’t just be about science. It has to be about engineering and entrepreneurialism that takes us into the real world. That’s where Anthony and I connect, right?”

Levandowski, who was sitting next to him, nodded. “We think very similarly in terms of how do we get things out onto the world fastest,” he said. “How do we make a difference, how do we make impact, how do we get people using our technology.” Levandowski hinted that he’d decided to break with Google and start Otto in part out of frustration at the slow pace of innovation at Google.

That might not have been the whole story. On March 10, Google, which is seeking a preliminary injunction to stop Uber from using its technology, filed written testimony from Pierre-Yves Droz, Levandowski’s co-founder at 510 Systems and the technical lead on Google’s lidar program. Droz wrote that in the summer of 2015 Levandowski said Uber might be interested in “buying the team” and that in January 2016 he told Droz he would “replicate” the company’s lidar. When Levandowski quit to start Otto, he was escorted out by Google security. A handful of Google employees soon followed him to the new company.

Soon after, Levandowski began making trips to Uber’s self-driving car research center in Pittsburgh, where a staff that had grown to 500 was scrambling to launch the pilot taxi service. Levandowski wasn’t widely introduced; senior managers believed he was a consultant. “As far as the team knew,” says a former employee, Levandowski was “some guy who would come around and be annoying.”

At Otto’s San Francisco headquarters, the startup, which had 90 or so employees, prepared for its product launch in May. Down a stretch of Nevada highway, the company ran a self-driving big-rig truck kitted out with sensors and computer controllers. Documents uncovered by the tech publication Backchannel showed that Levandowksi had sought the approval of state regulators to film the demo. When they denied his request to do the run, he went through with it anyway. (Goldwater, again serving as Levandowski’s lobbyist, argued in an email to the Nevada Department of Motor Vehicles that it had no jurisdiction in the matter. A senior DMV administrator called the test “illegal” in an internal email but declined to rebuke Otto publicly.)

In August, Uber acquired Otto for roughly $700 million in company stock. The plan, Kalanick said, was to continue building Otto’s trucking business and to use the startup’s homegrown lidar to beef up Uber’s own self-driving cars, all under Levandowski’s supervision. Uber’s Pittsburgh team learned of the acquisition, and the fact that they had a new boss, the day it was announced. “The team was super unhappy,” says a former employee. It turned out that Otto’s lidar was a work in progress—the company’s prototype trucks were still using sensors manufactured by Velodyne Lidar Inc. “We thought we were getting some supersecret sauce by joining them,” says the employee. “But they did smoke and mirrors and got a huge acquisition offer.” Over the next six months, about 15 of the original 40 Carnegie Mellon engineers left. At least three have subsequently founded competing self-driving car companies, one of which recently received a $1 billion investment over five years from Ford Motor Co.

Levandowski seemed to struggle in other ways as well. In December, Uber dispatched 16 self-driving cars, with safety drivers, in San Francisco without seeking a permit from the California DMV. The test went poorly—on the first day, a self-driving car ran a red light, and the DMV ordered Uber to halt its program in the state. The company suffered further embarrassment when a New York Times article, citing leaked documents, suggested that Uber’s explanation for the traffic violation—that it had been caused by human error—wasn’t complete. The car malfunctioned, and the driver failed to stop it.

The misdirection came as no surprise to the Uber employees who’d spent time at Otto’s San Francisco headquarters. Someone there had distributed stickers—in OSHA orange—with a tongue-in-cheek slogan: “Safety third.”

Uber has yet to file a legal response to Google’s complaint—a spokeswoman says it plans to do so later this month—but the company essentially has two options: It can settle with Waymo and license its sensors, or it can fight. “What Waymo probably wants is to license its patents to Uber,” says Robert Gomulkiewicz, a former Microsoft intellectual-property lawyer who’s now a professor at the University of Washington School of Law. “In this kind of litigation, that’s the typical sequence of events.”

That said, this isn’t a typical patent dispute, and Uber isn’t a typical company. If it fights, it could argue, as Levandowski did at the all-hands meeting in Pittsburgh, that the alleged document dump was simply part of an effort on his part to work from home. It could also cite how Google seemed to encourage Levandowski’s freelance excursions. And while many of his former colleagues assume that Google wouldn’t sue Levandowski if the forensic evidence wasn’t incontrovertible—that is, if it didn’t have him dead to rights—other former colleagues and some industry insiders see the lawsuit as evidence that Google is struggling to make up for its failure to bring a product to market quickly.

“Google is the Xerox Parc of self-driving cars,” says George Hotz, the founder of Comma.ai, another autonomous car startup. It’s a backhanded compliment: Although Xerox’s Palo Alto Research Center invented the modern computer operating system, it didn’t bring the invention to market; Apple Inc. did. “The real question is, why hasn’t Google shipped?” Hotz asks. He regards Google’s lawsuit as a deliberate conflation of two different beefs. The first—the accusation that Levandowski stole documents—is serious. The second, Hotz says, “just signals weakness on Google’s part.” In Silicon Valley, and at the Googleplex, litigation is looked upon as the last refuge of the undisruptive.

Whatever Levandowski did with Google’s files, he’s not wrong that Google has struggled to commercialize technology that’s widely regarded as the best in the automotive industry. Before Google worked on its current prototype, a two-seater that has a top speed of 20 miles per hour and vaguely resembles a koala bear, the company pitched Elon Musk on outfitting his electric Tesla vehicles with Google tech, according to two people familiar with the deal. Musk passed and a few years later launched Tesla Inc.’s highway autopilot service on his own. A former Google executive says John Krafcik, who joined the car project as CEO in 2015, would sometimes appear rattled by the competitive moves of Tesla and Uber, wondering aloud if Google may have already been “leapfrogged.” He would grow particularly irritable “every time Elon would post something on Twitter,” the executive says.

Levandowski hasn’t shown any sign of being rattled or contrite. Three days after the lawsuit hit, he appeared onstage in Barcelona as a marquee speaker at the Mobile World Congress.

The lawsuit never came up. As a final question, the moderator, the chief marketing officer of a cell phone industry trade group, simply asked, “Do you drive?” Levandowski smiled. “Sometimes I drive, and sometimes I’m driven,” he said. “That’s the beauty of being able to work on this project—you get to see the technology evolve and get better over time.”

“Absolutely fascinating stuff,” the moderator replied. “Please, everyone: a round of applause for Anthony.” The crowd, stacked with top executives from the world’s biggest companies, complied enthusiastically.|||

Inside the vicious patent fight over self-driving technology.