WikiLeaks today dumped a smaller subset of documents from its "Vault 7" collection of files from a CIA software developer server. Yet again, these documents are more important from the perspective of WikiLeaks having them than for showing any revelatory content. The exploits detailed in these new files are for vulnerabilities that have largely been independently discovered and patched in the past. The files also reveal that the CIA likely built one of these tools after seeing a presentation on the exploits of Apple's EFI boot firmware at Black Hat in 2012.

The latest batch of files, dramatically named "DarkMatter" (after one of the tools described in the dump), consists of user manuals and other documentation for exploits targeting Apple MacBooks—including malware that leveraged a vulnerability in Apple's Thunderbolt interface uncovered by a researcher two years ago. Named "Sonic Screwdriver" after the ever-useful tool carried by the fictional Doctor of Dr. Who, the malware was stored on an ordinary Thunderbolt Ethernet adapter. It exploited the Thunderbolt interface to allow anyone with physical access to a MacBook to bypass password protection on firmware and install one of a series of Apple-specific CIA "implants."

World’s first (known) bootkit for OS X can permanently backdoor Macs The first (and only documented) version of Sonic Screwdriver was released in 2012. It worked only on MacBooks built between late 2011 and mid-2012, and the tool used a vulnerability in the firmware of those computers that allowed commands to be sent via the Thunderbolt adapter to change the "boot path" (the location of the files used to boot the computer). The change would allow a local attacker to boot the targeted MacBook from an external device to install malware that eavesdropped on the computer during normal use. Those implants included "DarkMatter," the predecessor to "QuarkMatter." (QuarkMatter is malware that was revealed in the previous WikiLeaks dump, and it infected the EFI partition of a MacBook's storage device.)

The ability to exploit Apple computers' EFI firmware dates back at least to January of 2009, with a set of tools the CIA's Engineering Development Group called "DarkSeaSkies." That kit included DarkMatter, "an EFI driver that persists in firmware and installs the other two tools" called NightSkies (a Mac OS backdoor), and SeaPea (a "kernel-space implant" that stealthily launched NightSkies at boot). NightSkies was also the name of an earlier (2008) iOS implant which was installed via iTunes on factory-reset iPhones.

The Sonic Screwdriver tool, released in November 2012, was likely used with another implant called Der Starke (German for "The Strong"). Der Starke was a "diskless EFI-persistent version" of an implant called Triton. The normal version of Triton, which worked on Mac OS 10.7("Lion") and 10.8 ("Mountain Lion"), required installation with administrative access to the operating system. Der Starke, however, targeted systems with Mac OS 10.8 and 10.9 ("Mavericks"), and this tool could be installed by booting from a USB via EFI boot—or with Sonic Screwdriver if the firmware was password protected.

The Thunderbolt exploit used by Sonic Screwdriver was first revealed at Black Hat USA in 2012 by the security researcher known as snare. The same exploit was practically implemented in 2015 by security researcher Trammell Hudson. As implemented, Sonic Screwdriver obviously required what's been referred to as an "evil maid" attack—someone has to gain access to the targeted device for an extended period of time to perform the installation. The same is true of the other tools in cases where there is no password-protected firmware; the attacker would need to be able to boot the computer from a USB device to install it.

In a post this afternoon, Hudson said:

The functionality of Sonic Screwdriver appears to be at the same level as presented in snare's slides—the Option ROM code is loaded before firmware passwords are checked, which allows it to bypass this password and boot from an alternate media device with a more extensive exploit, but does not have any flash level persistence. Based on the documentation, as far as I can tell it does not carry any payload of its own and its sole purpose is to be able to boot from external media

It's possible that later versions of Sonic Screwdriver were capable of a remote attack if they followed the development path taken by Hudson. A second version of Thunderstrike that he created could be spread by e-mail attachment or a malicious website, and that iteration used the Thunderbolt bus to infect firmware in Apple peripherals. In turn, this infected any other computer the peripherals might be plugged into. Apple has already patched the Thunderstrike vulnerability in firmware updates, but computers that haven't been updated could still be vulnerable to this sort of attack.|||

"Sonic Screwdriver" leveraged a now-patched vulnerability.