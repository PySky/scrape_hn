Last week, Ars introduced readers to Hajime, the vigilante botnet that infects IoT devices before blackhats can hijack them. A technical analysis published Wednesday reveals for the first time just how much technical acumen went into designing and building the renegade network, which just may be the Internet's most advanced IoT botnet.

Vigilante botnet infects IoT devices before blackhats can hijack them As previously reported, Hajime uses the same list of user name and password combinations used by Mirai, the IoT botnet that spawned severalÂ record-setting denial-of-service attacks last year. Once Hajime infects an Internet-connected camera, DVR, and other Internet-of-things device, the malware blocks access to four ports known to be the most widely used vectors for infecting IoT devices. It also displays a cryptographically signed message on infected device terminals that describes its creator as "just a white hat, securing some systems."

But unlike the bare-bones functionality found in Mirai, Hajime is a full-featured package that gives the botnet reliability, stealth, and reliance that's largely unparalleled in the IoT landscape. Wednesday's technical analysis, which was written by Pascal Geenens, a researcher at security firm Radware, makes clear that the unknown person or people behind Hajime invested plenty of time and talent.

One example: Hajime doesn't rashly cycle through a preset list of the most commonly used user name-password combinations when trying to hijack a vulnerable device. Instead, it parses information displayed on the login screen to identify the device manufacturer and then tries combinations the manufacturer uses by default. When attacking a MikroTik router, for instance, Hajime attempts to log in using the user name "admin" and an empty password. That's the factory-default combination, according to the MikroTik documentation. By reducing the number of invalid passwords entered into the login page, Hajime lowers the chances of being locked out or blacklisted.

Also, in stark contrast to Mirai and its blackhat botnet competitors, Hajime goes to great lengths to maintain resiliency. It uses a BitTorrent-based peer-to-peer network to issue commands and updates. It also encrypts node-to-node communications. The encryption and decentralized design make Hajime more resistant to takedowns by ISPs and Internet backbone providers. After researchers from Rapidity Networks in October uncovered a flaw in the encryption implemented in an earlier version of Hajime, a Hajime developer updated the botnet software to fix it.

Here is a full list of features:

The analysis is based on a collection of vulnerable devices or simulated devices Geenens maintained inside a special laboratory. During the five weeks that Geenens observed his honeypot, Hajime attempted almost 15,000 hijacks from more than 12,000 unique IP addresses scattered all over the world. For now, the greyhat Hajime is outstripping the blackhat IoT botnets in features, robustness, and possibly even the number of infected devices. It wouldn't be surprising, however, if new blackhat versions catch up in the next year or two.

"If Hajime is a glimpse into what the future of IoT botnets looks like, I certainly hope the IoT industry gets its act together and starts seriously considering securing existing and new products," Geenens wrote in a separate post. "If not, our connected hopes and futures might depend on ... grey hat vigilantes to purge the threat the hard way."|||

When it comes to features and robustness, Hajime surpasses its blackhat rivals.